(this["webpackJsonp@krogan/client"]=this["webpackJsonp@krogan/client"]||[]).push([[0],{1007:function(e,t){},1018:function(e,t){},1023:function(e,t){},1115:function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"calculateAngle",(function(){return ce})),n.d(i,"angleFromVector",(function(){return he})),n.d(i,"getAngleDiff",(function(){return le})),n.d(i,"positiveAngle",(function(){return ue})),n.d(i,"vectorFromAngle",(function(){return de})),n.d(i,"getRadians",(function(){return pe})),n.d(i,"getDegrees",(function(){return fe})),n.d(i,"lerp",(function(){return ge})),n.d(i,"getDistance",(function(){return ve})),n.d(i,"getRandomInt",(function(){return me})),n.d(i,"clamp",(function(){return be})),n.d(i,"round2Digits",(function(){return xe})),n.d(i,"decimals",(function(){return ye})),n.d(i,"getMagnitude",(function(){return je})),n.d(i,"degreeToCardinal",(function(){return Ae})),n.d(i,"reverseNumber",(function(){return Oe})),n.d(i,"snapPosition",(function(){return Se})),n.d(i,"shuffleArray",(function(){return we})),n.d(i,"getTimeProgress",(function(){return Ce})),n.d(i,"getPlusOrMinus",(function(){return ke}));var a={};n.r(a),n.d(a,"Vector2",(function(){return Ee})),n.d(a,"RectangleBody",(function(){return Pe})),n.d(a,"CircleBody",(function(){return Ie}));var s={};n.r(s),n.d(s,"APP_TITLE",(function(){return Be})),n.d(s,"FPS",(function(){return Le})),n.d(s,"WS_PORT",(function(){return ze})),n.d(s,"PLAYERS_REFRESH",(function(){return Ne})),n.d(s,"DEBUG",(function(){return He})),n.d(s,"ROOM_LOBBY_NAME",(function(){return Ue})),n.d(s,"GAME_SPEED",(function(){return Ge})),n.d(s,"PLAYER_NAME_MAX",(function(){return Fe})),n.d(s,"LOG_LINES_MAX",(function(){return Ve})),n.d(s,"BACKGROUND_COLOR",(function(){return Qe})),n.d(s,"TileColor",(function(){return Me})),n.d(s,"TeamColor",(function(){return _e})),n.d(s,"TILE_SIZE",(function(){return Xe})),n.d(s,"PATH_REFRESH",(function(){return We})),n.d(s,"PATH_TIME",(function(){return Ye})),n.d(s,"SPACESHIP_ROTATION",(function(){return Ke})),n.d(s,"PLAYER_SIZE",(function(){return Ze})),n.d(s,"SPACE_FRICTION",(function(){return qe})),n.d(s,"ROTATION_SPEED",(function(){return Je})),n.d(s,"SET_USERNAME",(function(){return $e})),n.d(s,"SET_SPACESHIPS",(function(){return et})),n.d(s,"KROGAN_MAIN",(function(){return tt})),n.d(s,"ZOOM_MAP_RADIUS",(function(){return nt})),n.d(s,"HEX_RADIUS",(function(){return it})),n.d(s,"MAP_SIZE",(function(){return at})),n.d(s,"TEAMS",(function(){return st}));var o={};n.r(o),n.d(o,"HexDirection",(function(){return ot})),n.d(o,"Map",(function(){return dt})),n.d(o,"CoordinateModel",(function(){return ht})),n.d(o,"worldToHex",(function(){return lt})),n.d(o,"hexToWorld",(function(){return ut})),n.d(o,"galaxy",(function(){return pt}));var r={};n.r(r),n.d(r,"UP",(function(){return ft})),n.d(r,"DOWN",(function(){return gt})),n.d(r,"LEFT",(function(){return vt})),n.d(r,"RIGHT",(function(){return mt})),n.d(r,"SHOOT",(function(){return bt})),n.d(r,"MENU",(function(){return xt}));var c={};n.r(c),n.d(c,"ObjectMap",(function(){return yt}));n(786);var h="https://api.elrondnftswap.com",l={id:"mainnet",chainId:"1",name:"Mainnet",egldLabel:"EGLD",decimals:"18",digits:"2",gasPerDataByte:"1500",walletConnectDeepLink:"https://maiar.page.link/?apn=com.elrond.maiar.wallet&isi=1519405832&ibi=com.elrond.maiar.wallet&link=https://maiar.com/",walletAddress:"https://wallet.elrond.com/dapp/init",apiAddress:"https://api.elrond.com",explorerAddress:"http://explorer.elrond.com",apiTimeout:"4000",walletConnectV2ProjectId:"5d32c9ea1f8f3ae6c7b9b1cb3fd14b92"},u=[{name:"ESDTTransfer",gasLimit:8e6,data:"ESDTTransfer@"},{name:"ESDTNFTTransfer",gasLimit:8e6,data:"ESDTNFTTransfer@"}];Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var d=n(0),p=n.n(d),f=n(146),g=n(4),v=function(){var e=Object(f.a)().address,t=Object(f.b)().isLoggedIn,n=M().account,i=_();return Object(g.jsx)(p.a.Fragment,{children:t?Object(g.jsxs)("button",{className:"side-button right center-mobile d-flex align-items-center justify-content-center",onClick:function(){i({type:"setShowLoginModal",showLoginModal:!0})},children:[Object(g.jsx)("img",{src:"/images/wallet.svg",className:"me-2",width:"18",height:"18",alt:"Wallet Krogan"}),Object(g.jsx)("p",{className:"text--action",children:e.truncate(12,"...")}),Object(g.jsx)("i",{className:"separator ms-2 me-2"}),Object(g.jsx)("p",{className:"text--action",children:null!==n&&void 0!==n&&n.balance?Object(F.b)(n.balance,2):"..."}),Object(g.jsx)("img",{src:"/images/egld.svg",className:"ms-2",width:"18",height:"18",alt:"EGLD"})]}):Object(g.jsxs)("button",{className:"side-button right center-mobile d-flex align-items-center justify-content-center",onClick:function(){i({type:"setShowLoginModal",showLoginModal:!0})},children:[Object(g.jsx)("img",{src:"/images/connect.svg",className:"me-2",width:"18",height:"18",alt:"Connect wallet to Krogan"}),Object(g.jsx)("p",{className:"text--action",children:"CONNECT WALLET"})]})})},m=n(13),b=n(1120),x=n(2),y=n(5),j=n(279),A=n(759),O=n(10);function S(e,t){switch(t.type){case"setTokens":var n=t.tokens;return Object(O.a)(Object(O.a)({},e),{},{tokens:n});case"setShowLoginModal":var i=t.showLoginModal;return Object(O.a)(Object(O.a)({},e),{},{showLoginModal:i});case"setAccount":var a=t.account;return Object(O.a)(Object(O.a)({},e),{},{account:a});case"setAddress":var s=t.address;return Object(O.a)(Object(O.a)({},e),{},{address:s});case"setIsLoggedIn":var o=t.isLoggedIn;return Object(O.a)(Object(O.a)({},e),{},{isLoggedIn:o});default:throw new Error("Unhandled action type: ".concat(t))}}var w=p.a.createContext(void 0),C=p.a.createContext(void 0);function k(e){var t=e.children,n=e.api,i=p.a.useReducer(S,function(e){return{api:void 0!==e?e:"https://api.elrondnftswap.com",tokens:[],showLoginModal:!1,address:"...",isLoggedIn:!1}}(n)),a=Object(m.a)(i,2),s=a[0],o=a[1];return Object(g.jsx)(w.Provider,{value:s,children:Object(g.jsx)(C.Provider,{value:o,children:t})})}function M(){var e=p.a.useContext(w);if(void 0===e)throw new Error("useState must be used within a Context.Provider");return e}function _(){var e=p.a.useContext(C);if(void 0===e)throw new Error("useDispatch must be used within a Dispatch.Provider");return e}var E,P=n(237);!function(e){e[e.Ledger=1]="Ledger",e[e.MaiarApp=2]="MaiarApp",e[e.MaiarAppV2=3]="MaiarAppV2",e[e.Wallet=4]="Wallet",e[e.None=5]="None"}(E||(E={}));var I=function(e){var t=e.show,n=e.onHide,i=Object(f.b)().isLoggedIn,a=Object(f.a)().address,s=M().account,o=function(){var e=_(),t=Object(f.a)().address,n=Object(f.b)().isLoggedIn,i=function(){var e=Object(y.a)(Object(x.a)().mark((function e(){var i;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=7;break}return e.next=3,Object(j.a)(t);case 3:(i=e.sent)&&(console.log("Account loaded ".concat(i.address)),a(i)),e.next=8;break;case 7:a(void 0);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=function(t){e({type:"setAccount",account:t||void 0}),e({type:"setAddress",address:t?t.address:"..."}),e({type:"setIsLoggedIn",isLoggedIn:void 0!=t})};return{loadAccount:i,disconnect:function(){Object(j.b)(),a(void 0)},proxy:function(){return new A.ProxyNetworkProvider("https://gateway.elrond.com",{timeout:4e3})}}}(),r=o.disconnect,c=o.loadAccount,h=p.a.useState(E.None),l=Object(m.a)(h,2),u=l[0],v=l[1],O=function(){n(),v(E.None),r()};p.a.useEffect((function(){i&&c()}),[a]);var S=function(){v(E.None),n()};return Object(d.useEffect)((function(){s&&S()}),[s]),Object(g.jsxs)(b.a,{show:t,onHide:S,animation:!1,size:"lg",centered:!0,children:[Object(g.jsx)(b.a.Header,{closeButton:!0,className:"btn-close-white"}),Object(g.jsx)(b.a.Body,{className:"center",children:function(){if(s)return function(e){return Object(g.jsxs)(p.a.Fragment,{children:[Object(g.jsx)("h4",{className:"mb-4 text-break-all",children:e.address}),Object(g.jsx)("div",{className:"d-flex align-items-center justify-content-center mb-3",children:Object(g.jsx)(F.a,{value:e.balance,token:"EGLD",decimals:5})}),Object(g.jsx)(J,{}),Object(g.jsx)("button",{onClick:O,className:"disconnect-button center-button px-sm-spacer mx-1 mx-sm-3 mb-3",children:"Disconnect"})]})}(s);switch(u){case E.Ledger:return Object(g.jsx)(P.b,{className:"ledger-login-modal",wrapContentInsideModal:!1,onClose:n});case E.MaiarApp:return Object(g.jsx)(P.e,{loginButtonText:"Login with Maiar",title:"Legacy Maiar Login",className:"wallect-connect-login-modal",lead:"Scan the QR code using Maiar",wrapContentInsideModal:!1,onClose:n,isWalletConnectV2:!1});case E.MaiarAppV2:return Object(g.jsx)(P.e,{loginButtonText:"Login with Maiar",title:"Maiar Login",className:"wallect-connect-login-modal",lead:"Scan the QR code using Maiar",wrapContentInsideModal:!1,onClose:n,isWalletConnectV2:!0});default:return Object(g.jsxs)(p.a.Fragment,{children:[Object(g.jsx)("p",{children:"Connect with your Elrond Wallet."}),Object(g.jsx)("h4",{className:"mb-4",children:"Please select your login method:"}),Object(g.jsxs)("div",{className:"mb-4 d-flex flex-column",children:[Object(g.jsx)(P.a,{buttonClassName:"extension-login",loginButtonText:"Browser Extension"}),Object(g.jsx)("button",{className:"dapp-core-component__main__btn dapp-core-component__main__btn-primary dapp-core-component__main__px-4 dapp-core-component__main__m-1 dapp-core-component__main__mx-3",onClick:function(){return v(E.MaiarAppV2)},children:Object(g.jsx)("span",{className:"dapp-core-component__loginButtonStyles__login-text",children:"Maiar App V2.0"})}),Object(g.jsx)("button",{className:"dapp-core-component__main__btn dapp-core-component__main__btn-primary dapp-core-component__main__px-4 dapp-core-component__main__m-1 dapp-core-component__main__mx-3",onClick:function(){return v(E.MaiarApp)},children:Object(g.jsx)("span",{className:"dapp-core-component__loginButtonStyles__login-text",children:"Maiar App V1.0"})}),Object(g.jsx)(P.f,{buttonClassName:"webwallet-login",loginButtonText:"Web Wallet",callbackRoute:window.location.pathname}),Object(g.jsx)("button",{className:"dapp-core-component__main__btn dapp-core-component__main__btn-primary dapp-core-component__main__px-4 dapp-core-component__main__m-1 dapp-core-component__main__mx-3",onClick:function(){return v(E.Ledger)},children:Object(g.jsx)("span",{className:"dapp-core-component__loginButtonStyles__login-text",children:"Ledger"})})]})]})}}()})]})},T=n(24),R=n(360),D=n.n(R),B=n(204),L=n(724),z=n(88),N=n.n(z),H=function(e,t){var n=e.toString().replace(",",".").split("."),i=void 0!==t?t:18;if(n[1]){for(;"0"===n[1].substring(n[1].length-1)&&n[1].length>1;)n[1]=n[1].substring(0,n[1].length-1);n[1]=n[1].slice(0,Math.min(n[1].length,18))}var a=n[1]?i-n[1].length:i;a=a<0?0:a;for(var s=n.join("")+"0".repeat(a);"0"===s.substring(0,1)&&s.length>1;)s=s.substring(1);return s},U=function(e){var t=e&&e.length>0?new N.a(e).toString(16):"0";return t.length%2!==0&&(t="0"+t),t},G=function(e){var t,n="";for(t=0;t<e.length;t++)n+=e.charCodeAt(t).toString(16).slice(-4);return n},F=n(467),V=function(e){var t=localStorage.getItem(e);if(!t)return null;var n=JSON.parse(t);return n&&Object.prototype.hasOwnProperty.call(n,"expires")&&Object.prototype.hasOwnProperty.call(n,"data")?D()().unix()>=n.expires?(localStorage.removeItem(e),null):n.data:null},Q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3600,i=D()().unix()+n;localStorage.setItem(e,JSON.stringify({expires:i,data:t}))},X=n(232),W=n(579),Y=function(e,t,n){return fetch("".concat(e,"/accounts/").concat(t,"/tokens?search=").concat(n)).then((function(e){return e.json()})).catch((function(e){console.log(e)}))},K=function(e,t,n){return fetch("".concat(e,"/accounts/").concat(t,"/nfts?search=").concat(n,"&type=MetaESDT")).then((function(e){return e.json()})).catch((function(e){console.log(e)}))},Z=n(771);var q="KRO-df97ec",J=function(){var e=_(),t=M().tokens,n=Object(f.a)().address,i=function(){var e=Object(f.a)().address,t=function(){var t=Object(y.a)(Object(x.a)().mark((function t(n,i,a){var s,o;return Object(x.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(j.a)(e);case 2:if(s=t.sent){t.next=5;break}throw new Error("Account not found");case 5:return o=s.nonce,t.abrupt("return",new Promise((function(e,t){Object(Z.a)({transactions:n.map((function(e){var t=u.find((function(t){return t.name===e.type}));if(!t)throw new Error("The contract for this action in not defined");return{chainID:l.chainId,value:H(e.value,18),data:e.getData(),receiver:e.receiver,gasLimit:t.gasLimit*e.multiplier,nonce:o++}})),transactionsDisplayInfo:a,sessionInformation:i}).then((function(n){var i=n.sessionId,a=n.error;a?t(a):e(i)}))})));case 7:case"end":return t.stop()}}),t)})));return function(e,n,i){return t.apply(this,arguments)}}(),n=function(){var e=Object(y.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.c)({message:t});case 2:return n=e.sent,e.abrupt("return",n.getSignature().hex());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{sendTransaction:t,signAccountMessage:n}}(),a=i.sendTransaction,s=p.a.useState(null),o=Object(m.a)(s,2),r=o[0],c=o[1];Object(f.c)({transactionId:r,onSuccess:function(e){},onFail:function(){},onCancelled:function(){}});Object(d.useEffect)((function(){!function(){if(n){var t=Y(Object(W.a)(),n,q),i=K(Object(W.a)(),n,"LKKRO-e6ef92");Promise.all([t,i]).then((function(t){e({type:"setTokens",tokens:[].concat(Object(T.a)(t[0]),Object(T.a)(t[1]))})}))}}()}),[n]);var h=function(e,t){var i;if(e.attributes){var s=1e3*parseInt(Object(X.a)(e.attributes).toString());i=(new Date).getTime()>s?Object(g.jsx)("div",{className:"ms-3",children:Object(g.jsx)("button",{className:"link-button text-medium px-0",onClick:function(){return function(e){var t,i=G(e.ticker)+"@"+U(null!==(t=""+e.nonce)&&void 0!==t?t:0)+"@"+U(e.balance)+"@"+new B.Address("erd1qqqqqqqqqqqqqpgqyq5g6uvx0hzwdl0864sxpdtquv0hhaa5we0s5hpa90").hex()+"@"+G("claimTokens"),s=new L.a(n,"0","ESDTNFTTransfer",i);a([s],"claimRewards","Claim Rewards").then((function(e){return c(e)}))}(e)},children:"Unlock now"})}):Object(g.jsxs)("p",{children:["\xa0- Vesting ",D()(s).from(D()())]})}return Object(g.jsxs)("div",{className:"d-flex align-items-center justify-content-center",children:[Object(g.jsx)("p",{className:"text-action",children:Object(X.b)({input:e.balance,denomination:e.decimals,decimals:4})}),"\xa0",e.identifier==q?Object(g.jsx)("img",{src:"/images/".concat(q,".gif"),width:20,alt:"KRO Token"}):Object(g.jsx)("span",{children:e.ticker.split("-").first()}),i]},t)};return Object(g.jsx)(p.a.Fragment,{children:Object(g.jsx)("div",{className:"d-flex flex-column align-items-center justify-content-center mb-3",children:t.map((function(e,t){return h(e,t)}))})})},$=n(8),ee=n(9);Array.prototype.unique=function(){for(var e=this.concat(),t=0;t<e.length;++t)for(var n=t+1;n<e.length;++n)e[t]===e[n]&&e.splice(n--,1);return e},Array.prototype.insert=function(e,t){this.splice(e,0,t)},Array.prototype.serialized=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;return e?t.map((function(e){return e.serializeMin()})):t.map((function(e){return e.serialize()}))},Array.prototype.remove=function(e){var t=this.indexOf(e);return t>-1&&(this.splice(t,1),!0)},Array.prototype.last=function(){var e=this;return e.length>0?e[e.length-1]:null},Array.prototype.first=function(){return this.length>0?this[0]:null},Array.prototype.image=function(){var e=this;if(1==e.length)return e[0];if(e.length>0){var t=e.filter((function(e){return/\.(gif|jpe?g|tiff?|png|webp|bmp)$/i.test(e)}));return t.length>0?t[0]:void 0}},Array.prototype.json=function(){if(this.length>0){var e=this.filter((function(e){return/\.(json)$/i.test(e)}));return e.length>0?e[0]:void 0}},Date.prototype.addSeconds=function(e){var t=1e3*e;return this.setTime(this.getTime()+t),this},String.prototype.truncate=function(e,t){var n=this;if(n.length<=e)return""+n;var i=e-(t=t||"...").length,a=Math.ceil(i/2),s=Math.floor(i/2);return n.substr(0,a)+t+n.substr(n.length-s)},String.prototype.toJson=function(){return this.replace(/\.[^.]+$/,".json")},String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var te=n(34),ne=n(18),ie=n(14),ae=n(15),se=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e){var i;return Object($.a)(this,n),(i=t.call(this)).entities=void 0,i.hide=function(){i.visible=!1},i.show=function(){i.visible=!0},i.add=function(e,t){i.addChild(t),i.entities[e]=t},i.get=function(e){return i.entities[e]},i.getAll=function(){return Object.values(i.entities)},i.getAllKeys=function(){return Object.keys(i.entities)},i.length=function(){return Object.keys(i.entities).length},i.remove=function(e){i.removeChild(i.entities[e]),delete i.entities[e]},i.name=e,i.entities={},i}return Object(ee.a)(n)}(ne.Container),oe=n(49),re=["full","half"];function ce(e,t,n,i){return Math.atan2(t-i,e-n)}function he(e,t){if(e==t&&0==t)return 0;var n=Math.atan2(t,e);return Math.floor(fe(n))}function le(e,t){var n=Math.abs(e-t)%360,i=n>180?360-n:n;return i*=e-t>=0&&e-t<=180||e-t<=-180&&e-t>=-360?1:-1}function ue(e){var t=e%360;return t<0&&(t+=360),t}function de(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=pe(e);return new Ee(t*Math.cos(n),t*Math.sin(n))}function pe(e){return e*(Math.PI/180)}function fe(e){return e*(180/Math.PI)}function ge(e,t,n){return(1-n)*e+n*t}function ve(e,t,n,i){return Math.hypot(n-e,i-t)}function me(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function be(e,t,n){return Math.min(Math.max(e,t),n)}function xe(e){return Math.round(Math.round(1e3*e)/10)/100}function ye(e){return e-Math.floor(e)}function je(e,t){return Math.sqrt(e*e+t*t)}function Ae(e){var t=e%360;return["E","NE","N","NW","W","SW","S","SE"][Math.round((t<0?e+360:e)/45)%8]}function Oe(e,t,n){return n+t-e}function Se(e,t){var n=e%t;return n<t/2?-n:t-n}function we(e){for(var t=Object(T.a)(e),n=t.length-1;n>0;n--){var i=Math.floor(Math.random()*(n+1)),a=t[n];t[n]=t[i],t[i]=a}return t}function Ce(e,t){var n=Date.now()-e,i=t-e;return Math.min(1,n/i)}function ke(){return Math.random()<.5?-1:1}var Me,_e,Ee=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object($.a)(this,e),this.x=t,this.y=n}return Object(ee.a)(e,[{key:"normalize",value:function(){var t=je(this.x,this.y);return new e(this.x/t,this.y/t)}},{key:"setMax",value:function(e){this.x=Math.min(this.x,e),this.y=Math.min(this.y,e)}},{key:"setMin",value:function(e){this.x=Math.max(this.x,e),this.y=Math.max(this.y,e)}},{key:"clamp",value:function(e,t){this.x=be(this.x,-e,e),this.y=be(this.y,-t,t)}},{key:"decrease",value:function(e){this.x>0?(this.x-=e,this.x=Math.max(this.x,0)):this.x<0&&(this.x+=e,this.x=Math.min(this.x,0)),this.y>0?(this.y-=e,this.y=Math.max(this.y,0)):this.y<0&&(this.y+=e,this.y=Math.min(this.y,0))}},{key:"set",value:function(e,t){this.x=e,this.y=t}},{key:"toString",value:function(){return"x: ".concat(this.x,", y: ").concat(this.y)}},{key:"equal",value:function(e){return this.x==e.x&&this.y==e.y}},{key:"closeBy",value:function(e){return Math.abs(this.x-e.x)<100&&Math.abs(this.y-e.y)<100}},{key:"minus",value:function(t){return new e(Math.floor(this.x-t.x),Math.floor(this.y-t.y))}},{key:"isEmpty",get:function(){return 0===this.x&&0===this.y}}]),e}(),Pe=function(){function e(t,n,i,a){Object($.a)(this,e),this.x=t,this.y=n,this.width=i,this.height=a}return Object(ee.a)(e,[{key:"copy",value:function(){return new e(this.x,this.y,this.width,this.height)}},{key:"left",get:function(){return this.x},set:function(e){this.x=e}},{key:"top",get:function(){return this.y},set:function(e){this.y=e}},{key:"right",get:function(){return this.x+this.width},set:function(e){this.x=e-this.width}},{key:"bottom",get:function(){return this.y+this.height},set:function(e){this.y=e-this.height}},{key:"position",get:function(){return new Ee(this.x+this.width/2,this.y+this.height/2)},set:function(e){this.x=e.x,this.y=e.y}},{key:"center",get:function(){return new Ee(this.x+this.width/2,this.y+this.height/2)}}]),e}(),Ie=function(){function e(t,n,i){Object($.a)(this,e),this.x=t,this.y=n,this.radius=i}return Object(ee.a)(e,[{key:"copy",value:function(){return new e(this.x,this.y,this.radius)}},{key:"left",get:function(){return this.x-this.radius},set:function(e){this.x=e+this.radius}},{key:"top",get:function(){return this.y-this.radius},set:function(e){this.y=e+this.radius}},{key:"right",get:function(){return this.x+this.radius},set:function(e){this.x=e-this.radius}},{key:"bottom",get:function(){return this.y+this.radius},set:function(e){this.y=e-this.radius}},{key:"width",get:function(){return 2*this.radius}},{key:"height",get:function(){return 2*this.radius}},{key:"box",get:function(){return new Pe(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}]),e}(),Te=n(779),Re=(n.n(Te).a,function(e,t){var n=e.x+e.width/2-(t.x+t.width/2),i=e.y+e.height/2-(t.y+t.height/2),a=(e.width+t.width)/2,s=(e.height+t.height)/2,o=a*i,r=s*n,c="none";return Math.abs(n)<=a&&Math.abs(i)<=s&&(c=o>r?o>-r?"bottom":"left":o>-r?"right":"top"),c}),De=function(e,t){return Re(e.box,t)},Be="KROGANVERSE",Le=50,ze=1375,Ne=1e3,He=!1,Ue="lobby",Ge=1,Fe=16,Ve=5,Qe="#08070C";!function(e){e[e.DEFAULT=5875897]="DEFAULT",e[e.HIGHLIGHT=9627899]="HIGHLIGHT",e[e.HIDDEN=2631720]="HIDDEN"}(Me||(Me={})),function(e){e[e.RED=13716299]="RED",e[e.BLUE=4961489]="BLUE",e[e.GREEN=8309118]="GREEN"}(_e||(_e={}));var Xe=32,We=2e3,Ye=function(e){return 10*(e-1)*1e3},Ke=90,Ze=32,qe=.06,Je=30,$e="set_username",et="set_spaceships",tt="KROGAN-54c361",nt=12e3,it=100,at=8*it*2,st=[{id:"team_1",color:13716299,name:"Team RED"},{id:"team_2",color:4961489,name:"Team BLUE"},{id:"team_3",color:8309118,name:"Team GREEN"}];Array.prototype.isEmpty=function(){return 0==this.length},Array.prototype.insert=function(e,t){this.splice(e,0,t)},Array.prototype.serialized=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?this.map((function(e){return e.serializeMin()})):this.map((function(e){return e.serialize()}))},Array.prototype.remove=function(e){var t=this.indexOf(e);return t>-1&&(this.splice(t,1),!0)},Array.prototype.last=function(){return this.length>0?this[this.length-1]:null},Array.prototype.first=function(){return this.length>0?this[0]:null},Date.prototype.addSeconds=function(e){var t=1e3*e;return this.setTime(this.getTime()+t),this},String.prototype.truncate=function(e,t){if(this.length<=e)return""+this;var n=e-(t=t||"...").length,i=Math.ceil(n/2),a=Math.floor(n/2);return this.substr(0,i)+t+this.substr(this.length-a)};var ot,rt=n(780),ct=n.n(rt),ht=function(){function e(t){var n;Object($.a)(this,e),this.x=t.x,this.y=t.y,this.z=t.z,this.noGo=null!==(n=t.noGo)&&void 0!==n&&n,this.base=t.base,this.neighbors=[],this.opened=!1,this.closed=!1}return Object(ee.a)(e,[{key:"getF",value:function(){var e,t;return(null!==(e=this.h)&&void 0!==e?e:0)+(null!==(t=this.g)&&void 0!==t?t:0)}},{key:"equals",value:function(e){return this.x==e.x&&this.y==e.y&&this.z==e.z}},{key:"reset",value:function(){this.parent=void 0,this.h=void 0,this.g=void 0,this.opened=!1,this.closed=!1}},{key:"toString",value:function(){return e.getKey(this.x,this.y,this.z)}},{key:"getRoomName",value:function(){return e.getRoomName(this.x,this.y,this.z)}},{key:"toJSON",value:function(){return{x:this.x,y:this.y,z:this.z}}},{key:"toTile",value:function(){return{x:this.x+Math.ceil(this.y/2),y:this.y}}}],[{key:"getKey",value:function(e,t,n){return"".concat(e,", ").concat(t,", ").concat(n)}},{key:"getRoomName",value:function(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)}}]),e}(),lt=function(e){return(e-nt)/nt},ut=function(e){return Math.round(e*nt+nt)};!function(e){e[e.NE=0]="NE",e[e.NW=1]="NW",e[e.E=2]="E",e[e.W=3]="W",e[e.SE=4]="SE",e[e.SW=5]="SW",e[e.ERR=6]="ERR"}(ot||(ot={}));var dt=function(){function e(t,n){var i=this;Object($.a)(this,e),this.coordinates={},this.coordinateList=[],this.width=t,this.height=n,pt.forEach((function(e){var t=new ht(e);i.coordinates[t.toString()]=t,i.coordinateList.push(t)})),this.coordinateList.forEach((function(e){e.neighbors=i.coordinateNeighbours(e)}))}return Object(ee.a)(e,[{key:"isVectorOutside",value:function(e,t){return e<0||e>this.width||t<0||t<this.height}},{key:"isRectangleOutside",value:function(e){return e.x<0||e.right>this.width||e.y<0||e.bottom>this.height}},{key:"isCircleOutside",value:function(e){return e.left<0||e.right>this.width||e.top<0||e.bottom>this.height}},{key:"clampRectangle",value:function(e){return new Ee(i.clamp(e.x,0,this.width-e.width),i.clamp(e.y,0,this.height-e.height))}},{key:"clampCircle",value:function(e){return new Ee(i.clamp(e.x,e.radius,this.width-e.radius),i.clamp(e.y,e.radius,this.height-e.radius))}},{key:"setDimensions",value:function(e,t){this.width=e,this.height=t}},{key:"teamBaseCoordinate",value:function(e){var t=st.findIndex((function(t){return t.id==e}));return this.coordinateList.filter((function(e){return e.base==t})).first()}},{key:"coordinateNeighbours",value:function(e){var t=[e.x,e.y,e.z],n=t[0],i=t[1],a=t[2],s=[],o=this.getCoordinate(n-1,i,a+1);o&&s.push(o);var r=this.getCoordinate(n+1,i,a-1);r&&s.push(r);var c=this.getCoordinate(n-1,i+1,a);c&&s.push(c);var h=this.getCoordinate(n,i+1,a-1);h&&s.push(h);var l=this.getCoordinate(n,i-1,a+1);l&&s.push(l);var u=this.getCoordinate(n+1,i-1,a);return u&&s.push(u),s}},{key:"getCoordinate",value:function(e,t,n){return this.coordinates[ht.getKey(e,t,n)]}},{key:"getCoordinateWithData",value:function(e){return this.coordinates[ht.getKey(e.x,e.y,e.z)]}},{key:"distance",value:function(e,t){return Math.max(Math.abs(e.x-t.x),Math.abs(e.y-t.y),Math.abs(e.z-t.z))}},{key:"arrivalDirection",value:function(e,t){if(e.y==t.y){if(e.x>t.x)return ot.W;if(e.x<t.x)return ot.E}if(e.z==t.z){if(e.y>t.y)return ot.SE;if(e.y<t.y)return ot.NW}if(e.x==t.x){if(e.y>t.y)return ot.SW;if(e.y<t.y)return ot.NE}return ot.ERR}},{key:"hexAreaAngleBoundries",value:function(e){switch(e){case ot.SW:return{min:30,max:90};case ot.SE:return{min:90,max:150};case ot.E:return{min:150,max:210};case ot.NE:return{min:210,max:270};case ot.NW:return{min:270,max:330};case ot.W:return{min:-30,max:30};case ot.ERR:return{min:0,max:0}}}},{key:"pathFinding",value:function(e,t){var n,i=[],a=new ct.a((function(e,t){return e.getF()-t.getF()}));for(e.h=this.distance(e,t),e.g=0,a.push(e),i.push(e);!a.empty();){var s=a.pop();if(!s)break;if(s.closed=!0,s===t)return{path:this.backtrace(s),references:i};for(var o=0;o<s.neighbors.length;o++){var r=s.neighbors[o];if(!r.closed&&!r.noGo){var c=s.g?s.g+1:1;(!r.opened||c<(null!==(n=r.g)&&void 0!==n?n:0))&&(r.h=this.distance(r,t),r.g=c,r.parent=s,r.opened?a.updateItem(r):(r.opened=!0,a.push(r),i.push(r)))}}}return{path:[],references:[]}}},{key:"backtrace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.push(e),e.parent?this.backtrace(e.parent,t):t}}]),e}(),pt=n(734),ft=["KeyW","ArrowUp"],gt=["KeyS","ArrowDown"],vt=["KeyA","ArrowLeft"],mt=["KeyD","ArrowRight"],bt=["Space"],xt=["Escape"],yt=Object(ee.a)((function e(){var t=this;Object($.a)(this,e),this.add=function(e,n){t.entities[e]=n},this.forceGet=function(e){if(!t.entities[e])throw new Error("[ObjectMap] ".concat(e," not found"));return t.entities[e]},this.get=function(e){return t.entities[e]},this.getAll=function(){return Object.values(t.entities)},this.getAllKeys=function(){return Object.keys(t.entities)},this.forEach=function(e){return Object.keys(t.entities).forEach((function(n){e(t.entities[n],n)}))},this.map=function(e){return Object.keys(t.entities).map((function(n){e(t.entities[n],n)}))},this.length=function(){return Object.keys(t.entities).length},this.remove=function(e){delete t.entities[e]},this.entities={}})),jt=function(e,t,n,i){return new(n||(n=Promise))((function(a,s){function o(e){try{c(i.next(e))}catch(t){s(t)}}function r(e){try{c(i.throw(e))}catch(t){s(t)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}c((i=i.apply(e,t||[])).next())}))},At=function(){function e(){Object($.a)(this,e)}return Object(ee.a)(e,null,[{key:"lock",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return jt(this,void 0,void 0,Object(x.a)().mark((function a(){var s,o;return Object(x.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.lockArray.includes(t)){a.next=3;break}return i&&console.log("".concat(t," is already running")),a.abrupt("return");case 3:return e.lockArray.push(t),s=void 0,a.prev=5,a.next=8,n();case 8:s=a.sent,a.next=15;break;case 11:a.prev=11,a.t0=a.catch(5),i&&console.error("Error running ".concat(t)),i&&console.error(a.t0,a.t0.stack);case 15:return a.prev=15,(o=e.lockArray.indexOf(t))>=0&&e.lockArray.splice(o,1),a.finish(15);case 19:return a.abrupt("return",s);case 20:case"end":return a.stop()}}),a,null,[[5,11,15,19]])})))}}]),e}();At.lockArray=[];var Ot,St=function(){function e(){Object($.a)(this,e),this.listeners={}}return Object(ee.a)(e,[{key:"on",value:function(e,t){this.listeners[e]&&!this.listeners[e].includes(t)?this.listeners[e].push(t):this.listeners[e]=[t]}},{key:"send",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];console.log("New event ".concat(e)),console.log(n),console.log("------------------");var a=this.listeners[e];a&&a.length>0&&a.forEach((function(e){e.apply(void 0,n)}))}},{key:"remove",value:function(e,t){this.listeners[e]&&this.listeners[e].includes(t)&&this.listeners[e].remove(t)}}]),e}(),wt=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,a,s){var o;return Object($.a)(this,n),(o=t.call(this))._touchPoint=new ne.Point,o._drag=!1,o.interactive=!0,o.cursor="pointer",o.hitArea=new ne.Circle(0,0,e),a&&(o.on("pointerover",(function(){o.zIndex=99,o.setHover(!0),a(Object(oe.a)(o))})),o.on("pointerout",(function(){o.zIndex=0,o.setHover(!1)}))),s&&(o.on("pointerdown",(function(e){e.stopPropagation(),o._touchPoint=e.data.getLocalPosition(o.parent),o._drag=!1})),o.on("pointermove",(function(e){var t=e.data.getLocalPosition(o.parent);i.getDistance(o._touchPoint.x,o._touchPoint.y,t.x,t.y)>5&&(o._drag=!0)})),o.on("pointerup",(function(){o._drag||s(Object(oe.a)(o))}))),o}return Object(ee.a)(n,[{key:"setHover",value:function(e){}}]),n}(ne.Container),Ct=function(){if(window.document.location.host.includes("localhost")){var e=window.document.location.host.replace(/:.*/,""),t=s.WS_PORT;return"wss://".concat(e).concat(t?":".concat(t):"")}return"wss://server.kroganverse.com"},kt=function(){return"".concat("https:"===location.protocol?"https://":"http://").concat(window.document.location.host)},Mt=n.p+"static/media/map.d5e8d141.png",_t=n.p+"static/media/shield.63ec1791.png",Et=n.p+"static/media/ship-icon.9758546b.png",Pt=n.p+"static/media/starbase-icon.bead8497.png";!function(e){e.MapBackground="mapBackground",e.NoGoZone="noGoZone"}(Ot||(Ot={}));var It,Tt=function(e){return ne.Loader.shared.resources[e].texture},Rt=function(e){return ne.Loader.shared.resources[e].spritesheet},Dt=function(e,t){return"https://krogancoin.com/QmeeQK6V9uv71xyNbGy5q1PHRuBHy1EYXVMs9sS5bP1iYY/".concat(e,"/").concat(t)},Bt=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i,a,s){var o;Object($.a)(this,n);var r=1;a>=4&&(r=2),a>=7&&(r=3);var c="thruster-".concat(r,"-s"),h=Rt(c);return(o=t.call(this,h.animations.thrusters)).level=void 0,o.type=void 0,o.moving=!1,o.anchor.set(.5,0),o.x=e,o.y=i,o.scale.x=s,o.scale.y=s,o.animationSpeed=.2,o.level=a,o.type=r,o.play(),o.onLoop=function(){if(!o.moving){console.log("Engines started");var e="thruster-".concat(r,"-m"),t=Rt(e);o.textures=t.animations.thrusters,o.play(),o.moving=!0}},o}return Object(ee.a)(n)}(ne.AnimatedSprite),Lt=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i,a){var o;return Object($.a)(this,n),(o=t.call(this)).container=void 0,o.sprite=void 0,o.thrusters=[],o._radius=void 0,o.container=new ne.Container,o.container.angle=s.SPACESHIP_ROTATION,o.addChild(o.container),a.baseTexture.mipmap=ne.MIPMAP_MODES.POW2,o.sprite=new ne.Sprite(a),o.sprite.anchor.set(.5),o.sprite.width=2*i,o.sprite.height=2*i,o.angle=e.angle,o.sprite.zIndex=99,o.container.addChild(o.sprite),o._radius=i,o}return Object(ee.a)(n,[{key:"addThrusters",value:function(e,t){var n=this;t&&t.length>0&&t.forEach((function(t){var i=t.x*(2*n._radius)-n._radius,a=t.y*(2*n._radius)-n._radius,s=new Bt(i,a,e,n._radius/100*t.scale);n.container.addChild(s),n.thrusters.push(s)}))}},{key:"removeThrusters",value:function(){var e=this;this.thrusters.forEach((function(t){e.container.removeChild(t)})),this.thrusters=[]}}]),n}(ne.Container),zt=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i,o,r){var c;return Object($.a)(this,n),(c=t.call(this))._sprite=void 0,c._body=void 0,c._boundaries=void 0,c._specs=void 0,c._toX=0,c._toY=0,c._speed=0,c._toAngle=0,c._velocity=new a.Vector2(0,0),c._destination=void 0,c._sprite=new Lt(i,o,r),c._sprite.zIndex=99,c.addChild(c._sprite),c._body=new a.CircleBody(i.x,i.y,o),s.DEBUG&&(c._boundaries=new ne.Graphics,c._boundaries.lineStyle(.5,16711935),c._boundaries.drawCircle(0,0,o),c._boundaries.endFill(),c.addChild(c._boundaries)),c._specs=e,c.toX=i.x,c.toY=i.y,c.toAngle=i.angle,c.position.set(i.x,i.y),c.sortableChildren=!0,console.log("Initialized on x: ".concat(c.x,", y: ").concat(c.y)),c}return Object(ee.a)(n,[{key:"move",value:function(e,t){var n,a,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._destination&&o&&(this.destination=void 0,console.log("Destination cleared by user action")),e.isEmpty||(this.toAngle=i.angleFromVector(e.x,e.y),this._speed=i.clamp(this._speed+this._specs.acceleration,0,this._specs.speed)),this._velocity=i.vectorFromAngle(this._sprite.angle,this._speed),this.velocity.isEmpty)return this.velocity;var r=this.x+(null!==(n=null===t||void 0===t?void 0:t.x)&&void 0!==n?n:this._velocity.x),c=this.y+(null!==(a=null===t||void 0===t?void 0:t.y)&&void 0!==a?a:this._velocity.y);return this.position.set(r,c),this.toX=this.x,this.toY=this.y,this._speed=i.clamp(this._speed-s.SPACE_FRICTION,0,this._specs.speed),this.turnIfNeeded(),this._velocity}},{key:"turnIfNeeded",value:function(){var e=i.getAngleDiff(i.positiveAngle(this._sprite.angle),i.positiveAngle(this.toAngle)),t=this._specs.acceleration*s.ROTATION_SPEED;if(Math.abs(e)<t)this._sprite.angle=this.toAngle;else{var n=t;e>0&&(n*=-1);var a=this._sprite.angle+n;this._sprite.angle=a}}},{key:"shouldSlide",value:function(){return!this.velocity.isEmpty&&!this.destination}},{key:"update",value:function(e){e.x&&(this._body.x=e.x,this.x=e.x),e.y&&(this._body.y=e.y,this.y=e.y),e.angle&&(this._sprite.angle=e.angle),e.radius&&(this._body.radius=e.radius,this.width=2*e.radius,this.height=2*e.radius)}},{key:"destination",get:function(){return this._destination},set:function(e){this._destination=e}},{key:"body",get:function(){return this._body}},{key:"toX",get:function(){return this._toX},set:function(e){this._toX=e}},{key:"toY",get:function(){return this._toY},set:function(e){this._toY=e}},{key:"toAngle",get:function(){return this._toAngle},set:function(e){this._toAngle=e}},{key:"velocity",get:function(){return this._velocity}}]),n}(ne.Container),Nt=(ne.Graphics,n(86)),Ht=n(66),Ut=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i,a,s){var o,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:15;Object($.a)(this,n),(o=t.call(this)).start=void 0,o.end=void 0,o.start=new ne.Point(e,i),o.end=new ne.Point(a,s),o.lineStyle(1,16777215,.5);var h=a-e,l=s-i,u=Math.sqrt(h*h+l*l),d=u/(r+c),p=r/(r+c),f=h/d*p,g=h/d-f,v=l/d*p,m=l/d-v;for(o.moveTo(e,i);u>0;)e+=f,i+=v,(u-=r)<0&&(e=a,i=s),o.lineTo(e,i),e+=g,i+=m,o.moveTo(e,i),u-=c;return o.moveTo(a,s),o}return Object(ee.a)(n,[{key:"pointAt",value:function(e){return new ne.Point(i.lerp(this.start.x,this.end.x,e),i.lerp(this.start.y,this.end.y,e))}},{key:"distance",get:function(){var e=Math.abs(this.start.x-this.end.x),t=Math.abs(this.start.y-this.end.y);return Math.sqrt(e*e+t*t)}},{key:"angle",get:function(){return 180*Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)/Math.PI}}]),n}(ne.Graphics),Gt=3600,Ft=86400,Vt=2629800,Qt=function(e){var t=function(e){var t=Math.abs(e),n={months:0,days:0,hours:0,minutes:0,seconds:0};return t>=Vt&&(n.months=Math.floor(t/Vt),t-=n.months*Vt),t>=Ft&&(n.days=Math.floor(t/Ft),t-=n.days*Ft),t>=Gt&&(n.hours=Math.floor(t/Gt),t-=n.hours*Gt),t>=60&&(n.minutes=Math.floor(t/60),t-=60*n.minutes),n.seconds=Math.round(t),n}(e);return t.months>0?"".concat(t.months,"M ").concat(t.days,"D"):t.days>0?"".concat(t.days,"D ").concat(t.hours,"H"):t.hours>0?"".concat(t.hours,"H ").concat(t.minutes,"m"):t.minutes>0?"".concat(t.minutes,"m ").concat(t.seconds,"s"):"".concat(t.seconds,"s")},Xt=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i){var a;Object($.a)(this,n),(a=t.call(this))._sprite=void 0;a.x=e,a.y=i,a.zIndex=100;var s=ne.Texture.from(Et);return s.baseTexture.mipmap=ne.MIPMAP_MODES.POW2,a._sprite=new ne.Sprite(s),a._sprite.anchor.x=.5,a._sprite.anchor.y=.5,a._sprite.width=64,a._sprite.height=64,a.addChild(a._sprite),a}return Object(ee.a)(n,[{key:"alignOnPath",value:function(e){this.x=e.position.x,this.y=e.position.y,this.angle=e.angle}}]),n}(ne.Container);!function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"}(It||(It={}));var Wt=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,a){var o;Object($.a)(this,n),(o=t.call(this))._segments=[],o._spaceship=void 0,o._time=void 0,o.timer=void 0;var r=e.length;o.drawNextSegment(e);var c=e.first(),h=ne.Texture.from("data:image/png;base64,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");h.baseTexture.mipmap=ne.MIPMAP_MODES.POW2;var l=new ne.Sprite(h);l.anchor.x=.5,l.anchor.y=.5,l.width=20,l.height=18,l.x=c.x,l.y=c.y,o.addChild(l),o._time=new mn("Warp",8),o._time.x=c.x+9,o._time.y=c.y-18,o.addChild(o._time);var u=new Xt(-100,-100);if(o.addChild(u),o._spaceship=u,a){var d=i.getTimeProgress(a.start,a.end);u.alignOnPath(o.getPathPosition(d)),o.timer=setInterval((function(){o.updateSpaceshipPosition(a)}),1e3)}else{u.alignOnPath(o.getPathPosition(0));var p=s.PATH_TIME(r),f=Qt(p/1e3);o._time.setText(f)}return o.zIndex=100,o}return Object(ee.a)(n,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),Object(Nt.a)(Object(Ht.a)(n.prototype),"destroy",this).call(this)}},{key:"updateSpaceshipPosition",value:function(e){var t=i.getTimeProgress(e.start,e.end);1==t&&this.destroy(),this._spaceship.alignOnPath(this.getPathPosition(t));var n=(e.end-Date.now())/1e3;console.log("[Travel][Update] Time left: ".concat(n));var a=Qt(n);this._time.setText(a)}},{key:"drawNextSegment",value:function(e){if(!(e.length<2)){var t=e.pop(),n=t,i=e.pop(),a=this.getPathDirection(n,i),s=a;do{if(n=i,!(i=e.pop()))break;s=this.getPathDirection(n,i)}while(a==s);t&&n&&(this.drawPath(t,n),i&&e.push(i),e.push(n)),this.drawNextSegment(e)}}},{key:"getPathDirection",value:function(e,t){return e.coordinate.x==t.coordinate.x?It.X:e.coordinate.y==t.coordinate.y?It.Y:It.Z}},{key:"drawPath",value:function(e,t){var n=new Ut(e.position.x,e.position.y,t.position.x,t.position.y);this.addChild(n),this._segments.push(n)}},{key:"getPathPosition",value:function(e){for(var t=this._segments.reduce((function(e,t){return e+t.distance}),0),n=0,i=0;i<this._segments.length;i++){var a=this._segments[i];if(n+a.distance>t*e){var s=(t*e-n)/a.distance;return{position:a.pointAt(s),angle:a.angle}}n+=a.distance}return{position:new ne.Point(0,0),angle:0}}}]),n}(ne.Container),Yt=n(76),Kt=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,a,s){var o;Object($.a)(this,n);var r=Yt.Texture.from("laser-beam");r.baseTexture.mipmap=ne.MIPMAP_MODES.POW2,(o=t.call(this,r,1,5)).asteroid=void 0,o.toWidth=1,o.defaultHeight=void 0,o.slowDownAnimation=1,o.currentFrame=0,o.sparks=void 0;var c=i.getDistance(s.x,s.y,a.position.x,a.position.y);return o.toWidth=c-10,o.defaultHeight=5,o.angle=e,o.anchor.set(0,.5),o.asteroid=a,o}return Object(ee.a)(n,[{key:"animate",value:function(){this.currentFrame++,this.currentFrame==this.slowDownAnimation&&(1==this.scale.y?(this.scale.y=1.4,this.tint=16711422):(this.tint=16777215,this.scale.y=1),this.width<this.toWidth&&(this.width+=20),this.width>this.toWidth&&(this.width=this.toWidth,this.attachSparks()),this.currentFrame=0)}},{key:"attachSparks",value:function(){console.log("Attaching sparks");var e=Rt("beam-sparks");e&&(this.sparks=new ne.AnimatedSprite(e.animations["beam-sparks-sheet"]),this.sparks.animationSpeed=.2,this.sparks.anchor.set(.5,0),this.sparks.angle=-90,this.sparks.x=this.width-this.sparks.height,this.addChild(this.sparks),this.sparks.play())}}]),n}(n(781).a),Zt=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i){var a;return Object($.a)(this,n),(a=t.call(this,Tt("shield"))).radius=void 0,a.shield=void 0,a.graphics=new ne.Graphics,a.radius=i,a.shield=e,a.width=2*i,a.height=2*i,a.anchor.set(.5,.5),e.onChange=function(){console.log("[Shield][Update]"),a.adjustMask(),a.visible=a.shield.effectiveness>0},a.adjustMask(),a.addChild(a.graphics),a.mask=a.graphics,a}return Object(ee.a)(n,[{key:"adjustMask",value:function(){this.graphics.clear(),this.graphics.lineStyle(0,16711680,1),this.graphics.beginFill(16711680),this.graphics.moveTo(0,0);var e=this.shield.angle-this.shield.size/2,t=i.vectorFromAngle(e,5*this.radius);this.graphics.lineTo(t.x,t.y);var n=this.shield.angle+this.shield.size/2,a=i.vectorFromAngle(n,5*this.radius);this.graphics.lineTo(a.x,a.y),this.graphics.lineTo(0,0),this.graphics.endFill()}}]),n}(ne.Sprite),qt=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i,a,o){var r;return Object($.a)(this,n),(r=t.call(this,e.info.specs,e.position,e.radius,i))._playerId="",r._nonce=void 0,r._beam=void 0,r._nameTextSprite=void 0,r._shield=void 0,r._moving=void 0,r._mining=void 0,r._lastShoot=void 0,r.spaceship=void 0,r.ack=void 0,r.player=void 0,r.playerId=e.playerId,r.spaceship=e,r.player=o,r._moving=!1,r._nonce=e.nonce,r._lastShoot=0,r._nameTextSprite=new tn(r.username,8,.5,1),r._nameTextSprite.position.set(0,-(r.half+8)),r._nameTextSprite.zIndex=2,r.addChild(r._nameTextSprite),r._shield=new Zt(e.stats.shield,1.2*e.radius),r._shield.zIndex=3,r.addChild(r._shield),a&&(r.visible=s.DEBUG,r._nameTextSprite.visible=s.DEBUG,r._shield.visible=!1),e.stats.listen("health",(function(){r.updateHud()})),r.updateHud(),r}return Object(ee.a)(n,[{key:"canShoot",value:function(){return Date.now()-this._lastShoot>this.spaceship.info.specs.fireRate}},{key:"shoot",value:function(){this._lastShoot=Date.now()}},{key:"updateHud",value:function(){this.username="".concat(this.username," HP: ").concat(this.spaceship.stats.health)}},{key:"resetSpaceship",value:function(){this.destination&&(this.destination=void 0)}},{key:"updatePlayer",value:function(e,t){var n;this._nameTextSprite.text=null!==(n=null===t||void 0===t?void 0:t.username)&&void 0!==n?n:this.spaceship.team,e&&(this._sprite.visible=s.DEBUG,this._nameTextSprite.visible=s.DEBUG,this._shield.visible=!1)}},{key:"selfControl",value:function(){if(this._destination){var e=new a.Vector2(this.position.x,this.position.y);if(!e.closeBy(this._destination)){var t=this._destination.minus(e).normalize();return{dir:t,velocity:this.move(t,void 0,!1)}}this._destination=void 0}}},{key:"animate",value:function(){var e;null===(e=this._beam)||void 0===e||e.animate(),this.updateMining()}},{key:"updateMining",value:function(){this.spaceship.mining?this._mining?(this._beam&&this._beam.asteroid.nonce!=this.spaceship.mining.nonce&&(this.removeChild(this._beam),this._beam=void 0,this.mineAsteroid(this.spaceship.mining)),this.angle!=this.toAngle?this.turnIfNeeded():this._beam||(this._beam=new Kt(this._sprite.angle,this.spaceship.mining,this.spaceship.position),this.addChild(this._beam))):this.mineAsteroid(this.spaceship.mining):this.resetMining()}},{key:"mineAsteroid",value:function(e){var t=i.getDistance(this.position.x,this.position.y,e.position.x,e.position.y);if(console.log("[Asteroid] Distance ".concat(t)),t>1e3)return console.log("Too far");var n=i.getDegrees(i.calculateAngle(e.position.x,e.position.y,this.position.x,this.position.y));this.toAngle=n,this._mining=e,console.log("Asteroid angle: ".concat(n))}},{key:"resetMining",value:function(){this._beam&&(this.removeChild(this._beam),this._beam=void 0,this._mining=void 0)}},{key:"playerId",get:function(){return this._playerId},set:function(e){this._playerId=e}},{key:"username",get:function(){var e,t;return null!==(e=null===(t=this.player)||void 0===t?void 0:t.username)&&void 0!==e?e:this.spaceship.team},set:function(e){this._nameTextSprite.text=e}},{key:"moving",set:function(e){e!=this._moving&&(this._moving=e,e?this._sprite.addThrusters(this.spaceship.info.level,this.spaceship.info.thrusters):this._sprite.removeThrusters())}},{key:"angle",get:function(){return this._sprite.angle}},{key:"nonce",get:function(){return this._nonce}},{key:"half",get:function(){return this.body.radius}},{key:"toPosition",get:function(){return{toX:this.toX,toY:this.toY}}},{key:"nameTextSprite",get:function(){return this._nameTextSprite}}],[{key:"loadSpaceshipTexture",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.Texture.fromURL(Dt(t.info.level,t.info.image));case 2:return(n=e.sent).baseTexture.mipmap=ne.MIPMAP_MODES.POW2,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(zt),Jt=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i,a){var s;Object($.a)(this,n);var o=a?function(e){a(e)}:void 0;return(s=t.call(this,n.size/2,void 0,o))._spaceship=void 0,s._sprite=void 0,s._hexWidth=void 0,s._spaceship=i,s._hexWidth=e,s.zIndex=100,s.updatePosition(),s.createSprite(),i.onChange=function(){console.log("[MapSpaceship][OnChange] nonce ".concat(i.nonce)),s.updatePosition()},s}return Object(ee.a)(n,[{key:"createSprite",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qt.loadSpaceshipTexture(this.spaceship);case 2:t=e.sent,this._sprite=new ne.Sprite(t),this._sprite.anchor.x=.5,this._sprite.anchor.y=.5,this._sprite.angle=s.SPACESHIP_ROTATION,this._sprite.width=n.size,this._sprite.height=n.size,this.addChild(this._sprite);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updatePosition",value:function(){this.x=o.worldToHex(this.spaceship.position.x)*(this._hexWidth/2),this.y=o.worldToHex(this.spaceship.position.y)*(this._hexWidth/2),this.angle=this.spaceship.position.angle}},{key:"alignOnPath",value:function(e){this.x=e.position.x,this.y=e.position.y,this.angle=e.angle}},{key:"spaceship",get:function(){return this._spaceship}}]),n}(wt);Jt.size=64;ne.Container;var $t,en=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i,a,s,o,r){var c;return Object($.a)(this,n),(c=t.call(this))._radius=void 0,c._radius=a,c.x=e,c.y=i,c.generatePath(s,o,r),c}return Object(ee.a)(n,[{key:"generatePath",value:function(e,t,n){this.beginFill(null!==t&&void 0!==t?t:0,null!==n&&void 0!==n?n:0),this.lineStyle({width:1,color:e,alpha:1}),this.moveTo(0,-this._radius),this.lineTo(this.width/2,-this._radius/2),this.lineTo(this.width/2,this._radius/2),this.lineTo(0,this._radius),this.lineTo(-this.width/2,this._radius/2),this.lineTo(-this.width/2,-this._radius/2),this.lineTo(0,-this._radius),this.lineTo(this.width/2,-this._radius/2),this.endFill()}},{key:"redraw",value:function(e,t,n){this.clear(),this.generatePath(e,t,n)}},{key:"radius",get:function(){return this._radius}},{key:"width",get:function(){return this._radius*Math.sqrt(3)}},{key:"pos",set:function(e){var t=e.x,n=e.y;this.moveTo(t,n)}}]),n}(ne.Graphics),tn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i,a,s,o){var r;return Object($.a)(this,n),(r=t.call(this,"",new ne.TextStyle(Object(O.a)({fontSize:i,fill:"#ffffff",fontFamily:"Arcadepix",align:"left",fontWeight:"bold",stroke:"black",strokeThickness:2},o)))).anchor.set(a,s),r.text=e,r}return Object(ee.a)(n,[{key:"left",get:function(){return this.x}},{key:"right",get:function(){return this.x+this.width}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}]),n}(ne.Text),nn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(){var e;return Object($.a)(this,n),(e=t.call(this))._anchorX=0,e._anchorY=0,e}return Object(ee.a)(n,[{key:"anchorX",get:function(){return this._anchorX},set:function(e){this._anchorX=e,this.pivot.x=e*this.width/this.scale.x}},{key:"anchorY",get:function(){return this._anchorY},set:function(e){this._anchorY=e,this.pivot.y=e*this.height/this.scale.y}}]),n}(ne.Container);!function(e){e.STARBASE="starbase",e.SPACESHIP="spaceship",e.USER="user",e.TEAM="team"}($t||($t={}));var an,sn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e){var i;Object($.a)(this,n),(i=t.call(this))._preIcon=void 0,i._text=void 0,i._icon=void 0;var a=ne.Texture.from(i.getTexture(e.preIcon));a.baseTexture.mipmap=ne.MIPMAP_MODES.POW2,i._preIcon=new ne.Sprite(a),i._preIcon.anchor.set(0,.5),i._preIcon.width=8,i._preIcon.height=8,i.addChild(i._preIcon),i._text=new tn(e.text,8,0,.5),i._text.x=12,i.addChild(i._text);var s=ne.Texture.from(i.getTexture(e.icon));return s.baseTexture.mipmap=ne.MIPMAP_MODES.POW2,i._icon=new ne.Sprite(s),i._icon.anchor.set(0,.5),i._icon.angle=-90,i._icon.x=i._text.x+i._text.width+10,i._icon.y=12,i._icon.width=24,i._icon.height=24,i.addChild(i._icon),i}return Object(ee.a)(n,[{key:"getTexture",value:function(e){switch(e){case $t.SPACESHIP:return Et;case $t.USER:return"data:image/png;base64,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";case $t.TEAM:return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAAG0OVFdAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAgKADAAQAAAABAAAAgAAAAABrRiZNAAAS3ElEQVR4Ae2dC/AVVR3H+f/5A39A3vJGRzAxTBtUsiwKk2ksxVJRSR00s7R0TGtMqYRGsEnHMcUmH0w+UIx8pzZm2fgonNFGVHxQKqk8VN6vvyD8gT99frd77px77p7dc+7u3nvFszN3zuv3/J7fnj179uzeTp32vGPlypW75Rfl2apVq24225t1Qp0R4jl6m+R37959nllXJkBvHDx48Ll62ZZvsjVIvW7RkCFDImnLKnUGLGjGjQ6loKmpaQcudFFlJbDkgs4sRDCUAdmtW7fBillSRV8SoDdKHu3zOnfuPKlY/1qfPn02mjRSLnPBJEDLu6oOYUcOHDjwA1VWaaQAZZ4i0lPlu6qzuqAIzHT16tU/0+sqBOhI64QqT/tZKh/SPBCQ/i/+To+Sr9r1topuLDberRNJntAuRaEeaDYBJn8nzs6hFZVURIayEBJxszo6Oi5XTGYIq/oWldHNEmKd2UYj9QUX8O9+RSQp2k/Vy1F5pbAggPierBOh/R7dZMkrBp1O8lYMYLiV9okFoqamxYB4rOTNI1KAVVtT02QEPagLqRBgY1ZMumtS5xwHSkBIAwIVCFSEoaKwhaMZhoreTF35vcOYceMmU5lZhmaFWWcrWxEQBtMLpgdHMT14RtpQMpgxaKXk5WAycxNn+fn/LxUGtGmMSb9WZUmj0Is1QGfW86ZhehtGdMOYdr0uLl8azxVRnHDxAK9b8F6RV6QM5R9R2TlJjmIsi4E4JmGQdrzbSfYxJcBMQUCUv2vW6+UkPTpt7nmvGPCxvLm5+cuDBg1akOSBkwE+ik2FUZGv05TFgN6g8mvWrDlM5atJ0xhfjb7AExAICAQEvBGwDsVccu83b3qShlVduzkCcm24iGvDDTqN5K0GmAIUo4sRPryR1wK836UUZpli2J9NeZEGQFRa6TIZ0pSLk5kyEZEGMKspLa2VUacsIPcEU0SkAUKEtb8xifX+p5t2SF+rn06r06l65J2o8npqDUKdyMz7BJnJa5atCJiEqozn61XeTG2GmXR6uWJazrT6ZG4o7tOJVF6gZWzop8q2FCNvgS5q4Xg9MgbofGUIoPxsm3KdKSlPf6+10PQ3USozAOW3WRhL1VGnUqmxmEHOz806W7nMABuRqgfWHnGnqNyUKNq4lC76m2r3MgDGLcIYdZpJHUeHCbFSZKQFOUZdfYre44AEKl1xEb++hsm7ueLN44o33aiPLTobALRySzwoVprWGNVNWnMp62QAfd+Bx060JclkXIxIDEIUt1ajXAzB8OW6QVH5RAMQIgsOVR0YPiKJMdGAJAFp2+tuQFoHAn9AICAQEAgIBAQCAmkQ8J7iKWVMkkaRf4sJjzmdWMO9yQhuD5wfGSmZrimL90O58VqG7rLbWnRuZkI+jNT5lsMbABy/BsWXuBjLHcKhGPSyC60LDTcFP4auYskkirelpWXi3nvv/WRUm17nBYCP80oJIBwACEtUudrUx3mlA90T0P0PVY5KzfCNoinVufZ8iYEMPHfq5RR5p57X5XOazNXLUXkvADi3rogSElfHc+5T4tpd29D9A1daReei2+sUEMGE4sUk1yklcSm7EPfr16/fUhsNg9kEemkcUfI+4foU4VraBBDFA/23d+3aNT+qzawDsLEMxovMerPsDYASsH79+j47duxYivF9VJ2kKF6E4rF6ncqzpHIdDguAiQcyWpAVuVSPzu6MRwLsQF0Q9G8B4qdJnVfYqwZAV5yUx+BWDK5mbWE5Kyv7JslP0+4FAE7MwJkrkhTSA1fTg9MUHadN2QZdVe+SIusWZBXOf/R/Fv1/gm9kHC88L3H+H89l8L04OmlLBADj74EucVehqUitiXGqHNze3v6q2e5TVrJ8xh9dPgB2tp0WsVeBYs95O68r79+//2t62TeP4Q9oPGdoeecskbMLX/4YxWCNgKLzUTyuddvoue5CLFNXRu/3XRk1ui3I2EvKDKB7MYC2aW3eWU6Lb7L17FGdMTYCdMIq8q2AuE34ZDu8hDHHc65yuCwOVc7Tg/undV70ImOuqd8aAW1tbQO3bt06l0Gnh8nkW8aZq7g8Pa7zFS+jFyN/HMC8z+9JaGS8KTsA8emyiioL2PAs8n9RJfuey2aNgLQuc85+it59k19WOu7llJiS1i6TPyvjSnIzGDxLsmwZwnk24ew0o7TJUPWZAcBA9Qq9fYgSXIs07vruqj8TAHD+DZwf7ao0Szq5uqSRl/oyiOPN9XJeHAf8HXUFgMHu9DQGpOUF/LJ1QV95qSOA83Ae9/0jUbzUV3laeuYO89OeAmltCPwBgYBAQCAgEBAICAQEAgIBgYBAQCAgEBAICHz8EKh6PY2lqD+wGnNahMsXs0gxO6I+syp034zu80yBLJDMYIFmllkfV/YGAMU9MeDDOKG0bQOEwnPBBDqvZnR3QXfs9jtA2AUIzstk3gB4rPuXHmx6eRlD7KobEHYCgtNrkF5rgqD/TIx9ZlNPDM5swRRZTnuDxAgiRT694bSX0SsCXHtARyKrRcu8dDtHAKg6vZqnO/9xyDsDsGHDhjH1cmjz5s1lr51maYczAOz3W5ylYh9ZvXv3XudD70PrDAAjq/PeO2UAPFXvDlMy8k6dARBDcEi2qDkf0B/nTJxAiKybEkjKmnmEfk5ZhaXgdRUQGR6j8RquANb3XXmmOIQ9O1/FsWEY+4L6bpbFzkK1h27nOYg3AHI14BorX5iKO9bifNk2VkUM743I+KEq6ylgiNwRTGJW6fV6Hv5d8FsjFxkfwt9L54nLWwXZmFCwq3htL/t6mUZ/QpTzApz0oM154aethd9KosO6GRvnOhMxZZ8/Vbqx7Uwf54XPOwKUMt/UI3wLonFmFs7M8NXjS18TAHB+GYbt42scAHQHiMJeQ19eV3rvU8BVsKIjpLuS93Ze+DkVqtldqlQ7pc63jWvXrh3OdtdHcejQOMn02NvQyDhQ2CCNE7+No49rQ04/vZ0B8CrqLtProvLY8EuiZ2ZUm1nndAoQwjIT628y28oYMAcDCgsWGN2O0U63plHykNOMvMKEynccYbA8he10Zd/TNXXEngIY3lxU6uy8KICvNG1O47zI4h7kM5JWczDPuA/774njjQVArrlxzLY2kC9NgOg97ym0Lpd7kP/o5Sryp3Ianm3jswIAcpH7622C9Hp6/Rit/JCW984CYNKkK1EmkXCbjcgKAAxV78sFgMOVQnaQfV/lfVPdeXox1et3RHPkWBAJAC84HO9rrEmPwYUXHfr27buBti1mu0uZU2lfRRe111+1uaR0yuQoukgAUHZhFLFPHTJeV/SM5L1V3iN9TF60EHqM704iv8yPSADQMi4DTfsSBQeIHBkI6c3Ir89H6YH+OeYRpVtpwleiKJfDBsDTWWgjCkrvC3A9Xlm8iYp9iYr3eiYRMUcq/Th/F/luqpx1ap0I0XtX4sD4LBTi+FGmHORPIbSP5ifv+7/QpUuX63nDbJNOB83XsWGaXldNHvlbe/TocVavXr3WVMMfePZkBKynQFZOyzuDhPn5/A7nNwa5iToJ2Y3QLmTgXMDYcXtWtkTJSTQmismlrjgHP9WFNokGQORD76MBY0kSrW975gAwcI1n4PqnryGO9KsZUAc70jqR2S6DTswmEc5fn6Pzom5Q8e7UVF11ObMI4Hp9EuftA1Vb4sEop4SsE3iwWEkzEYLj8uJUTZwXT9DVBOCvWL3yaMgEAEJ/qYfOTEgB4RB+rWmFZQIAhoxIa0g1/AC/qBo+nSc1ABgR+ZBCV5JXHuBTv6yZGgCMmJmXgy5y0Z/Kh1TMYiAGOC+tuzjkS8Ny/VhfHp0+NQC6sHrkmXcclEZvagC4Jr+ZxoC0vEyPY5e9k+SnBoAJyYGAMD9JUQ7tS+WVXXSnenk6B7uCyIBAQCAgEBAICAQEAgIBgYBAQCAgEBAICAQEAgIBgYBAQCAgEBAICAQEAgIBgYBAQCAgEBBoEAQy2x3o6w+b2wazp+R4HmrL6xCjyA8j7cVvFXXynuhCfg/z1P/pPenB96ZNm/pv27bt2KLvsrNJdlD3w8fVpB+wK3oR+Uf4Y6AnSHN9WRjdydu1hSiLA+ea2EZ2ObKmk/d+fRQw3gacKbw89EIW9tRSBsEuW+SvQaf3n7Tg90r4prL75O952Jz7CIDjzQDwCMaXXnxK4wiAyLvDJwPIg2nk1IKXzdy3oue7WenC9wvw+8as5ImcXAOAbXtH7Ny58/ksDVayAONFLg/yt0QN93UeAl4uaf/G1q7K3gzTZQTBaPzenoXM3AIAEL4ICM9mYWSMjNd4Z+SQmPaaN23cuHHk9u3b/4vvuWGLU/JnxkMJgqre59dBSb0zUhdm5K3vqBt0aYoHE2g/SSMga14meLfl3Pli8kDmU1dlYXsuAcC7gcMA4cAsDEySgZ6jk2hq1Y4t8k+WX6mRvolZ6MklANixnnpocnUui2HQVZcDncxHOhzoUpMQbDtTC0FALgHA9Unu5VO/vuTo4OOOdLmT4bN0/hO5K0IBt8R/zUJPbhMVrs3yj8i5BgGAP0ewlT4tkQUgaWXIq/GMgMvwPc8Xp5Yy+d0vra3Cn8sIIILpmFdaWlrG0EmZDFUi0ziebLTOF/uKX7kZgd9J31o33HEuvo7f+ztTJxDmNgLoelkQ+T3lc/S6FPl2hr+JrAEs8JFRvDc/DZ5v0TnjOEMjfaeNpt2y2vgw+fmA/baPHp0WnTORNV2vqzYvdsE7GXtSfYXM1B8JgkmUVRlApgLIdcgb4CsTABZ07dp1Kt+Re9eVl1ulsxmO5dONPV15LHRbCLoLCbrbLe2x1VwWJmGH/P3D8FjCiEb8XgTfVIb8VyOaU1fVNAB0a3GqCx00AQePI194GES+8DCIsvzp+EJ+8jDoLZ0vKQ+vPHO4l/TkJNpq2rHpPmyaQlrVCiR2NRMQXyKdhP7RpPLFqL7kV/P7gLLMmx7Jq8ORXXbULQDKrMiowAhTy++VyHDc8M8jkqDNbRKYpDjrdjr/Us6eB7KWa5MnukSnrf3jUp/7CLBu3bp9+Ozy1wBsH0CRFcKhpNbvSDIcfgTNe6QrSFfwFcEXmVm/GAcoQ/43uMY+FkeTVxtzg2O5JPwlTj5D/jjsOwya4fg0HN8ktX0HUy4tbdDINzPlUrgcDJ4YMGDA8jgd1bZlGgB86bgvD0Iuw5iL+NkcrNbWwt9YMOyeaArgLkNm6iPN+hqV3+F6PcrUxejwEJ18glmfQfkjZMzmCxFXMyHemFZe6ksATsqnq67g10HnywdO5TOXmXe+OMrZUPHN0ba2tkE01avzxayRRRskXzqibC01pssIttMEa8FcsJc+qFZkqgBA+bViBAbMSGOEh/EViyvt7e15PHP3MKlTJ4sNFbZ6CXUgFswF+2IgXOvAUkFSVQCgcBTD7naU1/RRLPoqPovEtXEFZ9uqCs9qVCG6xQZTXZStJk2WZekL6RPpGx+53gHALp/PoWAJv5qfeTh5Cr+ofXU/9XE6Y9pLTHlio9hq1tegLH2ypNhHTuq8AgCnWtni9RRp1dccJ6vsRN2Z8d9lNjMxvIszcY5Zn3dZdKJ7nqkHG++kLpd5kKnLLEvfFPvI6WuaXgGAY9ejMO2yqmmzVxkHT8KOs0wmOuI8OmSGWZ9XWXSJTlM+Q/CZ2Bj5Xw0mbY7lnsW+SlThFQA4Nj5RYg0IuKe+Awd/ZaqiQ2bxEf4+1C822zIsLxYdosuUiU2zwGiuWV+PsmtfeQ3lTDLW4Uz/ejhk0SmPhI/hbKx45AwA3eiQOaRnWni9qtFxJws+55JuNxnR0YKux0knmm11LK9nfSLxoZtXALDQsx/3n8/jlNx7N9JxA87K4lPkQcc000Fn0CjBMIFy7IspdPIO6J7hJ51+N+UO8pEHJ8VsGn4U2Vi/yjWtra2f5++L3qmfCUFzQCAgEBAICDQ4Al5zgEbyhSdsB3ItP4k7AtnidQT5uviCblTv/hdPBWUL2YM8uXyjkXBKsqUuoCUZFdUuD1y2bt0q9/nnAnjsJC6Kv5Z1BIJMIufwv20z+d822enTsEfDBwCz7O+B3u/41XzpOaNea0fOBdylyMbYhjsaNgDo+MtBq2KxpeEQ9DNoOoFwpR9LvtQNFwDcr4/lur4At+u65Jwj7LLDeDzrCy/nqMNZtNdSsLPUKgnp/O/Q+S/Bvqd2viDTU3wUX6VQ76NhAoCHKJcCzO31BqRW+sVX8blW+mx6GuISwPPrMTzCzPMBjs3/utfz+txBfBBKviZSl6MhRgA6/466eN8ASuvte91HAK6FQxgOZQv0J/ZgUjiUSaF8DazmR91HABZNxtXc6wZTWE8M6h4A9MUn+uwvxmLdMKh7ALB2vpCJ0Bc4C3LfRt1gJ7685/Ch+C4YNJptwZ6AQEAgIBAQCAgEBAICAYGAQEAgIBAQCAgEBAICAYGAQEAgIBAQ2GMQ+B9hGGygbhzTMgAAAABJRU5ErkJggg==";case $t.STARBASE:return Pt}}}]),n}(nn),on=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e){var i;return Object($.a)(this,n),(i=t.call(this))._stats=void 0,i._stats=e.map((function(e,t){var n=new sn(e);return n.y=n.height/2+t*n.height*.7,i.addChild(n),n})),i.anchorX=.5,i.anchorY=0,i}return Object(ee.a)(n)}(nn),rn=Object(ee.a)((function e(){var t=this;Object($.a)(this,e),this.entities=void 0,this.add=function(e,n){t.entities[e]=n},this.get=function(e){return t.entities[e]},this.getAll=function(){return Object.values(t.entities)},this.length=function(){return Object.keys(t.entities).length},this.remove=function(e){delete t.entities[e]},this.entities={}})),cn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i,a){var s;return Object($.a)(this,n),(s=t.call(this))._planet=void 0,s._scale=void 0,s._size=void 0,s._sprite=void 0,s._planet=e,s._scale=i,s._size=a,s._scale==an.LARGE?s.createAnimatedPlanet():s.createSimplePlanet(),s}return Object(ee.a)(n,[{key:"createSimplePlanet",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(){var t,n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Tt(this.planetImageKey(this._planet.nonce)),(n=new ne.Sprite(t)).width=this._size,n.height=this._size,n.anchor.x=.5,n.anchor.y=.5,n.angle=180,this.addChild(n),this._sprite=n;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"planetImageKey",value:function(e){return"planet-medium-".concat(e)}},{key:"planetPixels",value:function(){return this._planet.size/10*256}},{key:"createAnimatedPlanet",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(){var t,n,i,a=this;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.planetPixels(),console.log("Loading planet ".concat(this._planet.nonce," size: ").concat(t)),e.next=4,ne.Texture.fromURL("/planets/large/".concat(this._planet.nonce,".png"));case 4:n=e.sent,(i=new ne.Spritesheet(n,this.generateSpritesheetData(1250,t))).parse((function(){var e=new ne.AnimatedSprite(i.animations.planet);e.animationSpeed=.5,e.width=a._size,e.height=a._size,e.anchor.x=.5,e.anchor.y=.5,e.angle=-90,a.addChild(e),e.play(),a._sprite=e,console.log("Animated planet created ".concat(a._planet.nonce))}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateSpritesheetData",value:function(e,t){for(var n={},i=[],a=0;a<e;a++){var s="planet-".concat(this._planet.nonce,"-frame-").concat(a);n[s]={frame:{x:a%50*t,y:Math.floor(a/50)*t,w:t,h:t}},i.push(s)}return console.log(n),{frames:n,animations:{planet:i},meta:{scale:"1"}}}}]),n}(ne.Container);!function(e){e[e.SMALL=0]="SMALL",e[e.MEDIUM=1]="MEDIUM",e[e.LARGE=2]="LARGE"}(an||(an={}));var hn,ln=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:an.SMALL;return Object($.a)(this,n),(i=t.call(this)).planets=[],i._planets=new rn,i._sun=void 0,i._timer=void 0,i._scale=void 0,i._radius=void 0,console.log("Creating solar system with radius ".concat(e)),i._scale=a,i._radius=.8*e,a!=an.LARGE&&(i._timer=setInterval((function(){return i.updatePlanets()}),1e3/s.GAME_SPEED)),i}return Object(ee.a)(n,[{key:"addPlanets",value:function(e){0!=e.length&&(this.planets=e.toArray(),this.createPlanets(e.toArray()),this.createSunIfNeeded())}},{key:"createSunIfNeeded",value:function(){this._planets.length()>0&&!this._sun&&(this._sun=new ne.Sprite(Tt(this.sunImageKey())),this._sun.anchor.x=.5,this._sun.anchor.y=.5,this._sun.width=this.getPartialSize(20),this._sun.height=this.getPartialSize(20),this._sun.zIndex=0,this.addChild(this._sun),console.log("Adding sun with size ".concat(this.getPartialSize(20))))}},{key:"getPartialSize",value:function(e){return Math.floor(e/100*this._radius)}},{key:"sunImageKey",value:function(){return"sun-medium-1"}},{key:"destroy",value:function(){clearInterval(this._timer),Object(Nt.a)(Object(Ht.a)(n.prototype),"destroy",this).call(this)}},{key:"updatePlanet",value:function(e){var t=this._planets.get(e.nonce.toString());t&&(t.position.x=e.position.x,t.position.y=e.position.y,t.angle=e.position.angle)}},{key:"updatePlanets",value:function(){for(var e=0;e<this.planets.length;e++){var t=this.planets[e],n=this._planets.get(t.nonce.toString());if(!n)return;n.angle=this.planetAngle(t)}}},{key:"createPlanets",value:function(e){var t=this,n=.75*this._radius;e.forEach((function(e){n-=t.getPartialSize(e.size)}));var i=n/(e.length-1);console.log("Space between planets: ".concat(i));var a=this.getPartialSize(25);e.forEach((function(e,n){var s=t.getPartialSize(e.size),o=new cn(e,t._scale,s);t._scale!=an.LARGE?(o.pivot.y=a,o.angle=t.planetAngle(e)):(o.position.x=e.position.x,o.position.y=e.position.y,o.angle=e.position.angle,e.onChange=function(){t.updatePlanet(e)}),o.zIndex=n,t.addChild(o),t._planets.add(e.nonce.toString(),o),a+=s+i,console.log("Adding planet ".concat(n," with size ").concat(s," with distance ").concat(o.pivot.y))}))}},{key:"planetAngle",value:function(e){var t=Date.now()/1e3-e.born;return 360*i.decimals(t/3600*e.speed*s.GAME_SPEED)}}]),n}(ne.Container),un=n(395),dn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i){var a;Object($.a)(this,n),(a=t.call(this,"MAP")).map=void 0,a.eventHandler=void 0,a.tempPath=void 0,a.paths=[],a.selectedSpaceship=void 0,a.eventHandler=i,a.sortableChildren=!0;var o=s.HEX_RADIUS*Math.sqrt(3),r=2*s.HEX_RADIUS;a.map=e;var c=50+s.HEX_RADIUS,h=50+s.HEX_RADIUS;return a.map.coordinateList.forEach((function(e){var t=e.toTile(),n=t.y*(3*r/4)+h,i=t.x*o+c;t.y%2==0&&(i+=o/2);var l=new vn(i,n,s.HEX_RADIUS,e,a.onTileHover.bind(Object(oe.a)(a)),a.onTileClick.bind(Object(oe.a)(a)));a.add(e.toString(),l),e.noGo&&l.toggleNoGoZone()})),a}return Object(ee.a)(n,[{key:"onTileHover",value:function(e){if(this.tempPath&&this.tempPath.destroy(),this.selectedSpaceship&&!e.noGoZone){var t=this.map.getCoordinate(this.selectedSpaceship.coordinate.x,this.selectedSpaceship.coordinate.y,this.selectedSpaceship.coordinate.z),n=this.map.pathFinding(t,e.coordinate),i=this.createPath(n.path,n.references);this.tempPath=i}}},{key:"onTileClick",value:function(e){if(this.selectedSpaceship)return this.eventHandler.send("warpSpaceship",{nonce:this.selectedSpaceship.nonce,coordinate:this.selectedSpaceship.coordinate.toJSON(),destination:e.coordinate.toJSON()}),this.selectedSpaceship=void 0,void(this.tempPath&&(this.removeChild(this.tempPath),this.tempPath=void 0));this.eventHandler.send("hexClick",e)}},{key:"setSelectedSpaceship",value:function(e){this.selectedSpaceship=e}},{key:"getBaseFor",value:function(e){var t=s.TEAMS.findIndex((function(t){return t.id==e}));return this.getAll().filter((function(e){return e.coordinate.base==t})).first()}},{key:"setHexagonBinding",value:function(e,t){var n=this.get(e);n&&(n.hexagon=t)}},{key:"createPath",value:function(e,t,n){var i=this,a=e.map((function(e){return i.get(e.toString())})),s=new Wt(a,n);return this.addChild(s),t.forEach((function(e){return e.reset()})),s}},{key:"resetPaths",value:function(){var e=this;this.paths.forEach((function(t){e.removeChild(t),t.destroy()})),this.paths=[]}},{key:"createSpaceshipWarp",value:function(e){var t=this;console.log("Create path: ".concat(JSON.stringify(e.coordinate.toJSON())));var n=e.travel.path.map((function(e){return t.map.getCoordinate(e.x,e.y,e.z)})),i=this.createPath(n,[],e.travel);this.paths.push(i)}}]),n}(se),pn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e){var i;return Object($.a)(this,n),(i=t.call(this))._tileContainer=void 0,i._hexContainer=void 0,i.eventHandler=void 0,i.zoom=1,i.eventHandler=e,i}return Object(ee.a)(n,[{key:"update",value:function(){if(console.log("Render the Big Hex View"),this._hexContainer&&(this.removeChild(this._hexContainer),this._hexContainer=void 0),this._tileContainer){var e=window.innerWidth,t=window.innerHeight,n=Math.min(e,t)/2-50,i=new jn(n,this._tileContainer,this.eventHandler);i.x=e/2,i.y=t/2,this.addChild(i),this._hexContainer=i}}},{key:"zoomLevelUpdate",value:function(e){var t,n=Math.round(100*e)/100;Math.abs(this.zoom-n)>.2&&(this.zoom=n,null===(t=this._hexContainer)||void 0===t||t.updateItemsScale(n),console.log("Hex new zoom: ".concat(this.zoom)))}},{key:"tileContainer",get:function(){return this._tileContainer},set:function(e){this._tileContainer&&this._tileContainer.setupListeners(),this._tileContainer=e,this.update()}}]),n}(ne.Container),fn=new(function(){function e(){var t=this;Object($.a)(this,e),this._playerId="",this._me=void 0,this.subscribers=[],this.isPlayerIdMe=function(e){return t._playerId===e},this.username=function(){return t._me?t._me.username:""},this.address=function(){return t._me?t._me.address:""}}return Object(ee.a)(e,[{key:"playerId",get:function(){return this._playerId},set:function(e){this._playerId=e,this.subscribers.forEach((function(e){return e()}))}},{key:"me",set:function(e){this._me=e,this.subscribers.forEach((function(e){return e()}))}},{key:"onUpdate",value:function(e){this.subscribers.push(e)}}]),e}());!function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.MAP=1]="MAP",e[e.HEX=2]="HEX",e[e.HEX_HOVER=3]="HEX_HOVER",e[e.SINGLE_HEX=4]="SINGLE_HEX",e[e.GAME=5]="GAME"}(hn||(hn={}));var gn=function(){function e(t,n,i){var a=this;Object($.a)(this,e),this.app=void 0,this.mapView=void 0,this.hexView=void 0,this.hexController=void 0,this.mapController=void 0,this.roomName=void 0,this.state=void 0,this.playersMap=new rn,this.eventHandler=void 0,this.map=void 0,this.app=t,this.map=n,this.eventHandler=i,this.mapView=new un.a({screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:s.MAP_SIZE,worldHeight:s.MAP_SIZE,interaction:this.app.renderer.plugins.interaction}),this.app.stage.addChild(this.mapView),this.mapView.zIndex=hn.MAP,this.mapView.drag({clampWheel:!0}).clamp({direction:"all",underflow:"center"}).pinch().wheel({smooth:3}).clampZoom({minScale:1,maxScale:1.5}),this.mapView.zoomPercent(ne.utils.isMobile.any?.25:1),this.mapView.sortableChildren=!0,this.hexView=new un.a({screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:window.innerWidth,worldHeight:window.innerHeight,interaction:this.app.renderer.plugins.interaction}),this.app.stage.addChild(this.hexView),this.hexView.zIndex=hn.SINGLE_HEX,this.hexView.sortableChildren=!0,this.hexView.visible=!1,this.hexView.drag({clampWheel:!0}).clamp({direction:"all",underflow:"center"}).pinch().wheel({smooth:3}).clampZoom({minScale:1,maxScale:4}),this.hexView.on("wheel",(function(){var e;null===(e=a.hexController)||void 0===e||e.zoomLevelUpdate(a.hexView.scaled)})),console.log("Map initialized \ud83e\udd29")}return Object(ee.a)(e,[{key:"start",value:function(){this.hexController=new pn(this.eventHandler),this.hexView.addChild(this.hexController),this.mapController=new dn(this.map,this.eventHandler),this.mapView.addChild(this.mapController),console.log("Map initialized \ud83e\udd29")}},{key:"hideAll",value:function(){this.mapView.visible=!1,this.hexView.visible=!1}},{key:"show",value:function(e){e==hn.HEX?this.hexView.visible=!0:this.mapView.visible=!0}},{key:"exploreTile",value:function(e){this.mapView.visible=!1,this.hexView.visible=!0,this.hexController&&(this.hexController.tileContainer=e)}},{key:"returnToMap",value:function(){this.mapView.visible=!0,this.hexView.visible=!1,this.hexController&&(this.hexController.tileContainer=void 0)}},{key:"setScreenSize",value:function(e,t){this.mapView.resize(e,t,this.map.width,this.map.height)}},{key:"setSelectedSpaceship",value:function(e){var t;null===(t=this.mapController)||void 0===t||t.setSelectedSpaceship(e)}},{key:"setViewPortPosition",value:function(e){var t,n=null===(t=this.mapController)||void 0===t?void 0:t.getBaseFor(e);n&&this.mapView.animate({position:new ne.Point(n.x,n.y),time:0})}},{key:"getStats",value:function(){var e=this.playersMap.getAll().map((function(e){return{playerId:e.playerId,username:e.username}}));return{roomName:this.roomName||"",playerName:fn.username(),players:e,playersCount:Object.keys(this.playersMap).length}}},{key:"setState",value:function(e){this.state||(this.state=e,this.state.map.onChange=this.handleGameChange.bind(this),this.state.players.onAdd=this.handlePlayerAdd.bind(this),this.state.players.onRemove=this.handlePlayerRemove.bind(this),this.state.hexagons.onAdd=this.hexagonAdd.bind(this),this.state.inTransit.onAdd=this.warpAdd.bind(this))}},{key:"handleGameChange",value:function(e){console.log(e);var t,n=Object(te.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.gameUpdate(i.field,i.value)}}catch(a){n.e(a)}finally{n.f()}}},{key:"gameUpdate",value:function(e,t){if("roomName"===e)this.roomName=t}},{key:"handlePlayerAdd",value:function(e,t){var n=this;console.log("[Player][Add] ".concat(t));var i=fn.isPlayerIdMe(t);e.onChange=function(){console.log("[Player][Update]"),console.log(n.state)},this.playersMap.add(e.address,e),i&&(fn.me=e,this.setViewPortPosition(e.team))}},{key:"handlePlayerRemove",value:function(e,t){var n=fn.isPlayerIdMe(t);this.playersMap.remove(e.address),n&&(fn.me=void 0)}},{key:"hexagonAdd",value:function(e,t){var n;null===(n=this.mapController)||void 0===n||n.setHexagonBinding(t,e)}},{key:"warpAdd",value:function(e,t){var n;null===(n=this.mapController)||void 0===n||n.createSpaceshipWarp(e)}}]),e}(),vn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,a,o,r,c,h){var l;if(Object($.a)(this,n),(l=t.call(this))._hex=void 0,l._noGoZone=void 0,l._hidden=void 0,l._statsStack=void 0,l._solarSystem=void 0,l._hexagon=void 0,l._coordinate=void 0,l._touchPoint=new ne.Point,l._drag=!1,l.onSpaceshipAdd=void 0,l.onSpaceshipRemove=void 0,l.x=e,l.y=a,void 0!=r.base?l._hex=new en(0,0,o,s.TileColor.DEFAULT,s.TEAMS[r.base].color,.2):l._hex=new en(0,0,o,s.TileColor.DEFAULT,0,.2),l._coordinate=r,l.addChild(l._hex),l.zIndex=hn.HEX,l._hex.interactive=!0,l._hex.cursor="pointer",l._hex.hitArea=new ne.Circle(0,0,o),l._hex.on("pointerover",(function(){l.zIndex=hn.HEX_HOVER,l.setHover(!0),c(Object(oe.a)(l))})),l._hex.on("pointerout",(function(){l.zIndex=hn.HEX,l.setHover(!1)})),l._hex.on("pointerdown",(function(e){l._touchPoint=e.data.getLocalPosition(l.parent),l._drag=!1})),l._hex.on("pointermove",(function(e){var t=e.data.getLocalPosition(l.parent);i.getDistance(l._touchPoint.x,l._touchPoint.y,t.x,t.y)>5&&(l._drag=!0)})),l._hex.on("pointerup",(function(){l._drag||h(Object(oe.a)(l))})),s.DEBUG){var u=new tn(l.coordinate.toString(),6,.5,.5);u.y=80,u.zIndex=3,l.addChild(u)}return fn.onUpdate((function(){l.hexagonWasUpdated()})),l}return Object(ee.a)(n,[{key:"toggleNoGoZone",value:function(){if(this._noGoZone)this.removeChild(this._noGoZone),this._noGoZone.destroy(),this._noGoZone=void 0;else{var e=new ne.Sprite(Tt(Ot.NoGoZone));e.angle=30,e.anchor.x=.5,e.anchor.y=.5,e.zIndex=1,this._noGoZone=e,this._hex.addChild(this._noGoZone)}}},{key:"updatePlanets",value:function(){this.hexagon&&(this._solarSystem&&(this.removeChild(this._solarSystem),this._solarSystem=void 0),this._solarSystem=new ln(this._hex.radius),this._solarSystem.addPlanets(this.hexagon.planets),this._solarSystem.zIndex=0,this.addChild(this._solarSystem))}},{key:"hexagonWasUpdated",value:function(){if(this._hexagon){this.updatePlanets();var e=0,t=0,n=[];this._hexagon.spaceships.forEach((function(n){n.address==fn.address()?e++:t++})),e>0&&n.push({preIcon:$t.USER,text:"".concat(e,"x"),icon:$t.SPACESHIP}),t>0&&n.push({preIcon:$t.TEAM,text:"".concat(t,"x"),icon:$t.SPACESHIP}),this._hexagon.starbases.length>0&&n.push({preIcon:$t.TEAM,text:"".concat(this._hexagon.starbases.length,"x"),icon:$t.STARBASE}),this.stats=n}}},{key:"setupListeners",value:function(){var e=this;this._hexagon&&(this._hexagon.spaceships.onAdd=function(t,n){var i;console.log("Spaceship added"),e.hexagonWasUpdated(),null===(i=e.onSpaceshipAdd)||void 0===i||i.call(e,t,n)},this._hexagon.spaceships.onRemove=function(t,n){var i;console.log("Spaceship removed"),e.hexagonWasUpdated(),null===(i=e.onSpaceshipRemove)||void 0===i||i.call(e,t,n)},this.hexagonWasUpdated())}},{key:"hexagon",get:function(){return this._hexagon},set:function(e){this._hexagon=e,this.setupListeners()}},{key:"stats",set:function(e){this._statsStack&&(this.removeChild(this._statsStack),this._statsStack=void 0),e.length>0&&(this._statsStack=new on(e),this._statsStack.y=-90,this.addChild(this._statsStack))}},{key:"toggleHidden",value:function(){if(this._hidden)this._hex.redraw(s.TileColor.DEFAULT),this.removeChild(this._hidden),this._hidden.destroy(),this._hidden=void 0;else{this._hex.redraw(s.TileColor.DEFAULT,s.TileColor.HIDDEN,.75);var e=ne.Texture.from("data:image/png;base64,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");e.baseTexture.mipmap=ne.MIPMAP_MODES.POW2;var t=new ne.Sprite(e);t.anchor.x=.5,t.anchor.y=.5,t.width=24,t.height=24,t.zIndex=1,this._hidden=t,this._hex.addChild(this._hidden)}}},{key:"setHover",value:function(e){var t=e?s.TileColor.HIGHLIGHT:s.TileColor.DEFAULT;this._hidden&&this._hex.redraw(t,s.TileColor.HIDDEN,.75),void 0!=this._coordinate.base?this._hex.redraw(t,s.TEAMS[this._coordinate.base].color,.2):this._hex.redraw(t,0,.2)}},{key:"noGoZone",get:function(){return!!this._noGoZone}},{key:"coordinate",get:function(){return this._coordinate}},{key:"teamColor",value:function(e){switch(e){case"team_1":return s.TeamColor.RED;case"team_2":return s.TeamColor.BLUE;case"team_3":return s.TeamColor.GREEN}}}]),n}(ne.Container),mn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i){var a;return Object($.a)(this,n),(a=t.call(this))._text=void 0,a._background=void 0,a.padding=void 0,a.anchorX=0,a.anchorY=.5,a.padding=i,a.setText(e),a}return Object(ee.a)(n,[{key:"setText",value:function(e){this._text&&this.removeChild(this._text),this._background&&this.removeChild(this._background),this._text=new tn(e,6,0,0),this._text.x=this.padding,this._text.y=this.padding/2,this._background=new ne.Graphics,this._background.beginFill(16777215,1),this._background.drawRoundedRect(0,0,this._text.width+2*this.padding,this._text.height+this.padding,4),this._background.endFill(),this.addChild(this._background),this.addChild(this._text)}}]),n}(nn),bn=n(475),xn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i,a){var s;Object($.a)(this,n);var o=a?function(e){a(e)}:void 0;return(s=t.call(this,n.size/2,void 0,o))._starbase=void 0,s._sprite=void 0,s._hexWidth=void 0,s._starbase=i,s._hexWidth=e,s.zIndex=100,s.updatePosition(),s.createSprite(),i.onChange=function(){console.log("[MapStarbase][OnChange] nonce ".concat(i.nonce)),s.updatePosition()},s}return Object(ee.a)(n,[{key:"createSprite",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=ne.Texture.from(Pt),this._sprite=new ne.Sprite(t),this._sprite.anchor.x=.5,this._sprite.anchor.y=.5,this._sprite.angle=s.SPACESHIP_ROTATION,this.addChild(this._sprite);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updatePosition",value:function(){this.x=o.worldToHex(this.starbase.position.x)*(this._hexWidth/2),this.y=o.worldToHex(this.starbase.position.y)*(this._hexWidth/2),this.angle=this.starbase.position.angle}},{key:"alignOnPath",value:function(e){this.x=e.position.x,this.y=e.position.y,this.angle=e.angle}},{key:"starbase",get:function(){return this._starbase}}]),n}(wt);xn.size=64;var yn,jn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,i,a){var o;Object($.a)(this,n),(o=t.call(this))._hex=void 0,o._solarSystem=void 0,o._spaceships=void 0,o._starbases=void 0,o._tileContainer=void 0,o._hexagon=void 0,o._eventHandler=void 0,o._radius=void 0,o._coordinate=void 0,o._radius=e,o._hex=new en(0,0,e,s.TileColor.DEFAULT,0,.2),o._tileContainer=i,o._coordinate=i.coordinate,o._hexagon=i.hexagon,o._eventHandler=a,o._spaceships=new c.ObjectMap,o._starbases=new c.ObjectMap,o.addChild(o._hex),o._hex.interactive=!0,o._hex.cursor="pointer",o._hex.hitArea=new ne.Circle(0,0,e),o._hex.on("pointerdown",(function(t){var n=t.data.getLocalPosition(Object(oe.a)(o));a.send("largeHexClick",{x:n.x/e,y:n.y/e})}));var r=new tn(o.coordinate.toString(),14,.5,.5);return r.y=e+25,r.zIndex=3,o.addChild(r),o._tileContainer.onSpaceshipAdd=o.hexagonAddSpaceship.bind(Object(oe.a)(o)),o._tileContainer.onSpaceshipRemove=o.hexagonRemoveSpaceship.bind(Object(oe.a)(o)),o._hexagon?(console.log("Solar system with ".concat(o._hexagon.planets.length," planets")),o._solarSystem=new ln(e,an.MEDIUM),o._solarSystem.addPlanets(o._hexagon.planets),o.addChild(o._solarSystem),console.log("Solar system with ".concat(o._hexagon.spaceships.size," starbases")),o._hexagon.starbases.forEach((function(e){o.createStarbase(e)})),console.log("Solar system with ".concat(o._hexagon.spaceships.size," spaceships")),o._hexagon.spaceships.forEach((function(e){o.createSpaceship(e)})),o):Object(bn.a)(o)}return Object(ee.a)(n,[{key:"updateItemsScale",value:function(e){this._spaceships.forEach((function(t){t.scale.x=1/e,t.scale.y=1/e})),console.log(this._starbases.length()),this._starbases.forEach((function(t){t.scale.x=1/e,t.scale.y=1/e}))}},{key:"hexagonAddSpaceship",value:function(e){this.createSpaceship(e)}},{key:"hexagonRemoveSpaceship",value:function(e,t){var n=this._spaceships.get(t);n&&this.removeChild(n)}},{key:"hexagonUpdateSpaceship",value:function(e,t){var n=this._spaceships.get(t);n&&(n.position.x=e.position.x,n.position.y=e.position.y,n.angle=e.position.angle)}},{key:"createSpaceship",value:function(e){var t=this;console.log("[Explore][Add] Spaceship"),console.log(e);var n=new Jt(this._hex.width,e,(function(e){t._eventHandler.send("spaceshipClick",e)}));this.addChild(n),this._spaceships.add(e.nonce.toString(),n)}},{key:"createStarbase",value:function(e){console.log("[Explore][Add] Starbase");var t=new xn(this._hex.width,e,(function(e){}));this.addChild(t),this._starbases.add(e.nonce.toString(),t)}},{key:"hexagon",get:function(){return this._hexagon}},{key:"coordinate",get:function(){return this._coordinate}},{key:"sprite",get:function(){return this._hex}}]),n}(ne.Container),An=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e,a){var s;Object($.a)(this,n);var o="".concat(["asteroid-empty-1","asteroid-empty-2","asteroid-empty-3","asteroid-empty-4","asteroid-empty-5"][e.size],"-").concat(i.getRandomInt(1,2)),r=Tt(o);return(s=t.call(this,e.radius,void 0,(function(){a.send("asteroidClick",e)}))).sprite=void 0,s.position.set(e.position.x,e.position.y),s.sprite=new ne.Sprite(r),s.addChild(s.sprite),s.sprite.anchor.set(.5),s.width=2*e.radius,s.height=2*e.radius,s.angle=e.position.angle,s}return Object(ee.a)(n)}(wt),On=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e){var i;Object($.a)(this,n);var a=Rt("bullet-green");return(i=t.call(this,a.animations["Missile-B"])).width=5,i.height=76,i.angle=e.position.angle+90,i.position.set(e.position.x,e.position.y),i.animationSpeed=.3,i.updateAnchor=!0,i.loop=!1,i.play(),e.position.onChange=function(){console.log("[Bullet][Position][Update]"),i.position.set(e.position.x,e.position.y)},i}return Object(ee.a)(n)}(ne.AnimatedSprite);!function(e){e[e.SmallStar=1]="SmallStar",e[e.MediumStar=3]="MediumStar",e[e.LargeStar=5]="LargeStar",e[e.XLStar=17]="XLStar",e[e.DustCloud=50]="DustCloud"}(yn||(yn={}));var Sn,wn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e){var a;Object($.a)(this,n),(a=t.call(this)).position.set(e.x,e.y);var s=i.getRandomInt(60,100);return a.alpha=s/100,a.createRandomStar(),a}return Object(ee.a)(n,[{key:"createRandomStar",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(){var t,n,a,s,o,r,c,h,l,u,d,p;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=0;n<25;n++)t.push(yn.SmallStar);for(a=0;a<15;a++)t.push(yn.MediumStar);for(s=0;s<10;s++)t.push(yn.LargeStar);for(o=0;o<3;o++)t.push(yn.XLStar);if(t.push(yn.DustCloud),r=t[i.getRandomInt(0,t.length-1)],c="",r!=yn.DustCloud){e.next=16;break}return e.next=11,this.loadCloudTexture(i.getRandomInt(1,22));case 11:return h=e.sent,this.createSprite(h),e.abrupt("return");case 16:r==yn.XLStar?c="star_special":(l={1:3,3:6,5:12},u=i.getRandomInt(1,l[r]),c="star_".concat(r,"_").concat(u));case 17:d=Rt("stars"),p=d.textures[c],this.createSprite(p);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createSprite",value:function(e){var t=new ne.Sprite(e);t.anchor.x=.5,t.anchor.y=.5,this.addChild(t)}},{key:"loadCloudTexture",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.Texture.fromURL((i="/environment/clouds/bg_blue_".concat(t,".png"),kt()+"/sprites"+i));case 2:return(n=e.sent).baseTexture.mipmap=ne.MIPMAP_MODES.POW2,e.abrupt("return",n);case 5:case"end":return e.stop()}var i}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(ne.Container),Cn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(){var e;return Object($.a)(this,n),(e=t.call(this)).closeContainer=new se("close"),e.middleContainer=new se("middle"),e.farContainer=new se("far"),e.initialPosition=void 0,e.lastBounds=void 0,e.addChild(e.closeContainer),e.addChild(e.middleContainer),e.addChild(e.farContainer),e.initialPosition=new a.Vector2(0,0),e.lastBounds=new ne.Bounds,e}return Object(ee.a)(n,[{key:"initialStars",value:function(e){this.initialPosition=new a.Vector2(e.x,e.y),this.lastBounds=this.getCurrentBounds(this.initialPosition),this.createStars(this.amountOfStars(2),this.farContainer,this.lastBounds),this.createStars(this.amountOfStars(1),this.middleContainer,this.lastBounds),this.createStars(this.amountOfStars(0),this.closeContainer,this.lastBounds)}},{key:"createStars",value:function(e,t,n){console.log("[Parallax][Create] ".concat(e," stars"));for(var s=0;s<e;s++){var o=i.getRandomInt(n.minX,n.maxX),r=i.getRandomInt(n.minY,n.maxY);t.add("".concat(o,"-").concat(r),new wn(new a.Vector2(o,r)))}}},{key:"spaceshipMoved",value:function(e,t){this.middleContainer.position.x+=e.x/2,this.middleContainer.position.y+=e.y/2,this.farContainer.position.x+=e.x/4,this.farContainer.position.y+=e.y/4;var n=this.minScreenWidth(),i=this.minScreenHeight(),a=1*n/2,s=3*n/4,o=7*n/8;if(Math.abs(t.x-this.initialPosition.x)>=n/2){console.log("[Parallax] Horizontal movement"),this.clearOutsideBoundsStars(t);var r=this.getCurrentBounds(this.initialPosition);t.x>this.initialPosition.x?(r.minX=t.x+a-this.closeContainer.x,r.maxX=t.x+n-this.closeContainer.x):(r.minX=t.x-n-this.closeContainer.x,r.maxX=t.x-a-this.closeContainer.x),this.createStars(Math.round(this.amountOfStars(2)/4),this.closeContainer,r),t.x>this.initialPosition.x?(r.minX=t.x+s-this.middleContainer.x,r.maxX=t.x+n-this.middleContainer.x):(r.minX=t.x-n-this.middleContainer.x,r.maxX=t.x-s-this.middleContainer.x),this.createStars(Math.round(this.amountOfStars(1)/6),this.middleContainer,r),t.x>this.initialPosition.x?(r.minX=t.x+o-this.farContainer.x,r.maxX=t.x+n-this.farContainer.x):(r.minX=t.x-n-this.farContainer.x,r.maxX=t.x-o-this.farContainer.x),this.createStars(Math.round(this.amountOfStars(1)/8),this.farContainer,r),this.initialPosition.x=t.x}if(Math.abs(t.y-this.initialPosition.y)>=i/2){console.log("[Parallax] Vertical movement"),this.clearOutsideBoundsStars(t);var c=this.getCurrentBounds(t);t.y>this.initialPosition.y?(c.minY=t.y+a-this.closeContainer.y,c.maxY=t.y+n-this.closeContainer.y):(c.minY=t.y-n-this.closeContainer.y,c.maxY=t.y-a-this.closeContainer.y),this.createStars(Math.round(this.amountOfStars(2)/4),this.closeContainer,c),t.y>this.initialPosition.y?(c.minY=t.y+s-this.middleContainer.y,c.maxY=t.y+n-this.middleContainer.y):(c.minY=t.y-n-this.middleContainer.y,c.maxY=t.y-s-this.middleContainer.y),this.createStars(Math.round(this.amountOfStars(1)/6),this.middleContainer,c),t.y>this.initialPosition.y?(c.minY=t.y+o-this.farContainer.y,c.maxY=t.y+n-this.farContainer.y):(c.minY=t.y-n-this.farContainer.y,c.maxY=t.y-o-this.farContainer.y),this.createStars(Math.round(this.amountOfStars(1)/8),this.farContainer,c),this.initialPosition.y=t.y}}},{key:"clearOutsideBoundsStars",value:function(e){console.log("[Parallax][Clear]");var t=this.getCurrentBounds(e);this.clearContainer(this.farContainer,t),this.clearContainer(this.middleContainer,t),this.clearContainer(this.closeContainer,t)}},{key:"clearContainer",value:function(e,t){var n=this;e.getAllKeys().forEach((function(i){var a=e.get(i);a&&(n.isPointInsideBounds(a.x+e.x,a.y+e.y,t)||e.remove(i))}))}},{key:"amountOfStars",value:function(e){return i.getRandomInt(Math.pow(Math.round(this.minScreenWidth()/[120,80,60][e]),2),Math.pow(Math.round(this.minScreenHeight()/[100,70,50][e]),2))}},{key:"isPointInsideBounds",value:function(e,t,n){return e>n.minX&&e<n.maxX&&t>n.minY&&t<n.maxY}},{key:"getCurrentBounds",value:function(e){var t=new ne.Bounds;return t.minX=e.x-1.5*this.minScreenWidth(),t.maxX=e.x+1.5*this.minScreenWidth(),t.minY=e.y-1.5*this.minScreenHeight(),t.maxY=e.y+1.5*this.minScreenHeight(),t}},{key:"minScreenWidth",value:function(){return Math.max(1280,2*window.innerWidth)}},{key:"minScreenHeight",value:function(){return Math.max(1280,2*window.innerHeight)}}]),n}(ne.Container),kn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e){var i;return Object($.a)(this,n),(i=t.call(this)).sprite=void 0,i.loadTexture(e),i}return Object(ee.a)(n,[{key:"loadTexture",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(t){var i;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[Async] Loading texture ".concat(t)),e.next=3,n.loadTexture(t);case 3:i=e.sent,this.onTextureLoad(i);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTextureLoad",value:function(e){}},{key:"spriteCreated",value:function(e){this.sprite=e,this.addChild(e)}}],[{key:"loadTexture",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(t){var n;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne.Texture.fromURL(t);case 2:return(n=e.sent).baseTexture.mipmap=ne.MIPMAP_MODES.POW2,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(ne.Container),Mn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e){var i;return Object($.a)(this,n),(i=t.call(this,kt()+"/sprites/starbase/".concat(e.type,"/base.png"))).starbase=void 0,i.starbase=e,i}return Object(ee.a)(n,[{key:"onTextureLoad",value:function(e){Object(Nt.a)(Object(Ht.a)(n.prototype),"onTextureLoad",this).call(this,e);var t=new ne.Sprite(e);if(t.anchor.x=.5,t.anchor.y=.5,t.angle=this.starbase.position.angle,t.width=2*this.starbase.radius,t.height=2*this.starbase.radius,this.spriteCreated(t),this.addModules(),s.DEBUG){var i=new ne.Graphics;i.lineStyle(.5,16711935),i.drawCircle(0,0,this.starbase.radius),i.endFill(),this.addChild(i)}this.position.set(this.starbase.position.x,this.starbase.position.y)}},{key:"addModules",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(){var t,n,i,a;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.starbase.modules.length)){e.next=16;break}return n=this.starbase.modules[t],e.next=5,kn.loadTexture(kt()+"/sprites/starbase/".concat(this.starbase.type,"/").concat(n.level,".png"));case 5:i=e.sent,(a=new ne.Sprite(i)).anchor.x=.5,a.anchor.y=1,a.pivot.y=this.starbase.radius,a.angle=90*n.position,this.addChild(a),console.log(a);case 13:t++,e.next=1;break;case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(kn);!function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.PLANETS=1]="PLANETS",e[e.STARBASES=2]="STARBASES",e[e.ASTEROIDS=3]="ASTEROIDS",e[e.BULLETS=4]="BULLETS",e[e.PLAYERS=5]="PLAYERS",e[e.ME=6]="ME"}(Sn||(Sn={}));var _n=function(){function e(t,n,r){var c=this;if(Object($.a)(this,e),this.inputs={left:!1,up:!1,right:!1,down:!1},this.pointer=new ne.Point(0,0),this.forcedRotation=0,this.sendToServer=void 0,this.changeHudSpaceship=void 0,this.app=void 0,this.worldView=void 0,this.spaceshipContainer=void 0,this.asteroidContainer=void 0,this.starbasesContainer=void 0,this.bulletContainer=void 0,this.solarSystem=void 0,this.parallax=void 0,this.roomName=void 0,this.state=void 0,this.currentSpaceship=null,this.moveActions=[],this.eventHandler=void 0,this.map=void 0,this.assetsLoaded=function(){},this.hideAll=function(){c.worldView.visible=!1},this.showAll=function(){c.worldView.visible=!0},this.update=function(){c.updateInputs(),c.updateSpaceships(),c.rotateShield()},this.updateSpaceships=function(){c.selfControlMoveIfNeeded();var e,t=Object(te.a)(c.spaceshipContainer.getAll());try{for(t.s();!(e=t.n()).done;){var n=e.value;Math.abs(n.toX-n.x)>1e-4||Math.abs(n.toY-n.y)>1e-4?(n.position={x:i.lerp(n.x,n.toX,.33333333333333337),y:i.lerp(n.y,n.toY,.33333333333333337)},n.moving=!0):n.moving=!1}}catch(a){t.e(a)}finally{t.f()}},this.updateInputs=function(){var e,t=new a.Vector2(0,0);((c.inputs.up||c.inputs.down||c.inputs.left||c.inputs.right)&&(c.inputs.up&&(t.y-=1),c.inputs.down&&(t.y+=1),c.inputs.left&&(t.x-=1),c.inputs.right&&(t.x+=1)),t.isEmpty)?null!==(e=c.currentSpaceship)&&void 0!==e&&e.shouldSlide()?(c.move(t),c.currentSpaceship&&(c.currentSpaceship.moving=!0)):c.currentSpaceship&&(c.currentSpaceship.moving=!1):(c.move(t),c.currentSpaceship&&(c.currentSpaceship.moving=!0))},this.createAndSendAction=function(e,t){var n;if(c.currentSpaceship){var i={type:e,ts:Date.now(),nonce:c.currentSpaceship.nonce,value:t};return null===(n=c.sendToServer)||void 0===n||n.call(c,i),i}},this.moveToDestination=function(e){c.currentSpaceship&&(c.currentSpaceship.destination=new a.Vector2(o.hexToWorld(e.x),o.hexToWorld(e.y)),console.log(c.currentSpaceship.destination))},this.shoot=function(){if(c.currentSpaceship&&c.currentSpaceship.canShoot()){var e=i.getDegrees(i.calculateAngle(c.pointer.x,c.pointer.y,c.currentSpaceship.x,c.currentSpaceship.y));c.createAndSendAction("shoot",{angle:Math.round(e)}),c.currentSpaceship.shoot()}},this.selfControlMoveIfNeeded=function(){var e;if(null===(e=c.currentSpaceship)||void 0===e||e.animate(),c.currentSpaceship&&c.currentSpaceship.destination){var t=c.currentSpaceship.selfControl();if(!t)return;var n=c.createAndSendAction("move",{x:t.dir.x,y:t.dir.y,vx:t.velocity.x,vy:t.velocity.y});n&&c.moveActions.push(n)}},this.move=function(e){if(c.currentSpaceship){var t=c.currentSpaceship.move(e),n=c.createAndSendAction("move",{x:e.x,y:e.y,vx:t.x,vy:t.y});n&&c.moveActions.push(n),c.parallax.spaceshipMoved(t,new a.Vector2(c.currentSpaceship.x,c.currentSpaceship.y))}},this.updateMousePositionGlobally=function(){var e=c.app.renderer.plugins.interaction.mouse.global;c.pointer.set(e.x+c.worldView.left,e.y+c.worldView.top)},this.rotateShield=function(){if(c.currentSpaceship){c.updateMousePositionGlobally();var e=i.getDegrees(i.calculateAngle(c.pointer.x,c.pointer.y,c.currentSpaceship.x,c.currentSpaceship.y));c.createAndSendAction("rotate",{angle:i.positiveAngle(e)})}},this.setScreenSize=function(e,t){c.worldView.resize(e,t,2*s.ZOOM_MAP_RADIUS,2*s.ZOOM_MAP_RADIUS)},this.setState=function(e){c.state=e,console.log(c.state.asteroids),e.onChange=function(t){t.forEach((function(t){"planets"==t.field&&c.solarSystem.addPlanets(e.planets)}))},e.game.onChange=c.handleGameChange.bind(c),e.spaceships.onAdd=c.handleSpaceshipAdd.bind(c),e.spaceships.onRemove=c.handleSpaceshipRemove.bind(c),e.asteroids.onAdd=c.handleAsteroidAdd.bind(c),e.asteroids.onRemove=c.handleAsteroidRemove.bind(c),e.bullets.onAdd=c.handleBulletAdd.bind(c),e.bullets.onRemove=c.handleBulletRemove.bind(c),e.starbases.onAdd=c.handleStarbaseAdd.bind(c)},this.handleGameChange=function(e){var t,n=Object(te.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;c.gameUpdate(i.field,i.value)}}catch(a){n.e(a)}finally{n.f()}},this.gameUpdate=function(e,t){if("roomName"===e)c.roomName=t},this.handleStarbaseAdd=function(e,t){console.log("[Starbase][Add] ".concat(e.nonce));var n=new Mn(e);c.starbasesContainer.add(t.toString(),n)},this.handleSpaceshipAdd=function(e,t){console.log("[Spaceship][Add] ".concat(e.nonce)),e.onChange=function(){c.handleSpaceshipUpdate(e,t)},c.createSpaceshipSprite(e,t)},this.handleSpaceshipUpdate=function(e,t){var n=fn.isPlayerIdMe(e.playerId);if(console.log("[Spaceship][Update] nonce ".concat(e.nonce," is me: ").concat(n)),n){var s=c.spaceshipContainer.get(t);if(!s)return;if(!c.currentSpaceship){var o,r=null===(o=c.state)||void 0===o?void 0:o.players[e.playerId];return s.updatePlayer(n,r),void c.loadAndCreateSpaceshipSprite(e,r)}if(e.ack!==c.currentSpaceship.ack){c.currentSpaceship.ack=e.ack,s.update({x:e.position.x,y:e.position.y,angle:e.position.angle}),n&&(s.toX=e.position.x,s.toY=e.position.y,s.toAngle=e.position.angle);var h=c.moveActions.findIndex((function(t){return t.ts===e.ack}));c.moveActions=c.moveActions.slice(h+1),c.moveActions.forEach((function(e){var t=new a.Vector2(e.value.vx,e.value.vy);s.move(e.value,t,!1)}));var l=i.getDistance(c.currentSpaceship.x,c.currentSpaceship.y,s.x,s.y);l>0&&(console.warn("Corrected position distance=".concat(l)),c.currentSpaceship.update({x:s.x,y:s.y,angle:s.angle}))}else c.updateSpaceshipServerPosition(e,t)}else c.updateSpaceshipServerPosition(e,t)},this.handleSpaceshipRemove=function(e,t){var n=fn.isPlayerIdMe(e.playerId);c.spaceshipContainer.remove(t),n&&c.currentSpaceship&&(c.spaceshipContainer.removeChild(c.currentSpaceship),delete c.currentSpaceship)},this.handleAsteroidAdd=function(e,t){console.log("[Asteroid][Add]");var n=new An(e,c.eventHandler);c.asteroidContainer.add(t,n)},this.handleAsteroidRemove=function(e,t){console.log("[Asteroid][Remove]"),c.asteroidContainer.remove(t)},this.handleBulletAdd=function(e,t){console.log("[Bullet][Add]");var n=new On(e);c.bulletContainer.add(t.toString(),n)},this.handleBulletRemove=function(e,t){console.log("[Bullet][Remove]"),c.bulletContainer.remove(t.toString())},this.app=t,this.map=n,this.eventHandler=r,this.app.ticker.add(this.update,void 0,ne.UPDATE_PRIORITY.HIGH),this.app.ticker.maxFPS=s.FPS,this.worldView=new un.a({screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:2*s.ZOOM_MAP_RADIUS,worldHeight:2*s.ZOOM_MAP_RADIUS,interaction:this.app.renderer.plugins.interaction}),this.app.stage.addChild(this.worldView),this.worldView.zIndex=hn.GAME,this.worldView.clamp({direction:"all",underflow:"center"}),s.DEBUG&&this.worldView.wheel({smooth:3}).clampZoom({minScale:.1,maxScale:1}),this.worldView.sortableChildren=!0,this.parallax=new Cn,this.worldView.addChild(this.parallax),this.solarSystem=new ln(s.ZOOM_MAP_RADIUS,an.LARGE),this.solarSystem.x=s.ZOOM_MAP_RADIUS,this.solarSystem.y=s.ZOOM_MAP_RADIUS,this.solarSystem.zIndex=Sn.PLANETS,this.worldView.addChild(this.solarSystem),this.starbasesContainer=new se("STARBASE"),this.starbasesContainer.zIndex=Sn.STARBASES,this.worldView.addChild(this.starbasesContainer),this.asteroidContainer=new se("ASTEROID"),this.asteroidContainer.zIndex=Sn.ASTEROIDS,this.worldView.addChild(this.asteroidContainer),this.spaceshipContainer=new se("SPACESHIP"),this.spaceshipContainer.zIndex=Sn.PLAYERS,this.worldView.addChild(this.spaceshipContainer),this.bulletContainer=new se("BULLET"),this.bulletContainer.zIndex=Sn.BULLETS,this.worldView.addChild(this.bulletContainer),s.DEBUG){var h=new ne.Graphics;h.lineStyle(10,16711935),h.drawCircle(s.ZOOM_MAP_RADIUS,s.ZOOM_MAP_RADIUS,s.ZOOM_MAP_RADIUS),h.endFill(),this.worldView.addChild(h)}this.worldView.on("pointerdown",(function(e){var t=e.data.global;c.pointer.set(t.x+c.worldView.left,t.y+c.worldView.top),c.shoot()})),console.log("Game initialized \ud83e\udd29")}return Object(ee.a)(e,[{key:"leaveGameRoom",value:function(){this.currentSpaceship&&(this.currentSpaceship.resetSpaceship(),this.spaceshipContainer.removeChild(this.currentSpaceship),this.currentSpaceship=void 0)}},{key:"loadAndCreateSpaceshipSprite",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(t,n){var i;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qt.loadSpaceshipTexture(t);case 2:i=e.sent,this.createSimSpaceshipSprite(t,n,i);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createSimSpaceshipSprite",value:function(e,t,n){var i;if(this.currentSpaceship)return console.log("Already exists");this.currentSpaceship=new qt(e,n,!1,t),this.currentSpaceship.zIndex=Sn.ME,this.spaceshipContainer.addChild(this.currentSpaceship),this.worldView.follow(this.currentSpaceship),this.parallax.initialStars(e.position),null===(i=this.changeHudSpaceship)||void 0===i||i.call(this,this.currentSpaceship),console.log("Following began for ".concat(e.nonce))}},{key:"createSpaceshipSprite",value:function(){var e=Object(y.a)(Object(x.a)().mark((function e(t,n){var i,a,s,o,r;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qt.loadSpaceshipTexture(t);case 2:a=e.sent,s=fn.isPlayerIdMe(t.playerId),o=null===(i=this.state)||void 0===i?void 0:i.players[t.playerId],r=new qt(t,a,s,o),this.spaceshipContainer.add(n,r),console.log("Is me ".concat(s," - current: ").concat(fn.playerId," - spaceship ").concat(t.nonce,": ").concat(t.playerId)),s&&this.createSimSpaceshipSprite(t,o,a);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateSpaceshipServerPosition",value:function(e,t){var n=this.spaceshipContainer.get(t);n&&(n.update({x:n.toX,y:n.toY,angle:n.toAngle}),n.toX=e.position.x,n.toY=e.position.y,n.toAngle=e.position.angle)}}]),e}();ne.settings.SCALE_MODE=ne.SCALE_MODES.NEAREST;var En=function(){function e(){var t=this;Object($.a)(this,e),this._app=void 0,this._mapManager=void 0,this._gameManager=void 0,this._background=void 0,this._assetsLoaded=!1,this.eventHandler=new St,this.map=new o.Map(s.MAP_SIZE,s.MAP_SIZE),this.start=function(e){return new Promise((function(n,i){if(t._assetsLoaded)return i(new Error("Already loaded"));t._assetsLoaded=!0,console.log("Loading assets"),function(e){for(var t=ne.Loader.shared,n=1;n<=5;n++){var i=kt()+"/sprites/planets/mini/".concat(n,".png");t.add("planet-mini-".concat(n),i),i=kt()+"/sprites/planets/medium/".concat(n,".png"),t.add("planet-medium-".concat(n),i)}for(var a=1;a<=5;a++){var s=kt()+"/sprites/asteroids/empty/".concat(a,"-1.png");t.add("asteroid-empty-".concat(a,"-1"),s),s=kt()+"/sprites/asteroids/empty/".concat(a,"-2.png"),t.add("asteroid-empty-".concat(a,"-2"),s)}t.add("sun-mini-1",kt()+"/sprites/planets/mini/sun1.png").add("sun-medium-1",kt()+"/sprites/planets/medium/sun1.png").add("laser-beam",kt()+"/sprites/actions/laser.png").add("beam-sparks",kt()+"/sprites/actions/beam-sparks-sheet.json").add("thruster-1-s",kt()+"/sprites/actions/thrusters-fire-start.json").add("thruster-1-m",kt()+"/sprites/actions/thrusters-fire-move.json").add("thruster-2-s",kt()+"/sprites/actions/thrusters-main-start.json").add("thruster-2-m",kt()+"/sprites/actions/thrusters-main-move.json").add("thruster-3-s",kt()+"/sprites/actions/thrusters-special-start.json").add("thruster-3-m",kt()+"/sprites/actions/thrusters-special-move.json").add("stars",kt()+"/sprites/environment/stars.json").add("bullet-green",kt()+"/sprites/bullets/green.json").add("mapBackground",Mt).add("noGoZone","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAACVCAYAAAAKaiV+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGqSURBVHgB7d0xihNRHMfx38zEykKbhZFsEW+QG2Q9idEcQLyJB3Ah3sAjrDfIDQzoQsAmIMKCJOM024jFuMxuJpvPp3jVKx6898ov/yID97Yez4uUs3DUijSfPm6+X2WgRhm4fXbrMhy7XXuPAQAAAAAAAAAAAAAAeESKHMC8ridJdRH4282vz8vtdpsHdrBCrZJf8g/lk6erZLsKAAAAAAAAAAAAAAAAMHy9p5qL+rwJ3KP20b4a8mBCAAAAAAAAAAAAAAAAOBmdC7XFi/MPaYpngSOxu/n5vutgwv8YJlhcNdk/DwAAAAAAAAAAAAAAAJBiXtcXSTUJnKxiPSrbT1CknAVOVJN9AAAAAAAAAAAAAAAAAOBuuk/VrMdf2+2TwFEplpebb28CAAAAAAAAAAAAAAAA9K9zodbV/Gwyrardu8A96rs6G6Vvv7Nuqv2XAAAAAAAAAAAAAAAAwCPWe6HW1fxsPE2VaeDWLqvlj+tVDqD/Qq2jalRO0mQWuDXKtl0P8hEAAAAAAAAAAAAAAACAOzhYqtnVoh4v22O+DkeqWV9url9m4P4ACfNIjAV2jOMAAAAASUVORK5CYII=").add("shield",_t).load(),t.onComplete.add(e)}((function(){e.oncontextmenu=function(e){e.preventDefault(),e.stopPropagation()},e.appendChild(t.app.view),t.app.start(),t.loadMapBackground(),t.mapManager.start(),t.gameManager.assetsLoaded(),n()}))}))},this.stop=function(){t.app.ticker.stop(),t.app.stop()},this.setScreenSize=function(){t.app.renderer.resize(window.innerWidth,window.innerHeight),t.mapManager.setScreenSize(window.innerWidth,window.innerHeight),t.gameManager.setScreenSize(window.innerWidth,window.innerHeight)},this.loadMapBackground=function(){var e=window.innerWidth,n=window.innerHeight,i=new ne.Sprite(Tt(Ot.MapBackground));!function(e,t,n){var i=t/e.width,a=n/e.height;e.scale.x=Math.max(i,a),e.scale.y=Math.max(i,a)}(i,e,n),t.app.stage.addChild(i),i.zIndex=hn.BACKGROUND,t._background=i};var n=window.innerWidth,i=window.innerHeight;this._app=new ne.Application({width:n,height:i,antialias:!1,backgroundColor:ne.utils.string2hex(s.BACKGROUND_COLOR),autoDensity:!0,resolution:window.devicePixelRatio}),this.app.stage.sortableChildren=!0,this.app.stage.interactive=!0,this.app.stage.hitArea=new ne.Rectangle(0,0,2*s.ZOOM_MAP_RADIUS,2*s.ZOOM_MAP_RADIUS),this._mapManager=new gn(this.app,this.map,this.eventHandler),this._gameManager=new _n(this.app,this.map,this.eventHandler),this._gameManager.hideAll(),window.addEventListener("resize",this.setScreenSize.bind(this))}return Object(ee.a)(e,[{key:"app",get:function(){return this._app}},{key:"mapManager",get:function(){return this._mapManager}},{key:"gameManager",get:function(){return this._gameManager}},{key:"startSpaceshipControl",value:function(){this._mapManager.hideAll(),this._gameManager.showAll(),this._background&&(this._background.visible=!1)}},{key:"stopSpaceshipControl",value:function(){this._gameManager.leaveGameRoom(),this._background&&(this._background.visible=!0)}},{key:"setZoomLevel",value:function(e){this._background&&(this._background.visible=[0,1].includes(e)),0==e&&(this._mapManager.hideAll(),this._gameManager.hideAll(),this._mapManager.show(hn.MAP)),1==e&&(this._mapManager.hideAll(),this._gameManager.hideAll(),this._mapManager.show(hn.HEX)),2==e&&this.startSpaceshipControl()}}]),e}(),Pn=n(466),In=n(30),Tn={background:"#032C32",overflow:"hidden"},Rn={maxHeight:"100%",width:520,overflowY:"scroll"},Dn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(){return Object($.a)(this,n),t.apply(this,arguments)}return Object(ee.a)(n,[{key:"render",value:function(){return Object(g.jsx)("div",{className:"box",style:Object(O.a)(Object(O.a)(Object(O.a)({},Tn),this.props.popup&&Rn),this.props.style),children:this.props.children})}}]),n}(p.a.Component),Bn={fontSize:16,width:"100%"},Ln={filter:"brightness(90%)"},zn={};function Nn(e){var t=e.type,n=void 0===t?"button":t,i=e.position,a=void 0===i?"single":i,s=e.text,o=e.children,r=e.style,c=e.icon,h=e.title,l=e.reversed,u=void 0!==l&&l,d=e.disabled,f=void 0!==d&&d,v=e.onClick,b=p.a.useState(!1),x=Object(m.a)(b,2),y=x[0],j=x[1];return Object(g.jsxs)("button",{type:n,disabled:f,className:[].concat(Object(T.a)(u?["reversed"]:[]),Object(T.a)("left"==a?["group-button","left"]:[]),Object(T.a)("center"==a?["group-button","center"]:[]),Object(T.a)("right"==a?["group-button","right"]:[])).join(" "),style:Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)({},Bn),y&&Ln),u&&zn),r),onMouseEnter:function(){return j(!0)},onMouseLeave:function(){return j(!1)},title:h,onClick:v,children:[c&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(c,{}),Object(g.jsx)(Un,{size:"xxs"})]}),s||o]})}var Hn={thin:4,xxs:8,xs:16,s:24,m:32,l:48,xl:64,xxl:96,giant:128},Un=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(){return Object($.a)(this,n),t.apply(this,arguments)}return Object(ee.a)(n,[{key:"render",value:function(){return Object(g.jsx)("span",{style:{width:Hn[this.props.size],minWidth:Hn[this.props.size]},children:this.props.children})}}]),n}(p.a.Component),Gn={fontSize:16,borderRadius:8,height:48,paddingLeft:8,paddingRight:8,outline:"none",border:"1px solid #efefef",boxSizing:"border-box",width:"100%",maxWidth:"100%"},Fn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(){return Object($.a)(this,n),t.apply(this,arguments)}return Object(ee.a)(n,[{key:"render",value:function(){return Object(g.jsx)("input",{type:"text",value:this.props.value,style:Object(O.a)(Object(O.a)({},Gn),this.props.style),maxLength:this.props.maxLength,placeholder:this.props.placeholder,onChange:this.props.onChange})}}]),n}(p.a.Component),Vn={thin:4,xxs:8,xs:16,s:24,m:32,l:48,xl:64,xxl:96,giant:128},Qn=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(){return Object($.a)(this,n),t.apply(this,arguments)}return Object(ee.a)(n,[{key:"render",value:function(){return Object(g.jsx)("div",{style:{height:Vn[this.props.size],minHeight:Vn[this.props.size]}})}}]),n}(p.a.Component),Xn={display:"flex",alignItems:"center",flexBasis:0},Wn={justifyContent:"center"},Yn={textAlign:"center"},Kn={flexDirection:"column"},Zn={position:"absolute",left:0,right:0,top:0,bottom:0},qn={backgroundColor:"rgba(0,0,0,0.5)"},Jn={position:"fixed",padding:16,zIndex:1e3},$n={flexGrow:"1",flexBasis:"0"},ei=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(){return Object($.a)(this,n),t.apply(this,arguments)}return Object(ee.a)(n,[{key:"render",value:function(){return Object(g.jsx)("div",{ref:this.props.forwardRef,className:this.props.className,style:Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)({},this.props.flex&&Xn),this.props.center&&Wn),this.props.textCenter&&Yn),this.props.column&&Kn),this.props.fullscreen&&Zn),this.props.backdrop&&qn),this.props.popup&&Jn),this.props.flexEqual&&$n),this.props.style),onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,onClick:this.props.onClick,children:this.props.children})}}]),n}(p.a.Component),ti={};function ni(e){return Object(g.jsx)("p",{style:Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)(Object(O.a)({},ti),e.style),e.center&&ii.center),"title"==e.type&&ii.sectionTitle),"alt"==e.type&&ii.sectionAlt),"body"==e.type&&ii.sectionBody),children:e.children})}var ii={sectionTitle:{color:"#F3F3F3",fontSize:18},sectionAlt:{color:"#D5D5D5"},sectionBody:{color:"#EEEEEE"},center:{textAlign:"center"}},ai=n(118),si=p.a.memo((function(e){var t=e.announce,n=e.style,i=p.a.useState(0),a=Object(m.a)(i,2),s=a[0],o=a[1],r=p.a.useState("none"),c=Object(m.a)(r,2),h=c[0],l=c[1];return p.a.useEffect((function(){o(1),l("flex");var e=Date.now(),t=setInterval((function(){if(Date.now()-e>3e3)return o(0),l("none"),void clearInterval(t);o((function(e){return e-.016666666666666666}))}),50)}),[t]),t&&t.length?Object(g.jsx)(ri,{style:Object(O.a)(Object(O.a)(Object(O.a)({},oi.announce),n),{},{opacity:s,display:h}),children:Object(g.jsx)(ni,{type:"body",style:oi.announceText,children:t})}):null})),oi={announce:{},announceText:{color:"white",fontSize:ai.isMobile?16:24}};function ri(e){var t=e.children,n=e.className,i=e.style,a=e.onHovered,s=e.onClick,o=function(){var e=p.a.useState(!1),t=Object(m.a)(e,2),n=t[0],i=t[1],a=p.a.useCallback((function(){return i(!0)}),[]),s=p.a.useCallback((function(){return i(!1)}),[]),o=p.a.useRef();return[p.a.useCallback((function(e){o.current&&(o.current.removeEventListener("mouseenter",a),o.current.removeEventListener("mouseleave",s)),o.current=e,o.current&&(o.current.addEventListener("mouseenter",a),o.current.addEventListener("mouseleave",s))}),[a,s]),n]}(),r=Object(m.a)(o,2),c=r[0],h=r[1];return p.a.useEffect((function(){a&&a(h)}),[h,a]),Object(g.jsx)(ei,{forwardRef:c,className:n,style:Object(O.a)(Object(O.a)(Object(O.a)({},ci.container),ai.isMobile?{padding:8,minHeight:0}:{}),i),onClick:s,children:t})}var ci={container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",borderRadius:8,paddingTop:8,paddingBottom:8,paddingLeft:16,paddingRight:16,minHeight:56}},hi=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(){return Object($.a)(this,n),t.apply(this,arguments)}return Object(ee.a)(n,[{key:"render",value:function(){var e=this;return Object(g.jsx)(ri,{style:Object(O.a)(Object(O.a)({},ui.controls),this.props.style),children:Object(g.jsx)(d.Fragment,{children:this.props.mapButton?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(Nn,{position:"left",style:ui.button,onClick:function(){return e.props.eventHandler.send("setZoom",0)},children:"MAP"}),Object(g.jsx)(Nn,{position:"center",style:ui.button,onClick:function(){return e.props.eventHandler.send("setZoom",1)},children:"HEX"}),Object(g.jsx)(Nn,{position:"right",style:ui.button,onClick:function(){return e.props.eventHandler.send("setZoom",2)},children:"SHIP"})]}):this.props.backButton&&Object(g.jsx)(Nn,{style:ui.button,onClick:function(){return e.props.eventHandler.send("back",{})},children:"BACK"})})})}}]),n}(p.a.Component),li=p.a.memo(hi),ui={controls:{flexDirection:"row",alignItems:"flex-start",minHeight:40},button:{marginBottom:8}},di={maxWidth:"100%"};function pi(e){return Object(g.jsx)("img",{src:e.src,style:Object(O.a)(Object(O.a)({},di),e.style)})}function fi(e){var t=M().address,n=e.tile,i=e.eventHandler;return Object(g.jsx)(ei,{fullscreen:!0,flex:!0,center:!0,backdrop:!0,popup:!0,children:Object(g.jsxs)(Dn,{popup:!0,children:[Object(g.jsx)(ni,{center:!0,type:"title",children:n.coordinate.toString()}),Object(g.jsx)(Qn,{size:"xs"}),n.hexagon&&n.hexagon.spaceships.size>0&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(ni,{type:"alt",children:"Your spaceships at this location"}),Object(g.jsx)(Qn,{size:"s"})]}),function(){if(!n.hexagon)return Object(g.jsx)(g.Fragment,{});var e=Array.from(n.hexagon.spaceships.values());return e.map((function(e,n){return Object(g.jsxs)(ei,{children:[Object(g.jsxs)(ei,{flex:!0,children:[Object(g.jsxs)(ei,{center:!0,flexEqual:!0,textCenter:!0,children:[Object(g.jsx)(pi,{src:Dt(e.info.level,e.info.image),style:gi.image}),Object(g.jsx)(Qn,{size:"xxs"}),Object(g.jsxs)(ni,{type:"body",children:["Krogan #",e.nonce]})]}),Object(g.jsxs)(ei,{center:!0,flexEqual:!0,children:[Object(g.jsx)(ni,{type:"body",children:"Spaceship stats"}),Object(g.jsx)(Qn,{size:"xxs"}),Object(g.jsx)(ni,{type:"body",children:"Placeholder"})]})]}),Object(g.jsx)(Qn,{size:"xxs"}),e.address==t&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(ei,{flex:!0,center:!0,children:[Object(g.jsx)(Nn,{onClick:function(){return i.send("warpInitiate",e)},children:"WARP TO"}),Object(g.jsx)(Un,{size:"s"}),Object(g.jsx)(Nn,{onClick:function(){alert("Coming soon!")},children:"PATROL"})]}),Object(g.jsx)(Qn,{size:"s"})]})]},n)}))}(),Object(g.jsx)(Qn,{size:"m"}),Object(g.jsx)(Nn,{onClick:function(){return i.send("hexExplore",n)},children:"EXPLORE"}),Object(g.jsx)(Qn,{size:"xs"}),Object(g.jsx)(ei,{flex:!0,children:Object(g.jsx)(Nn,{reversed:!0,onClick:function(){return i.send("closePopup","close")},children:"Close"})})]})})}var gi={image:{width:"100px"}};function vi(e,t){switch(t.type){case"setLobbyRoom":var n=t.lobbyRoom;return Object(O.a)(Object(O.a)({},e),{},{lobbyRoom:n});case"setGameRoom":var i=t.gameRoom;return Object(O.a)(Object(O.a)({},e),{},{gameRoom:i});case"setMapRoom":var a=t.mapRoom;return Object(O.a)(Object(O.a)({},e),{},{mapRoom:a});case"setPlayer":var s=t.player;return Q("player",s,10800),Object(O.a)(Object(O.a)({},e),{},{player:s});case"setSpaceships":var o=t.spaceships;return Object(O.a)(Object(O.a)({},e),{},{spaceships:o});case"setStats":var r=t.stats;return Object(O.a)(Object(O.a)({},e),{},{hud:Object(O.a)(Object(O.a)({},e.hud),{},{stats:r})});case"setBackButton":var c=t.visible;return Object(O.a)(Object(O.a)({},e),{},{hud:Object(O.a)(Object(O.a)({},e.hud),{},{backButtonVisible:c})});case"setSelectedPoint":var h=t.point;return Object(O.a)(Object(O.a)({},e),{},{hud:Object(O.a)(Object(O.a)({},e.hud),{},{selectedPoint:h})});case"setSelectedTile":var l=t.tile;return Object(O.a)(Object(O.a)({},e),{},{hud:Object(O.a)(Object(O.a)({},e.hud),{},{selectedTile:l})});case"setSelectedSpaceship":var u=t.spaceship;return Object(O.a)(Object(O.a)({},e),{},{hud:Object(O.a)(Object(O.a)({},e.hud),{},{selectedSpaceship:u})});case"setPlayerId":var d=t.playerId;return Object(O.a)(Object(O.a)({},e),{},{hud:Object(O.a)(Object(O.a)({},e.hud),{},{playerId:d})});case"setControlledSpaceship":var p=t.spaceship;return Object(O.a)(Object(O.a)({},e),{},{hud:Object(O.a)(Object(O.a)({},e.hud),{},{backButtonVisible:!1,controlledSpaceship:p})});case"setAsteroid":var f=t.asteroid;return Object(O.a)(Object(O.a)({},e),{},{hud:Object(O.a)(Object(O.a)({},e.hud),{},{backButtonVisible:!1,selectedAsteroid:f})})}}var mi=p.a.createContext(void 0),bi=p.a.createContext(void 0);function xi(e){var t=e.children,n=p.a.useReducer(vi,{player:V("player"),hud:{backButtonVisible:!1,playerId:"",messages:[],announce:""},spaceships:[]}),i=Object(m.a)(n,2),a=i[0],s=i[1];return Object(g.jsx)(mi.Provider,{value:a,children:Object(g.jsx)(bi.Provider,{value:s,children:t})})}function yi(){var e=p.a.useContext(mi);if(void 0===e)throw new Error("useState must be used within a Context.Provider");return e}function ji(){var e=p.a.useContext(bi);if(void 0===e)throw new Error("useDispatch must be used within a Dispatch.Provider");return e}function Ai(e){var t=yi().hud,n=M().address,i=e.spaceship,a=e.eventHandler;return Object(g.jsx)(ei,{fullscreen:!0,flex:!0,center:!0,backdrop:!0,popup:!0,children:Object(g.jsxs)(Dn,{popup:!0,children:[Object(g.jsxs)(ni,{center:!0,type:"title",children:["Krogan #",i.nonce]}),Object(g.jsx)(Qn,{size:"xs"}),i.address==n&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(Nn,{onClick:function(){return a.send("spaceshipControl",i,t.controlledSpaceship)},children:"TAKE CONTROL"}),Object(g.jsx)(Qn,{size:"s"}),Object(g.jsxs)(ei,{flex:!0,center:!0,children:[Object(g.jsx)(Nn,{onClick:function(){return a.send("warpInitiate",i)},children:"WARP TO"}),Object(g.jsx)(Un,{size:"s"}),Object(g.jsx)(Nn,{onClick:function(){alert("Coming soon!")},children:"PATROL"})]}),Object(g.jsx)(Qn,{size:"xs"})]}),Object(g.jsx)(ei,{flex:!0,children:Object(g.jsx)(Nn,{reversed:!0,onClick:function(){return a.send("closePopup","close")},children:"Close"})})]})})}function Oi(e){var t=e.point,n=e.eventHandler,i=yi().gameRoom;return Object(g.jsx)(ei,{fullscreen:!0,flex:!0,center:!0,backdrop:!0,popup:!0,children:Object(g.jsxs)(Dn,{popup:!0,children:[Object(g.jsx)(ni,{center:!0,type:"title",children:JSON.stringify(t)}),i&&Object(g.jsx)(Nn,{onClick:function(){return n.send("spaceshipSelfControl",{type:"goto",point:t})},children:"GO TO"}),Object(g.jsx)(Qn,{size:"xs"}),Object(g.jsx)(Nn,{reversed:!0,onClick:function(){return n.send("closePopup","close")},children:"Close"})]})})}function Si(e){var t=yi().hud,n=e.asteroid,i=e.eventHandler;return Object(g.jsx)(ei,{fullscreen:!0,flex:!0,center:!0,backdrop:!0,popup:!0,children:Object(g.jsxs)(Dn,{popup:!0,children:[Object(g.jsxs)(ni,{center:!0,type:"title",children:["Asteroid #",n.nonce]}),Object(g.jsx)(Qn,{size:"xs"}),n.materials?n.materials.map((function(e,t){return Object(g.jsxs)(ei,{children:[Object(g.jsx)(ei,{flex:!0,center:!0,children:Object(g.jsxs)(ei,{center:!0,textCenter:!0,children:[Object(g.jsxs)(ni,{type:"body",children:[e.name," ( ",e.type," )"]}),Object(g.jsx)(Qn,{size:"xxs"}),Object(g.jsx)(ni,{type:"body",children:e.production.toFixed(5)})]})}),Object(g.jsx)(Qn,{size:"s"})]},t)})):Object(g.jsx)(g.Fragment,{}),Object(g.jsx)(Nn,{onClick:function(){i.send("closePopup","close"),function(e,t,n){var i=setInterval((function(){e()&&(t(),clearInterval(i))}),n)}((function(){var e,n;return null!==(e=null===(n=t.controlledSpaceship)||void 0===n?void 0:n.velocity.isEmpty)&&void 0!==e&&e}),(function(){i.send("mineAsteroid",n)}),500)},children:"START MINING"}),Object(g.jsx)(Qn,{size:"xs"}),Object(g.jsx)(ei,{flex:!0,children:Object(g.jsx)(Nn,{reversed:!0,onClick:function(){return i.send("closePopup","close")},children:"Close"})})]})})}var wi=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e){var i;return Object($.a)(this,n),(i=t.call(this,e)).styleForDamage=function(e){if(e)return e<=0?ki.damageTotal:e<30?ki.damageHard:e<60?ki.damageMedium:e<90?ki.damageLight:ki.damageNone},i}return Object(ee.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.spaceship.stats.listen("damageMap",(function(){e.forceUpdate()}))}},{key:"render",value:function(){return Object(g.jsx)(ri,{className:"box-empty",style:Object(O.a)({},this.props.style),children:Object(g.jsx)(d.Fragment,{children:Object(g.jsxs)(ei,{flex:!0,style:ki.damageMap,children:[Object(g.jsxs)(ei,{flex:!0,column:!0,style:ki.damageMapColumn,children:[Object(g.jsx)(Dn,{style:ki.emptyItem,children:Object(g.jsx)("p",{})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("0-3"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("0-2"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("0-1"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:ki.emptyItem,children:Object(g.jsx)("p",{style:ki.text})})]}),Object(g.jsxs)(ei,{flex:!0,column:!0,style:ki.damageMapColumn,children:[Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("1-4"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("1-3"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("1-2"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("1-1"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("1-0"))),children:Object(g.jsx)("p",{style:ki.text})})]}),Object(g.jsxs)(ei,{flex:!0,column:!0,style:ki.damageMapColumn,children:[Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("2-4"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("2-3"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("2-2"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("2-1"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("2-0"))),children:Object(g.jsx)("p",{style:ki.text})})]}),Object(g.jsxs)(ei,{flex:!0,column:!0,style:ki.damageMapColumn,children:[Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("3-4"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("3-3"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("3-2"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("3-1"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("3-0"))),children:Object(g.jsx)("p",{style:ki.text})})]}),Object(g.jsxs)(ei,{flex:!0,column:!0,style:ki.damageMapColumn,children:[Object(g.jsx)(Dn,{style:ki.emptyItem,children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("4-3"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("4-2"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:Object(O.a)(Object(O.a)({},ki.damageMapItem),this.styleForDamage(this.props.spaceship.stats.damageMap.get("4-1"))),children:Object(g.jsx)("p",{style:ki.text})}),Object(g.jsx)(Dn,{style:ki.emptyItem,children:Object(g.jsx)("p",{})})]}),Object(g.jsx)(pi,{src:Dt(this.props.spaceship.info.level,this.props.spaceship.info.image),style:ki.spaceship})]})})})}}]),n}(p.a.Component),Ci=p.a.memo(wi),ki={text:{fontSize:"8px"},damageMap:{background:"transparent",borderRadius:"50%",overflow:"hidden",flexBasis:"inherit",width:"15vw",height:"15vw",alignItems:"stretch"},emptyItem:{background:"transparent",border:"none",width:"100%",height:"100%"},damageMapColumn:{alignItems:"stretch",flex:1},damageMapItem:{color:"white",textAlign:"center",border:"0.5px solid white",zIndex:2,width:"100%",height:"100%",background:"transparent",opacity:.4},damageNone:{background:"#48d67a"},damageLight:{background:"#d8cc49"},damageMedium:{background:"#c4893c"},damageHard:{background:"#d84949"},damageTotal:{background:"#000000",opacity:.75},spaceship:{position:"absolute",top:0,left:0,zIndex:1,opacity:.8,filter:"opacity(0.5) drop-shadow(0 0 0 #00323a)"}};function Mi(e){var t=e.material,n=Object(d.useState)(0),i=Object(m.a)(n,2),a=i[0],s=i[1];return Object(d.useEffect)((function(){s(t.production),t.listen("production",(function(e,t){console.log("[Material][Update] val: ".concat(e,", prev: ").concat(t)),function(e,t,n,i){var a=e,o=n/i,r=(t>e?1:-1)*(t-e)/i;console.log("Animate increment ".concat(r)),setTimeout((function e(){(a+=r)>t?s(t):(s(a),setTimeout(e,o))}),o)}(t,e,1e3,10)}))}),[t]),Object(g.jsxs)("p",{style:_i.text,children:[t.name," ",a.toFixed(8)]})}var _i={text:{fontSize:"10px"}},Ei=function(e){Object(ie.a)(n,e);var t=Object(ae.a)(n);function n(e){var i;return Object($.a)(this,n),(i=t.call(this,e)).materials=new rn,i.props.spaceship.cargo.forEach((function(e,t){i.materials.add(t,e)})),i}return Object(ee.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.spaceship.cargo.onAdd=function(t,n){e.materials.add(n,t),e.forceUpdate()},this.props.spaceship.cargo.onRemove=function(t,n){e.materials.remove(n),e.forceUpdate()}}},{key:"componentDidUpdate",value:function(e){var t=this;e.spaceship.nonce!=this.props.spaceship.nonce&&(console.log("Component update"),this.materials=new rn,this.props.spaceship.cargo.forEach((function(e,n){t.materials.add(n,e)})),this.forceUpdate())}},{key:"render",value:function(){return Object(g.jsxs)(Dn,{style:Object(O.a)(Object(O.a)({},this.props.style),Ii.box),children:[Object(g.jsxs)("p",{children:["Cargo Krogan #",this.props.spaceship.nonce]}),this.materials.getAll().map((function(e,t){return Object(g.jsx)(Mi,{material:e},t)})),0==this.materials.length()&&Object(g.jsx)("p",{style:Ii.text,children:"Empty. Mine asteroids to gather materials."})]})}}]),n}(p.a.Component),Pi=p.a.memo(Ei),Ii={text:{fontSize:"10px"},box:{maxWidth:"250px"}},Ti=ai.isMobile?16:24,Ri=p.a.memo((function(e){var t=yi(),n=t.hud,i=t.gameRoom,a=e.eventHandler,s=p.a.useState(!1),o=Object(m.a)(s,2),c=o[0],h=o[1],l=p.a.useState(!1),u=Object(m.a)(l,2),d=u[0],f=u[1],v=function(e){var t=e.code;r.MENU.includes(t)&&(e.preventDefault(),e.stopPropagation(),a.send("closePopup"))},b=function(e){e.code};return p.a.useEffect((function(){return window.document.addEventListener("keydown",v),window.document.addEventListener("keyup",b),function(){window.document.removeEventListener("keydown",v),window.document.removeEventListener("keyup",b)}}),[]),p.a.useEffect((function(){n.controlledSpaceship&&(console.log("[Mining][Setup][HUD]"),n.controlledSpaceship.spaceship.listen("mining",(function(){var e;f(void 0!=(null===(e=n.controlledSpaceship)||void 0===e?void 0:e.spaceship.mining))})))}),[n.controlledSpaceship]),Object(g.jsxs)(ei,{flex:!0,center:!0,style:Di.hud,children:[Object(g.jsx)(si,{announce:n.announce,style:Di.announce}),Object(g.jsx)(li,{style:Di.controls,mapButton:void 0!=i,backButton:n.backButtonVisible,eventHandler:a}),n.controlledSpaceship&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(Ci,{style:Di.panels,spaceship:n.controlledSpaceship.spaceship}),d&&Object(g.jsx)(Pi,{style:Di.cargo,spaceship:n.controlledSpaceship.spaceship})]}),c?Object(g.jsx)(Bi,{onClose:function(){return h(!1)},onLeave:function(){window.location.href=window.location.origin}}):null,n.selectedTile&&Object(g.jsx)(fi,{eventHandler:a,tile:n.selectedTile}),n.selectedSpaceship&&Object(g.jsx)(Ai,{eventHandler:a,spaceship:n.selectedSpaceship.spaceship}),n.selectedPoint&&Object(g.jsx)(Oi,{point:n.selectedPoint,eventHandler:a}),n.selectedAsteroid&&Object(g.jsx)(Si,{asteroid:n.selectedAsteroid,eventHandler:a})]})})),Di={hud:{},controls:{position:"absolute",right:Ti,bottom:Ti},panels:{position:"absolute",left:Ti,bottom:Ti},cargo:{position:"absolute",left:Ti,top:Ti},players:{position:"absolute",right:Ti,top:Ti},messages:{position:"absolute",left:Ti,bottom:Ti},announce:{position:"absolute"}};function Bi(e){e.onClose,e.onLeave,window.location.href,p.a.useRef(null);return Object(d.useEffect)((function(){return console.log("Menu opened")}),[]),Object(g.jsx)(g.Fragment,{})}ai.isMobile,ai.isMobile,ai.isMobile;n.p;n.p;n.p;n.p;n.p;n.p,ai.isMobile;ai.isMobile,ai.isMobile;var Li=n(479),zi=n(355);function Ni(){var e=yi(),t=p.a.useRef(e);return p.a.useEffect((function(){t.current=e}),[e]),[e,t]}var Hi=function(e,t,n){var i=Ni(),a=Object(m.a)(i,2),o=a[0],r=o.mapRoom,c=o.player,h=a[1],l=M(),u=l.account,p=l.address,f=ji(),g=new zi.Client(Ct()),v=null;Object(d.useEffect)((function(){if(!v)return v=setInterval(R,s.PLAYERS_REFRESH),function(){A()}}),[]);var b=function(){var e=Object(y.a)(Object(x.a)().mark((function e(){var t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c&&u){e.next=2;break}return e.abrupt("return",console.error("Something went wrong with the account!"));case 2:t={address:p},g.joinOrCreate(c.team,t).then((function(e){f({type:"setMapRoom",mapRoom:e})})).catch((function(e){console.error(e)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(d.useEffect)((function(){r&&(console.log("Connected to map: ".concat(r.id)),O(),j())}),[r]);var j=function(){n.on("warpInitiate",P),n.on("warpSpaceship",I),n.on("hexClick",E),n.on("hexExplore",_),n.on("back",k),n.on("setZoom",C),n.on("closePopup",w),n.on("spaceshipClick",S)},A=function(){r&&r.leave(),v&&clearInterval(v),n.remove("warpInitiate",I),n.remove("warpSpaceship",I),n.remove("hexClick",E),n.remove("hexExplore",_),n.remove("back",k),n.remove("setZoom",C),n.remove("spaceshipClick",S),n.remove("closePopup",w)},O=function(){r&&(fn.playerId=r.sessionId,f({type:"setPlayerId",playerId:r.sessionId}),t.setState(r.state),r.onMessage("broadcast",T))},S=function(e){f({type:"setSelectedSpaceship",spaceship:e})},w=function(){f({type:"setSelectedSpaceship",spaceship:void 0}),f({type:"setSelectedTile",tile:void 0})},C=function(t){e.setZoomLevel(t)},k=function(){f({type:"setBackButton",visible:!1}),t.returnToMap()},_=function(e){f({type:"setBackButton",visible:!0}),w(),t.exploreTile(e)},E=function(e){f({type:"setSelectedTile",tile:e})},P=function(e){var n,i=null===(n=h.current)||void 0===n?void 0:n.hud;i&&(i.selectedTile?(t.setSelectedSpaceship(e),w()):i.selectedSpaceship&&(w(),k(),t.setSelectedSpaceship(e)))},I=function(t){var n,i=h.current.hud;i.controlledSpaceship&&i.controlledSpaceship.nonce==t.nonce&&(e.stopSpaceshipControl(),f({type:"setControlledSpaceship",spaceship:void 0})),n={type:"warp",ts:Date.now(),nonce:t.nonce,value:t},r&&r.send(n.type,n)},T=function(e){},R=function(){var e=t.getStats();f({type:"setStats",stats:e})};return{joinMapRoom:b,mapManager:t,leave:function(){null===r||void 0===r||r.leave()}}},Ui=function(e){var t,n,i=e.appManager,a=yi(),s=a.hud,c=a.mapRoom,h=M().isLoggedIn,l=Object(In.m)(),u=Hi(i,i.mapManager,i.eventHandler),f=function(e,t,n){var i=Ni(),a=Object(m.a)(i,2),s=a[0],c=s.gameRoom,h=s.player,l=s.hud,u=a[1],p=M(),f=p.account,g=p.address,v=ji(),b=new zi.Client(Ct());Object(d.useEffect)((function(){return n.on("spaceshipControl",A),n.on("spaceshipSelfControl",k),n.on("largeHexClick",C),n.on("closePopup",O),n.on("asteroidClick",S),n.on("mineAsteroid",w),function(){j()}}),[]);var j=function(){c&&c.leave(),n.remove("spaceshipControl",A),n.remove("spaceshipSelfControl",k),n.remove("largeHexClick",C),n.remove("closePopup",O),n.remove("asteroidClick",S),n.remove("mineAsteroid",w),window.document.removeEventListener("keydown",R),window.document.removeEventListener("keyup",D)},A=function(){var n=Object(y.a)(Object(x.a)().mark((function n(i,a){var s,r,c,l,d;return Object(x.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=u.current,r=s.gameRoom,!a||a.nonce!=i.nonce){n.next=3;break}return n.abrupt("return",console.error("Same spaceship"));case 3:if(h&&f){n.next=5;break}return n.abrupt("return",console.error("Something went wrong with the account!"));case 5:c={address:g,spaceship:i.nonce},l=o.CoordinateModel.getRoomName(i.coordinate.x,i.coordinate.y,i.coordinate.z),(null===r||void 0===r?void 0:r.name)!=l?(r&&(console.log("Leaving previous game room"),r.leave(!0)),b.joinOrCreate(l,c).then((function(e){v({type:"setGameRoom",gameRoom:e})})).catch((function(e){console.error(e)}))):a&&(console.log("Switching spaceship inside the same room"),d={type:"switch",ts:Date.now(),nonce:a.nonce,value:{nonce:i.nonce}},_(d)),t.leaveGameRoom(),e.startSpaceshipControl(),v({type:"setSelectedSpaceship",spaceship:void 0});case 11:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();Object(d.useEffect)((function(){c&&(console.log("Connected to game room: ".concat(c.id," with playerId: ").concat(c.sessionId)),t.sendToServer=_,fn.playerId=c.sessionId,t.changeHudSpaceship=E,I(),P())}),[c]),Object(d.useEffect)((function(){!l.controlledSpaceship&&c&&(console.log("Leaving previous game room"),c.leave(!0),v({type:"setGameRoom",gameRoom:void 0}))}),[l]);var O=function(){v({type:"setAsteroid",asteroid:void 0}),v({type:"setSelectedPoint",point:void 0})},S=function(e){v({type:"setAsteroid",asteroid:e})},w=function(e){v({type:"setAsteroid",asteroid:void 0}),t.createAndSendAction("mine",{nonce:e.nonce})},C=function(e){v({type:"setSelectedPoint",point:e})},k=function(e){"goto"==e.type&&t.moveToDestination(e.point),v({type:"setSelectedPoint",point:void 0})},_=function(e){var t=u.current.gameRoom;t&&t.send(e.type,e)},E=function(e){v({type:"setControlledSpaceship",spaceship:e})},P=function(){window.document.addEventListener("keydown",R),window.document.addEventListener("keyup",D)},I=function(){c&&(console.log("[Game][Connected] ".concat(c.sessionId)),c.onMessage("broadcast",T),t.setState(c.state))},T=function(e){},R=function(e){if(t){var n=e.code;r.LEFT.includes(n)&&(e.preventDefault(),e.stopPropagation(),t.inputs.left=!0),r.UP.includes(n)&&(e.preventDefault(),e.stopPropagation(),t.inputs.up=!0),r.RIGHT.includes(n)&&(e.preventDefault(),e.stopPropagation(),t.inputs.right=!0),r.DOWN.includes(n)&&(e.preventDefault(),e.stopPropagation(),t.inputs.down=!0)}},D=function(e){if(t){var n=e.code;r.LEFT.includes(n)&&(e.preventDefault(),e.stopPropagation(),t.inputs.left=!1),r.UP.includes(n)&&(e.preventDefault(),e.stopPropagation(),t.inputs.up=!1),r.RIGHT.includes(n)&&(e.preventDefault(),e.stopPropagation(),t.inputs.right=!1),r.DOWN.includes(n)&&(e.preventDefault(),e.stopPropagation(),t.inputs.down=!1)}};return{gameManager:t,leave:function(){null===c||void 0===c||c.leave()}}}(i,i.gameManager,i.eventHandler),v=p.a.useRef(null);Object(d.useEffect)((function(){return b(),function(){j()}}),[]);var b=function(){var e=Object(y.a)(Object(x.a)().mark((function e(){return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=3;break}return l("/"),e.abrupt("return");case 3:i.start(v.current).then((function(){c||u.joinMapRoom()})).catch((function(e){return console.warn}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){u.leave(),f.leave()};return Object(g.jsxs)(ei,{children:[Object(g.jsx)(Li.a,{children:Object(g.jsx)("title",{children:"".concat(null===(t=s.stats)||void 0===t?void 0:t.roomName," [").concat(null===(n=s.stats)||void 0===n?void 0:n.playersCount,"]")})}),Object(g.jsx)("div",{className:"canvas-container",ref:v}),Object(g.jsx)(Ri,{eventHandler:i.eventHandler})]})},Gi=function(e){var t=e.onSave,n=Object(d.useState)(""),i=Object(m.a)(n,2),a=i[0],o=i[1];Object(d.useEffect)((function(){var e;o(null!==(e=localStorage.getItem("playerName"))&&void 0!==e?e:"")}),[]);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(ei,{flex:!0,children:Object(g.jsx)(ni,{type:"body",children:"Pick your name:"})}),Object(g.jsx)(Qn,{size:"s"}),Object(g.jsx)(Fn,{value:a,placeholder:"Name",maxLength:s.PLAYER_NAME_MAX,onChange:function(e){o(e.target.value)}}),Object(g.jsx)(Qn,{size:"s"}),Object(g.jsx)(Nn,{text:"Save",onClick:function(){""!=a&&(localStorage.setItem("playerName",a),t(a))}})]})};Array.prototype.isEmpty=function(){return 0==this.length},Array.prototype.insert=function(e,t){this.splice(e,0,t)},Array.prototype.serialized=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?this.map((function(e){return e.serializeMin()})):this.map((function(e){return e.serialize()}))},Array.prototype.remove=function(e){var t=this.indexOf(e);return t>-1&&(this.splice(t,1),!0)},Array.prototype.last=function(){return this.length>0?this[this.length-1]:null},Array.prototype.first=function(){return this.length>0?this[0]:null},Date.prototype.addSeconds=function(e){var t=1e3*e;return this.setTime(this.getTime()+t),this},String.prototype.truncate=function(e,t){if(this.length<=e)return""+this;var n=e-(t=t||"...").length,i=Math.ceil(n/2),a=Math.floor(n/2);return this.substr(0,i)+t+this.substr(this.length-a)};var Fi={fontSize:16,borderRadius:8,paddingLeft:8,paddingRight:8,border:"1px solid #efefef",boxSizing:"border-box"},Vi={background:"#aaaaaa",border:"1px solid red"},Qi=function(e){var t=e.nft,n=e.style,i=e.selected,a=e.onClick;return Object(g.jsxs)("div",{style:i?Object(O.a)(Object(O.a)(Object(O.a)({},Fi),n),Vi):Object(O.a)(Object(O.a)({},Fi),n),onClick:function(){a(t)},children:[Object(g.jsx)("img",{src:t.url,style:{maxWidth:"100%"},alt:"".concat(t.collection," #").concat(t.nonce)}),Object(g.jsx)("p",{children:t.name}),Object(g.jsx)("p",{children:i?"Selected":"Not selected"})]})},Xi=function(e,t){return fetch("".concat(h,"/accounts/").concat(e,"/nfts?search=").concat(t)).then((function(e){return e.json()})).catch((function(e){console.error(e)}))},Wi=function(e){var t=e.player,n=e.selected,i=M(),a=i.account,o=i.address,r=Object(d.useState)([]),c=Object(m.a)(r,2),h=c[0],l=c[1],u=Object(d.useState)([]),f=Object(m.a)(u,2),v=f[0],b=f[1],x=p.a.useState(),y=Object(m.a)(x,2)[1],j=p.a.useCallback((function(){return y({})}),[]);Object(d.useEffect)((function(){t&&a&&Xi(o,s.KROGAN_MAIN).then((function(e){console.log("Account got ".concat(e.length," nfts")),l(e)}))}),[t]);var A=function(e){if(e.nonce){var t=v;t.includes(e.nonce)?t.remove(e.nonce):t.push(e.nonce),b(t),j(),console.log(v)}};return Object(g.jsxs)(g.Fragment,{children:[0==h.length&&Object(g.jsxs)("p",{children:["You do not own any Krogan NFTs. To play this game, you can purchase or rent one on ",Object(g.jsx)("a",{href:"https://elrondnftswap.com",children:"our marketplace."})]}),h.map((function(e,t){return Object(g.jsx)(Qi,{nft:e,selected:v.includes(e.nonce),onClick:A},t)})),Object(g.jsx)(Qn,{size:"s"}),Object(g.jsx)(Nn,{text:"Save",onClick:function(){n(v)}})]})},Yi=function(){var e,t=Object(In.m)(),n=function(){var e=yi().lobbyRoom,t=ji(),n=new zi.Client(Ct()),i=Object(d.useState)(""),a=Object(m.a)(i,2),o=a[0],r=a[1],c=function(){var e=Object(y.a)(Object(x.a)().mark((function e(i){var a,o;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Connecting as ".concat(i)),a={address:i},e.next=4,n.joinOrCreate(s.ROOM_LOBBY_NAME,a).catch((function(e){console.error(e),r("The Alpha version of Kroganverse is open only to a close group. Wait for the beta version to be able to test the game.")}));case 4:(o=e.sent)&&(console.log("Connected to room: ".concat(o.id)),t({type:"setLobbyRoom",lobbyRoom:o}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(d.useEffect)((function(){e&&(e.onMessage("broadcast",f),e.state.players.onAdd=l,e.state.players.onRemove=p)}),[e]);var h=function(t){return(null===e||void 0===e?void 0:e.sessionId)===t},l=function(e,t){e.onChange=function(){u(e,e.playerId)},u(e,t)},u=function(e,n){h(n)&&t({type:"setPlayer",player:e})},p=function(e,n){h(n)&&t({type:"setPlayer",player:void 0})},f=function(e){console.log("Received message: ".concat(JSON.stringify(e)))};return{message:o,connectToLobby:c,updateUsername:function(t){null===e||void 0===e||e.send(s.SET_USERNAME,t)},updateSpaceships:function(t){null===e||void 0===e||e.send(s.SET_SPACESHIPS,t)},leave:function(){null===e||void 0===e||e.leave()}}}(),i=M(),a=i.isLoggedIn,o=i.address,r=yi().player;Object(d.useEffect)((function(){return c(),function(){h()}}),[]);var c=function(){var e=Object(y.a)(Object(x.a)().mark((function e(){return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){n.leave()};Object(d.useEffect)((function(){a?n.connectToLobby(o):n.leave()}),[a]);return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)(ei,{flex:!0,center:!0,style:{padding:32,flexDirection:"column"},children:[Object(g.jsx)(Li.a,{children:Object(g.jsx)("title",{children:"".concat(s.APP_TITLE," - Home")})}),Object(g.jsx)(ei,{flex:!0,center:!0,column:!0,children:Object(g.jsx)(pi,{src:"/images/branding.png"})}),Object(g.jsx)(Qn,{size:"m"}),Object(g.jsxs)(Dn,{style:{width:500,maxWidth:"100%",textAlign:"center"},children:[Object(g.jsx)(v,{}),n.message&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(Qn,{size:"s"}),Object(g.jsx)(ni,{type:"body",children:n.message})]}),a&&r&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("p",{children:JSON.stringify(r)}),Object(g.jsx)("p",{children:null===r||void 0===r||null===(e=r.nfts)||void 0===e?void 0:e.join(", ")}),void 0==r.username&&Object(g.jsx)(Gi,{onSave:n.updateUsername}),r.username&&0==r.nfts.length&&Object(g.jsx)(Wi,{player:r,selected:n.updateSpaceships}),Object(g.jsx)(Qn,{size:"s"}),r.username&&r.nfts.length>0&&Object(g.jsx)(Nn,{text:"Start game",onClick:function(){n.leave(),t("/game")}})]})]})]})})};window.React1=n(0);var Ki=new En,Zi=function(){var e=_(),t=M().showLoginModal;return Object(g.jsxs)(Pn.a,{children:[Object(g.jsx)(I,{show:t,onHide:function(){e({type:"setShowLoginModal",showLoginModal:!1})}}),Object(g.jsxs)(In.c,{children:[Object(g.jsx)(In.a,{path:"/",element:Object(g.jsx)(Yi,{})}),Object(g.jsx)(In.a,{path:"/:routeId",element:Object(g.jsx)(Ui,{appManager:Ki})})]})]})},qi=n(784),Ji=n.n(qi),$i=n(785);Ji.a.createRoot(document.getElementById("root")).render(Object(g.jsx)(p.a.StrictMode,{children:Object(g.jsx)(k,{api:h,children:Object(g.jsx)($i.a,{environment:l.id,customNetworkConfig:l,children:Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(P.d,{successfulToastLifetime:5e3,className:""}),Object(g.jsx)(P.c,{}),Object(g.jsx)(xi,{children:Object(g.jsx)(Zi,{})})]})})})})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},232:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s}));var i=function(e){var t=e.input,n=e.denomination,i=e.decimals,a=e.showLastNonZeroDecimal,s=void 0!==a&&a,o=e.addCommas;return"..."===t?t:(""!==t&&"0"!==t&&void 0!==t||(t="0"),function(e,t,n,i,a){i="undefined"!==typeof i&&i;var s=e.toString().split("");if(0!==t){for(;s.length<t+1;)s.unshift("0");for(s.splice(s.length-t,0,".");s.length-s.indexOf(".")<=n;)s.push("0");if(i){for(var o=0,r=s.length-1;r>0;r--)if("0"!==s[r]){o=r+1;break}var c=s.indexOf(".")+n+1,h=Math.max(c,o);s=s.slice(0,h)}else{for(;"0"===s[s.length-1];)s=s.slice(0,s.length-1);s=s.slice(0,s.indexOf(".")+n+1)}}if(a){s=s.reverse();for(var l=t?s.length-s.indexOf(".")-1:s.length,u=Math.floor(l/3),d=1;d<=u;d++){var p=s.indexOf(".")+3*d+d;p!==s.length&&s.splice(p,0,",")}s=s.reverse()}var f=s.slice(s.indexOf(".")+1).every((function(e){return"0"===e.toString()})),g=s.join("");return f?g.split(".")[0]:0===n?g.split(".").join(""):g}(t,n,i,s,void 0===o||o))},a=function(e,t){return i({input:e,denomination:18,decimals:t})},s=function(e){var t=atob(e),n=[];return t.split("").forEach((function(e){var t=e.charCodeAt(0).toString(16);t.length%2&&(t="0"+t),n.push(t)})),BigInt("0x"+n.join(""))}},467:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i.c}));n(0);var i=n(232),a=n(4),s=function(e){return"EGLD"==e||void 0==e?Object(a.jsx)("img",{src:"/images/egld.svg",width:"16",height:"16",alt:"EGLD"}):"KRO-df97ec"==e?Object(a.jsx)("img",{src:"/images/".concat(e,".gif"),width:"16",height:"16",title:e,alt:e}):Object(a.jsx)("img",{src:"/images/".concat(e,".webp"),width:"16",height:"16",title:e,alt:e})},o=function(e){var t,n=e.value,o=e.token,r=void 0===o?"EGLD":o,c=e.denomination,h=void 0===c?18:c,l=e.showLastNonZeroDecimal,u=void 0!==l&&l,d=e.showErd,p=void 0===d||d,f=e.decimals,g=e.bold,v=void 0!==g&&g;f=null!==(t=f)&&void 0!==t?t:3;var m=Object(i.b)({input:n,denomination:h,decimals:f,showLastNonZeroDecimal:u});return Object(a.jsxs)("span",{"data-testid":"denominateComponent",children:[Object(a.jsx)("span",{className:v?"text--strong text--header":"",children:m}),p&&Object(a.jsxs)("span",{className:"symbol",children:["\xa0",s(r)]})]})}},724:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));n(2),n(5);var i=n(9),a=n(8),s=n(204),o=(n(467),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;Object(a.a)(this,e),this.value=void 0,this.type=void 0,this.chainId=void 0,this.receiver=void 0,this.args=void 0,this.multiplier=void 0,this.value=n,this.type=i,this.args=s,this.chainId="1",this.receiver=t,this.multiplier=o}return Object(i.a)(e,[{key:"getData",value:function(){var e=this.type;return""!==this.args&&(e=e+"@"+this.args),e}},{key:"getPayload",value:function(){var e=this.type;""!==this.args&&(e=e+"@"+this.args);var t=new s.ContractFunction(e);return s.TransactionPayload.contractCall().setFunction(t).build()}}]),e}())}).call(this,n(21).Buffer)},734:function(e){e.exports=JSON.parse('[{"x":0,"y":0,"z":0},{"x":1,"y":0,"z":-1},{"x":2,"y":0,"z":-2},{"x":3,"y":0,"z":-3},{"x":4,"y":0,"z":-4},{"x":5,"y":0,"z":-5},{"x":6,"y":0,"z":-6},{"x":-1,"y":1,"z":0},{"x":0,"y":1,"z":-1,"noGo":true},{"x":1,"y":1,"z":-2},{"x":2,"y":1,"z":-3,"noGo":true},{"x":3,"y":1,"z":-4},{"x":4,"y":1,"z":-5},{"x":5,"y":1,"z":-6},{"x":6,"y":1,"z":-7},{"x":-1,"y":2,"z":-1},{"x":0,"y":2,"z":-2},{"x":1,"y":2,"z":-3},{"x":2,"y":2,"z":-4},{"x":3,"y":2,"z":-5},{"x":4,"y":2,"z":-6},{"x":5,"y":2,"z":-7,"noGo":true},{"x":-2,"y":3,"z":-1},{"x":-1,"y":3,"z":-2},{"x":0,"y":3,"z":-3},{"x":1,"y":3,"z":-4},{"x":2,"y":3,"z":-5,"base":0},{"x":3,"y":3,"z":-6},{"x":4,"y":3,"z":-7},{"x":5,"y":3,"z":-8},{"x":-2,"y":4,"z":-2},{"x":-1,"y":4,"z":-3},{"x":0,"y":4,"z":-4},{"x":1,"y":4,"z":-5},{"x":2,"y":4,"z":-6},{"x":3,"y":4,"z":-7},{"x":4,"y":4,"z":-8},{"x":-3,"y":5,"z":-2},{"x":-2,"y":5,"z":-3},{"x":-1,"y":5,"z":-4,"base":1},{"x":0,"y":5,"z":-5},{"x":1,"y":5,"z":-6},{"x":2,"y":5,"z":-7},{"x":3,"y":5,"z":-8},{"x":4,"y":5,"z":-9},{"x":-3,"y":6,"z":-3},{"x":-2,"y":6,"z":-4},{"x":-1,"y":6,"z":-5},{"x":0,"y":6,"z":-6},{"x":1,"y":6,"z":-7},{"x":2,"y":6,"z":-8,"base":2},{"x":3,"y":6,"z":-9}]')},786:function(e,t,n){},847:function(e,t){},849:function(e,t){},905:function(e,t){},956:function(e,t){},981:function(e,t){}},[[1115,1,2]]]);