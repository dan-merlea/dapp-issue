{"ast":null,"code":"import _classCallCheck from \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport { Maths } from '@krogan/common';\nimport { Texture } from '@pixi/core';\nimport { TilingSprite } from '@pixi/sprite-tiling';\nimport { getCacheSheet } from 'images/textures';\nimport { AnimatedSprite, MIPMAP_MODES } from 'pixi.js';\nvar BeamSprite = /*#__PURE__*/function (_TilingSprite) {\n  _inherits(BeamSprite, _TilingSprite);\n  var _super = _createSuper(BeamSprite);\n  // Allow animate() to skip some frames\n\n  function BeamSprite(angle, asteroid, startPosition) {\n    var _this;\n    _classCallCheck(this, BeamSprite);\n    var texture = Texture.from('laser-beam');\n    texture.baseTexture.mipmap = MIPMAP_MODES.POW2;\n    _this = _super.call(this, texture, 1, 5);\n    _this.asteroid = void 0;\n    _this.toWidth = 1;\n    _this.defaultHeight = void 0;\n    _this.slowDownAnimation = 1;\n    _this.currentFrame = 0;\n    _this.sparks = void 0;\n    var distance = Maths.getDistance(startPosition.x, startPosition.y, asteroid.position.x, asteroid.position.y);\n    _this.toWidth = distance - 10; // 10 is a buffer to show animation closer to the edge\n    _this.defaultHeight = 5;\n    _this.angle = angle;\n    _this.anchor.set(0, 0.5);\n    _this.asteroid = asteroid;\n    return _this;\n  }\n  _createClass(BeamSprite, [{\n    key: \"animate\",\n    value: function animate() {\n      this.currentFrame++;\n      if (this.currentFrame != this.slowDownAnimation) return;\n      if (this.scale.y == 1) {\n        this.scale.y = 1.4;\n        this.tint = 0xFEFEFE;\n      } else {\n        this.tint = 0xFFFFFF;\n        this.scale.y = 1;\n      }\n      if (this.width < this.toWidth) {\n        this.width += 20;\n      }\n      if (this.width > this.toWidth) {\n        this.width = this.toWidth;\n        this.attachSparks();\n      }\n      this.currentFrame = 0;\n    }\n  }, {\n    key: \"attachSparks\",\n    value: function attachSparks() {\n      console.log('Attaching sparks');\n      var sheet = getCacheSheet('beam-sparks');\n      if (!sheet) return;\n      this.sparks = new AnimatedSprite(sheet.animations[\"beam-sparks-sheet\"]);\n      this.sparks.animationSpeed = 0.2;\n      this.sparks.anchor.set(0.5, 0);\n      this.sparks.angle = -90;\n      this.sparks.x = this.width - this.sparks.height;\n      this.addChild(this.sparks);\n      this.sparks.play();\n    }\n  }]);\n  return BeamSprite;\n}(TilingSprite);\nexport { BeamSprite as default };","map":{"version":3,"names":["Maths","Texture","TilingSprite","getCacheSheet","AnimatedSprite","MIPMAP_MODES","BeamSprite","angle","asteroid","startPosition","texture","from","baseTexture","mipmap","POW2","toWidth","defaultHeight","slowDownAnimation","currentFrame","sparks","distance","getDistance","x","y","position","anchor","set","scale","tint","width","attachSparks","console","log","sheet","animations","animationSpeed","height","addChild","play"],"sources":["/Users/merlea/Development/Crypto/Krogan/kroganverse-com/packages/client/src/sprites/game/BeamSprite.ts"],"sourcesContent":["\nimport { Maths } from '@krogan/common'\nimport { Texture } from '@pixi/core'\nimport { TilingSprite } from '@pixi/sprite-tiling'\nimport { getCacheSheet } from 'images/textures'\nimport { AnimatedSprite, MIPMAP_MODES } from 'pixi.js'\nimport { Asteroid } from 'state/Asteroid'\nimport { Position } from 'state/Position'\n\nexport default class BeamSprite extends TilingSprite {\n\n\tpublic readonly asteroid: Asteroid\n\n\tprivate toWidth: number = 1\n\tprivate defaultHeight: number\n\t\n\t// Allow animate() to skip some frames\n\tprivate slowDownAnimation = 1\n\tprivate currentFrame = 0\n\n\tprivate sparks?: AnimatedSprite\n\n    constructor(angle: number, asteroid: Asteroid, startPosition: Position) {\n        const texture = Texture.from('laser-beam')\n\t\ttexture.baseTexture.mipmap = MIPMAP_MODES.POW2\n        super(texture, 1, 5)\n\n\t\tconst distance = Maths.getDistance(\n\t\t\tstartPosition.x, startPosition.y, \n\t\t\tasteroid.position.x, asteroid.position.y\n\t\t)\n\t\tthis.toWidth = distance - 10 // 10 is a buffer to show animation closer to the edge\n\t\tthis.defaultHeight = 5\n\t\tthis.angle = angle\n\t\tthis.anchor.set(0, 0.5)\n\t\tthis.asteroid = asteroid\n    }\n\n\tanimate() {\n\t\tthis.currentFrame++\n\t\tif (this.currentFrame != this.slowDownAnimation) return\n\n\t\tif (this.scale.y == 1) {\n\t\t\tthis.scale.y = 1.4\n\t\t\tthis.tint = 0xFEFEFE\n\t\t} else {\n\t\t\tthis.tint = 0xFFFFFF\n\t\t\tthis.scale.y = 1\n\t\t}\n\n\t\tif (this.width < this.toWidth) {\n\t\t\tthis.width += 20\n\t\t} \n\t\tif (this.width > this.toWidth) {\n\t\t\tthis.width = this.toWidth\n\t\t\tthis.attachSparks()\n\t\t}\n\n\t\tthis.currentFrame = 0\n\t}\n\n\tattachSparks() {\n\t\tconsole.log('Attaching sparks')\n\t\tconst sheet = getCacheSheet('beam-sparks')\n\t\tif (!sheet) return\n\n\t\tthis.sparks = new AnimatedSprite(sheet.animations[\"beam-sparks-sheet\"])\n\t\tthis.sparks.animationSpeed = 0.2\n\t\tthis.sparks.anchor.set(0.5, 0)\n\t\tthis.sparks.angle = -90\n\t\tthis.sparks.x = this.width - this.sparks.height\n\t\tthis.addChild(this.sparks)\n\n\t\tthis.sparks.play()\n\t}\n\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}