{"ast":null,"code":"import _slicedToArray from \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nvar _jsxFileName = \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/packages/client/src/gui/hud/HUD.tsx\",\n  _this = this,\n  _s = $RefreshSig$();\nimport { Menu } from '.';\nimport { Keys } from '@krogan/common';\nimport React from 'react';\nimport { Announce } from './Announce';\nimport { View } from 'gui/uielements';\nimport { isMobile } from 'react-device-detect';\nimport { Controls } from './Controls';\nimport { TileDetails } from './TileDetails';\nimport { SpaceshipDetails } from './SpaceshipDetails';\nimport { useRoomContext } from 'context/room';\nimport { PointDetails } from './PointDetails';\nimport { AsteroidDetails } from './AsteroidDetails';\nimport { SpaceshipPanels } from './SpaceshipPanels';\nimport { SpaceshipCargo } from './SpaceshipCargo';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar HUD_PADDING = isMobile ? 16 : 24;\n\n/**\n * The interface displaying important information to the user\n */\nexport var HUD = /*#__PURE__*/React.memo(_c = _s(function (props) {\n  _s();\n  var _useRoomContext = useRoomContext(),\n    hud = _useRoomContext.hud,\n    gameRoom = _useRoomContext.gameRoom;\n  var eventHandler = props.eventHandler;\n  var _React$useState = React.useState(false),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    showMenu = _React$useState2[0],\n    setShowMenu = _React$useState2[1];\n  var _React$useState3 = React.useState(false),\n    _React$useState4 = _slicedToArray(_React$useState3, 2),\n    showCargo = _React$useState4[0],\n    setShowCargo = _React$useState4[1];\n  var handleLeave = function handleLeave() {\n    window.location.href = window.location.origin;\n  };\n  var handleKeyDown = function handleKeyDown(event) {\n    var key = event.code;\n    if (Keys.MENU.includes(key)) {\n      event.preventDefault();\n      event.stopPropagation();\n      // setMenuOpened((prev) => !prev)\n      eventHandler.send('closePopup');\n    }\n  };\n  var handleKeyUp = function handleKeyUp(event) {\n    var key = event.code;\n  };\n  React.useEffect(function () {\n    // Listen for key presses (and unlisten on unmount).\n    window.document.addEventListener('keydown', handleKeyDown);\n    window.document.addEventListener('keyup', handleKeyUp);\n    return function () {\n      window.document.removeEventListener('keydown', handleKeyDown);\n      window.document.removeEventListener('keyup', handleKeyUp);\n    };\n  }, []);\n  React.useEffect(function () {\n    if (hud.controlledSpaceship) {\n      console.log('[Mining][Setup][HUD]');\n      hud.controlledSpaceship.spaceship.listen('mining', function () {\n        var _hud$controlledSpaces;\n        setShowCargo(((_hud$controlledSpaces = hud.controlledSpaceship) === null || _hud$controlledSpaces === void 0 ? void 0 : _hud$controlledSpaces.spaceship.mining) != undefined);\n      });\n    }\n  }, [hud.controlledSpaceship]);\n  return /*#__PURE__*/_jsxDEV(View, {\n    flex: true,\n    center: true,\n    style: styles.hud,\n    children: [/*#__PURE__*/_jsxDEV(Announce, {\n      announce: hud.announce,\n      style: styles.announce\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 17\n    }, _this), /*#__PURE__*/_jsxDEV(Controls, {\n      style: styles.controls,\n      mapButton: gameRoom != undefined,\n      backButton: hud.backButtonVisible,\n      eventHandler: eventHandler\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 17\n    }, _this), hud.controlledSpaceship && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(SpaceshipPanels, {\n        style: styles.panels,\n        spaceship: hud.controlledSpaceship.spaceship\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }, _this), showCargo && /*#__PURE__*/_jsxDEV(SpaceshipCargo, {\n        style: styles.cargo,\n        spaceship: hud.controlledSpaceship.spaceship\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 25\n      }, _this)]\n    }, void 0, true), showMenu ? /*#__PURE__*/_jsxDEV(Menu, {\n      onClose: function onClose() {\n        return setShowMenu(false);\n      },\n      onLeave: handleLeave\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 29\n    }, _this) : null, hud.selectedTile && /*#__PURE__*/_jsxDEV(TileDetails, {\n      eventHandler: eventHandler,\n      tile: hud.selectedTile\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 38\n    }, _this), hud.selectedSpaceship && /*#__PURE__*/_jsxDEV(SpaceshipDetails, {\n      eventHandler: eventHandler,\n      spaceship: hud.selectedSpaceship.spaceship\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 43\n    }, _this), hud.selectedPoint && /*#__PURE__*/_jsxDEV(PointDetails, {\n      point: hud.selectedPoint,\n      eventHandler: eventHandler\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 39\n    }, _this), hud.selectedAsteroid && /*#__PURE__*/_jsxDEV(AsteroidDetails, {\n      asteroid: hud.selectedAsteroid,\n      eventHandler: eventHandler\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 42\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 13\n  }, _this);\n}, \"1addziXl8YAc7d2D/qM4Y1zZbxQ=\", false, function () {\n  return [useRoomContext];\n}));\n_c2 = HUD;\nvar styles = {\n  hud: {},\n  controls: {\n    position: 'absolute',\n    right: HUD_PADDING,\n    bottom: HUD_PADDING\n  },\n  panels: {\n    position: 'absolute',\n    left: HUD_PADDING,\n    bottom: HUD_PADDING\n  },\n  cargo: {\n    position: 'absolute',\n    left: HUD_PADDING,\n    top: HUD_PADDING\n  },\n  players: {\n    position: 'absolute',\n    right: HUD_PADDING,\n    top: HUD_PADDING\n  },\n  messages: {\n    position: 'absolute',\n    left: HUD_PADDING,\n    bottom: HUD_PADDING\n  },\n  announce: {\n    position: 'absolute'\n  }\n};\nvar _c, _c2;\n$RefreshReg$(_c, \"HUD$React.memo\");\n$RefreshReg$(_c2, \"HUD\");","map":{"version":3,"names":["Menu","Keys","React","Announce","View","isMobile","Controls","TileDetails","SpaceshipDetails","useRoomContext","PointDetails","AsteroidDetails","SpaceshipPanels","SpaceshipCargo","HUD_PADDING","HUD","memo","props","hud","gameRoom","eventHandler","useState","showMenu","setShowMenu","showCargo","setShowCargo","handleLeave","window","location","href","origin","handleKeyDown","event","key","code","MENU","includes","preventDefault","stopPropagation","send","handleKeyUp","useEffect","document","addEventListener","removeEventListener","controlledSpaceship","console","log","spaceship","listen","mining","undefined","styles","announce","controls","backButtonVisible","panels","cargo","selectedTile","selectedSpaceship","selectedPoint","selectedAsteroid","position","right","bottom","left","top","players","messages"],"sources":["/Users/merlea/Development/Crypto/Krogan/kroganverse-com/packages/client/src/gui/hud/HUD.tsx"],"sourcesContent":["import { Menu, Players } from '.';\nimport { EventHandler, Keys } from '@krogan/common';\nimport React, { CSSProperties } from 'react';\nimport { Announce } from './Announce';\nimport { View } from 'gui/uielements';\nimport { isMobile } from 'react-device-detect';\nimport { Controls } from './Controls';\nimport { TileDetails } from './TileDetails';\nimport { SpaceshipDetails } from './SpaceshipDetails';\nimport { useRoomContext, useRoomDispatch } from 'context/room';\nimport { PointDetails } from './PointDetails';\nimport { AsteroidDetails } from './AsteroidDetails';\nimport { SpaceshipPanels } from './SpaceshipPanels';\nimport { SpaceshipCargo } from './SpaceshipCargo';\n\nconst HUD_PADDING = isMobile ? 16 : 24;\n\n/**\n * The interface displaying important information to the user\n */\nexport const HUD = React.memo(\n    (props: {\n        eventHandler: EventHandler;\n    }): React.ReactElement => {\n        \n        const { hud, gameRoom } = useRoomContext()\n        const { eventHandler } = props\n\n        const [showMenu, setShowMenu] = React.useState(false)\n        const [showCargo, setShowCargo] = React.useState(false)\n\n        const handleLeave = () => {\n            window.location.href = window.location.origin\n        };\n\n        const handleKeyDown = (event: any) => {\n            const key = event.code;\n            \n            if (Keys.MENU.includes(key)) {\n                event.preventDefault()\n                event.stopPropagation()\n                // setMenuOpened((prev) => !prev)\n                eventHandler.send('closePopup')\n            }\n        }\n\n        const handleKeyUp = (event: any) => {\n            const key = event.code;\n        }\n\n        React.useEffect(() => {\n            // Listen for key presses (and unlisten on unmount).\n            window.document.addEventListener('keydown', handleKeyDown)\n            window.document.addEventListener('keyup', handleKeyUp)\n\n            return () => {\n                window.document.removeEventListener('keydown', handleKeyDown)\n                window.document.removeEventListener('keyup', handleKeyUp)\n            };\n        }, [])\n\n        React.useEffect(() => {            \n            if (hud.controlledSpaceship) {\n                console.log('[Mining][Setup][HUD]')\n                hud.controlledSpaceship.spaceship.listen('mining', () => {\n                    setShowCargo(hud.controlledSpaceship?.spaceship.mining != undefined)\n                })\n            }\n        }, [hud.controlledSpaceship])\n\n        return (\n            <View flex center style={styles.hud}>\n\n                {/* Players */}\n                {/* <Players\n                    count={hud.stats?.playersCount ?? 0}\n                    style={styles.players}\n                    onMenuClicked={() => setMenuOpened(true)}\n                /> */}\n\n                {/* Messages */}\n                {/* {isMobile ? null : <Messages messages={messages} style={styles.messages} />} */}\n\n                {/* Announce */}\n                <Announce announce={hud.announce} style={styles.announce} />\n\n                {/* Controls */}\n                <Controls \n                    style={styles.controls}\n                    mapButton={gameRoom != undefined}\n                    backButton={hud.backButtonVisible}\n                    eventHandler={eventHandler} \n                />\n\n                {hud.controlledSpaceship &&\n                <>\n                    <SpaceshipPanels \n                        style={styles.panels}\n                        spaceship={hud.controlledSpaceship.spaceship}\n                    />\n                    {showCargo &&\n                        <SpaceshipCargo\n                            style={styles.cargo}\n                            spaceship={hud.controlledSpaceship.spaceship}\n                        />\n                    }\n                </>\n                }\n\n                {/* Menu */}\n                {showMenu ? <Menu onClose={() => setShowMenu(false)} onLeave={handleLeave} /> : null}\n\n                {/* Tile Details */}\n                {hud.selectedTile && <TileDetails eventHandler={eventHandler} tile={hud.selectedTile}/>}\n\n                {/* Spaceship Details */}\n                {hud.selectedSpaceship && <SpaceshipDetails eventHandler={eventHandler} spaceship={hud.selectedSpaceship.spaceship} />}\n\n                {/* Point Details */}\n                {hud.selectedPoint && <PointDetails point={hud.selectedPoint} eventHandler={eventHandler} />}\n\n                {/* Asteroid Details */}\n                {hud.selectedAsteroid && <AsteroidDetails asteroid={hud.selectedAsteroid} eventHandler={eventHandler} />}\n\n            </View>\n        );\n    },\n);\n\nconst styles: { [key: string]: CSSProperties } = {\n    hud: {\n        \n    },\n    controls: {\n        position: 'absolute',\n        right: HUD_PADDING,\n        bottom: HUD_PADDING,\n    },\n    panels: {\n        position: 'absolute',\n        left: HUD_PADDING,\n        bottom: HUD_PADDING,\n    },\n    cargo: {\n        position: 'absolute',\n        left: HUD_PADDING,\n        top: HUD_PADDING,\n    },\n    players: {\n        position: 'absolute',\n        right: HUD_PADDING,\n        top: HUD_PADDING,\n    },\n    messages: {\n        position: 'absolute',\n        left: HUD_PADDING,\n        bottom: HUD_PADDING,\n    },\n    announce: {\n        position: 'absolute',\n    },\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}