{"ast":null,"code":"import _classCallCheck from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _possibleConstructorReturn from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js\";import _assertThisInitialized from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Constants,Models}from'@krogan/common';import{Circle,Container}from'pixi.js';import HexagonSprite from'./HexagonSprite';import{TextSprite}from'..';import SolarSystem,{SolarSystemSize}from'./SolarSystem';import MapSpaceshipSprite from'./MapSpaceshipSprite';import MapStarbaseSprite from'./MapStarbaseSprite';var ExploreTileContainer=/*#__PURE__*/function(_Container){_inherits(ExploreTileContainer,_Container);var _super=_createSuper(ExploreTileContainer);// Sprites\n// Data\n// Positioning\nfunction ExploreTileContainer(radius,tileContainer,eventHandler){var _this;_classCallCheck(this,ExploreTileContainer);_this=_super.call(this);_this._hex=void 0;_this._solarSystem=void 0;_this._spaceships=void 0;_this._starbases=void 0;_this._tileContainer=void 0;_this._hexagon=void 0;_this._eventHandler=void 0;_this._radius=void 0;_this._coordinate=void 0;_this._radius=radius;_this._hex=new HexagonSprite(0,0,radius,Constants.TileColor.DEFAULT,0x000000,0.2);_this._tileContainer=tileContainer;_this._coordinate=tileContainer.coordinate;_this._hexagon=tileContainer.hexagon;_this._eventHandler=eventHandler;_this._spaceships=new Models.ObjectMap();_this._starbases=new Models.ObjectMap();_this.addChild(_this._hex);// TODO: add this on long press ( use a timer and cancel it on pointer up )\n_this._hex.interactive=true;_this._hex.cursor='pointer';_this._hex.hitArea=new Circle(0,0,radius);_this._hex.on('pointerdown',function(e){var point=e.data.getLocalPosition(_assertThisInitialized(_this));eventHandler.send('largeHexClick',{x:point.x/radius,y:point.y/radius});var angle=function angle(cx,cy,ex,ey){console.log(\"x: \".concat(ex,\", y: \").concat(ey));var dy=ey-cy;var dx=ex-cx;var theta=Math.atan2(dy,dx);// range (-PI, PI]\ntheta*=180/Math.PI;// rads to degs, range (-180, 180]\nif(theta<0)theta=360+theta;// range [0, 360)\nreturn theta;};});// Name\nvar nameTextSprite=new TextSprite(_this.coordinate.toString(),14,0.5,0.5);nameTextSprite.y=radius+25;nameTextSprite.zIndex=3;_this.addChild(nameTextSprite);// Events\n_this._tileContainer.onSpaceshipAdd=_this.hexagonAddSpaceship.bind(_assertThisInitialized(_this));_this._tileContainer.onSpaceshipRemove=_this.hexagonRemoveSpaceship.bind(_assertThisInitialized(_this));// Solar system\nif(!_this._hexagon)return _possibleConstructorReturn(_this);console.log(\"Solar system with \".concat(_this._hexagon.planets.length,\" planets\"));_this._solarSystem=new SolarSystem(radius,SolarSystemSize.MEDIUM);_this._solarSystem.addPlanets(_this._hexagon.planets);_this.addChild(_this._solarSystem);// Starbases\nconsole.log(\"Solar system with \".concat(_this._hexagon.spaceships.size,\" starbases\"));_this._hexagon.starbases.forEach(function(starbase){_this.createStarbase(starbase);});// Spaceships\nconsole.log(\"Solar system with \".concat(_this._hexagon.spaceships.size,\" spaceships\"));_this._hexagon.spaceships.forEach(function(spaceship){_this.createSpaceship(spaceship);});return _this;}// LOGIC\n_createClass(ExploreTileContainer,[{key:\"updateItemsScale\",value:function updateItemsScale(zoom){this._spaceships.forEach(function(child){child.scale.x=1/zoom;child.scale.y=1/zoom;});console.log(this._starbases.length());this._starbases.forEach(function(child){child.scale.x=1/zoom;child.scale.y=1/zoom;});}// LISTENERS\n},{key:\"hexagonAddSpaceship\",value:function hexagonAddSpaceship(spaceship){this.createSpaceship(spaceship);}},{key:\"hexagonRemoveSpaceship\",value:function hexagonRemoveSpaceship(spaceship,nonce){var sprite=this._spaceships.get(nonce);if(sprite)this.removeChild(sprite);}},{key:\"hexagonUpdateSpaceship\",value:function hexagonUpdateSpaceship(spaceship,nonce){var sprite=this._spaceships.get(nonce);if(!sprite)return;sprite.position.x=spaceship.position.x;sprite.position.y=spaceship.position.y;sprite.angle=spaceship.position.angle;}// CREATE OBJECTS\n},{key:\"createSpaceship\",value:function createSpaceship(spaceship){var _this2=this;console.log(\"[Explore][Add] Spaceship\");console.log(spaceship);var sprite=new MapSpaceshipSprite(this._hex.width,spaceship,function(spaceship){_this2._eventHandler.send('spaceshipClick',spaceship);});this.addChild(sprite);this._spaceships.add(spaceship.nonce.toString(),sprite);}},{key:\"createStarbase\",value:function createStarbase(starbase){console.log(\"[Explore][Add] Starbase\");var sprite=new MapStarbaseSprite(this._hex.width,starbase,function(starbase){});this.addChild(sprite);this._starbases.add(starbase.nonce.toString(),sprite);}// GETTERS & SETTERS\n},{key:\"hexagon\",get:function get(){return this._hexagon;}},{key:\"coordinate\",get:function get(){return this._coordinate;}},{key:\"sprite\",get:function get(){return this._hex;}}]);return ExploreTileContainer;}(Container);export{ExploreTileContainer as default};","map":null,"metadata":{},"sourceType":"module"}