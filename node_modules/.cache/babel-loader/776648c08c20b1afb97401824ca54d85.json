{"ast":null,"code":"\"use strict\";\n\nvar _toConsumableArray = require(\"/Users/merlea/Development/Crypto/Krogan/dapp-issue/node_modules/@babel/runtime/helpers/toConsumableArray.js\").default;\nvar _createForOfIteratorHelper = require(\"/Users/merlea/Development/Crypto/Krogan/dapp-issue/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\nvar _classCallCheck = require(\"/Users/merlea/Development/Crypto/Krogan/dapp-issue/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"/Users/merlea/Development/Crypto/Krogan/dapp-issue/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function get() {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) {\n    if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  }\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Fields = exports.Field = exports.FieldDefinition = void 0;\nvar errors = __importStar(require(\"../../errors\"));\nvar typeExpressionParser_1 = require(\"./typeExpressionParser\");\nvar FieldDefinition = /*#__PURE__*/function () {\n  function FieldDefinition(name, description, type) {\n    _classCallCheck(this, FieldDefinition);\n    this.name = name;\n    this.description = description;\n    this.type = type;\n  }\n  _createClass(FieldDefinition, null, [{\n    key: \"fromJSON\",\n    value: function fromJSON(json) {\n      var parsedType = new typeExpressionParser_1.TypeExpressionParser().parse(json.type);\n      return new FieldDefinition(json.name, json.description, parsedType);\n    }\n  }]);\n  return FieldDefinition;\n}();\nexports.FieldDefinition = FieldDefinition;\nvar Field = /*#__PURE__*/function () {\n  function Field(value) {\n    var name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n    _classCallCheck(this, Field);\n    this.value = value;\n    this.name = name;\n  }\n  _createClass(Field, [{\n    key: \"checkTyping\",\n    value: function checkTyping(expectedDefinition) {\n      var actualType = this.value.getType();\n      if (!actualType.equals(expectedDefinition.type)) {\n        throw new errors.ErrTypingSystem(\"check type of field \\\"\".concat(expectedDefinition.name, \"; expected: \").concat(expectedDefinition.type, \", actual: \").concat(actualType, \"\\\"\"));\n      }\n      if (this.name != expectedDefinition.name) {\n        throw new errors.ErrTypingSystem(\"check name of field \\\"\".concat(expectedDefinition.name, \"\\\"\"));\n      }\n    }\n  }, {\n    key: \"equals\",\n    value: function equals(other) {\n      return this.name == other.name && this.value.equals(other.value);\n    }\n  }]);\n  return Field;\n}();\nexports.Field = Field;\nvar Fields = /*#__PURE__*/function () {\n  function Fields() {\n    _classCallCheck(this, Fields);\n  }\n  _createClass(Fields, null, [{\n    key: \"checkTyping\",\n    value: function checkTyping(fields, definitions) {\n      if (fields.length != definitions.length) {\n        throw new errors.ErrTypingSystem(\"fields length vs. field definitions length\");\n      }\n      for (var i = 0; i < fields.length; i++) {\n        var field = fields[i];\n        var definition = definitions[i];\n        field.checkTyping(definition);\n      }\n    }\n  }, {\n    key: \"equals\",\n    value: function equals(actual, expected) {\n      if (actual.length != expected.length) {\n        return false;\n      }\n      for (var i = 0; i < actual.length; i++) {\n        var selfField = actual[i];\n        var otherField = expected[i];\n        if (!selfField.equals(otherField)) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }, {\n    key: \"getNamesOfTypeDependencies\",\n    value: function getNamesOfTypeDependencies(definitions) {\n      var dependencies = [];\n      var _iterator = _createForOfIteratorHelper(definitions),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var definition = _step.value;\n          dependencies.push(definition.type.getName());\n          dependencies.push.apply(dependencies, _toConsumableArray(definition.type.getNamesOfDependencies()));\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      return _toConsumableArray(new Set(dependencies));\n    }\n  }]);\n  return Fields;\n}();\nexports.Fields = Fields;","map":{"version":3,"mappings":"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","names":["FieldDefinition","name","description","type","json","parsedType","typeExpressionParser_1","parse","exports","Field","value","expectedDefinition","actualType","getType","equals","errors","ErrTypingSystem","other","Fields","fields","definitions","length","i","field","definition","checkTyping","actual","expected","selfField","otherField","dependencies","push","getName","getNamesOfDependencies","Set"],"sourceRoot":"","sources":["../../../src/smartcontracts/typesystem/fields.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}