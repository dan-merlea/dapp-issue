{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"/Users/merlea/Development/Crypto/Krogan/dapp-issue/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"/Users/merlea/Development/Crypto/Krogan/dapp-issue/node_modules/@babel/runtime/helpers/createClass.js\").default;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TokenTransferProperties = exports.TransactionMetadataTransfer = exports.TransactionMetadata = exports.TransactionToDecode = exports.TransactionDecoder = void 0;\nvar bech32_1 = require(\"bech32\");\nvar TransactionDecoder = /*#__PURE__*/function () {\n  function TransactionDecoder() {\n    _classCallCheck(this, TransactionDecoder);\n  }\n  _createClass(TransactionDecoder, [{\n    key: \"getTransactionMetadata\",\n    value: function getTransactionMetadata(transaction) {\n      var metadata = this.getNormalTransactionMetadata(transaction);\n      var esdtMetadata = this.getEsdtTransactionMetadata(metadata);\n      if (esdtMetadata) {\n        return esdtMetadata;\n      }\n      var nftMetadata = this.getNftTransferMetadata(metadata);\n      if (nftMetadata) {\n        return nftMetadata;\n      }\n      var multiMetadata = this.getMultiTransferMetadata(metadata);\n      if (multiMetadata) {\n        return multiMetadata;\n      }\n      return metadata;\n    }\n  }, {\n    key: \"getNormalTransactionMetadata\",\n    value: function getNormalTransactionMetadata(transaction) {\n      var _this = this;\n      var metadata = new TransactionMetadata();\n      metadata.sender = transaction.sender;\n      metadata.receiver = transaction.receiver;\n      metadata.value = BigInt(transaction.value);\n      if (transaction.data) {\n        var decodedData = this.base64Decode(transaction.data);\n        var dataComponents = decodedData.split('@');\n        var args = dataComponents.slice(1);\n        if (args.every(function (x) {\n          return _this.isSmartContractArgument(x);\n        })) {\n          metadata.functionName = dataComponents[0];\n          metadata.functionArgs = args;\n        }\n        if (metadata.functionName === 'relayedTx' && metadata.functionArgs.length === 1) {\n          try {\n            var relayedTransaction = JSON.parse(this.hexToString(metadata.functionArgs[0]));\n            relayedTransaction.value = relayedTransaction.value.toString();\n            relayedTransaction.sender = this.bech32Encode(this.base64ToHex(relayedTransaction.sender));\n            relayedTransaction.receiver = this.bech32Encode(this.base64ToHex(relayedTransaction.receiver));\n            return this.getNormalTransactionMetadata(relayedTransaction);\n          } catch (error) {\n            // nothing special\n          }\n        }\n        if (metadata.functionName === 'relayedTxV2' && metadata.functionArgs.length === 4) {\n          try {\n            var _relayedTransaction = new TransactionToDecode();\n            _relayedTransaction.sender = transaction.receiver;\n            _relayedTransaction.receiver = this.bech32Encode(metadata.functionArgs[0]);\n            _relayedTransaction.data = this.base64Encode(this.hexToString(metadata.functionArgs[2]));\n            _relayedTransaction.value = '0';\n            return this.getNormalTransactionMetadata(_relayedTransaction);\n          } catch (error) {\n            // nothing special\n          }\n        }\n      }\n      try {\n        if (transaction.type === \"SmartContractResult\") {\n          if (metadata.functionName === 'MultiESDTNFTTransfer' && metadata.functionArgs.length > 0 && this.bech32Encode(metadata.functionArgs[0]) === metadata.receiver) {\n            metadata.receiver = metadata.sender;\n          }\n          if (metadata.functionName === 'ESDTNFTTransfer' && metadata.functionArgs.length > 3 && this.bech32Encode(metadata.functionArgs[3]) === metadata.receiver) {\n            metadata.receiver = metadata.sender;\n          }\n        }\n      } catch (error) {\n        // nothing special\n      }\n      return metadata;\n    }\n  }, {\n    key: \"getMultiTransferMetadata\",\n    value: function getMultiTransferMetadata(metadata) {\n      if (metadata.sender !== metadata.receiver) {\n        return undefined;\n      }\n      if (metadata.functionName !== 'MultiESDTNFTTransfer') {\n        return undefined;\n      }\n      var args = metadata.functionArgs;\n      if (args.length < 3) {\n        return undefined;\n      }\n      if (!this.isAddressValid(args[0])) {\n        return undefined;\n      }\n      var receiver = this.bech32Encode(args[0]);\n      var transferCount = this.hexToNumber(args[1]);\n      var result = new TransactionMetadata();\n      if (!result.transfers) {\n        result.transfers = [];\n      }\n      var index = 2;\n      for (var i = 0; i < transferCount; i++) {\n        var identifier = this.hexToString(args[index++]);\n        var nonce = args[index++];\n        var value = this.hexToBigInt(args[index++]);\n        if (nonce) {\n          result.transfers.push({\n            value: value,\n            properties: {\n              collection: identifier,\n              identifier: \"\".concat(identifier, \"-\").concat(nonce)\n            }\n          });\n        } else {\n          result.transfers.push({\n            value: value,\n            properties: {\n              token: identifier\n            }\n          });\n        }\n      }\n      result.sender = metadata.sender;\n      result.receiver = receiver;\n      if (args.length > index) {\n        result.functionName = this.hexToString(args[index++]);\n        result.functionArgs = args.slice(index++);\n      }\n      return result;\n    }\n  }, {\n    key: \"getNftTransferMetadata\",\n    value: function getNftTransferMetadata(metadata) {\n      if (metadata.sender !== metadata.receiver) {\n        return undefined;\n      }\n      if (metadata.functionName !== 'ESDTNFTTransfer') {\n        return undefined;\n      }\n      var args = metadata.functionArgs;\n      if (args.length < 4) {\n        return undefined;\n      }\n      if (!this.isAddressValid(args[3])) {\n        return undefined;\n      }\n      var collectionIdentifier = this.hexToString(args[0]);\n      var nonce = args[1];\n      var value = this.hexToBigInt(args[2]);\n      var receiver = this.bech32Encode(args[3]);\n      var result = new TransactionMetadata();\n      result.sender = metadata.sender;\n      result.receiver = receiver;\n      result.value = value;\n      if (args.length > 4) {\n        result.functionName = this.hexToString(args[4]);\n        result.functionArgs = args.slice(5);\n      }\n      result.transfers = [{\n        value: value,\n        properties: {\n          collection: collectionIdentifier,\n          identifier: \"\".concat(collectionIdentifier, \"-\").concat(nonce)\n        }\n      }];\n      return result;\n    }\n  }, {\n    key: \"base64Encode\",\n    value: function base64Encode(str) {\n      return Buffer.from(str).toString('base64');\n    }\n  }, {\n    key: \"base64Decode\",\n    value: function base64Decode(str) {\n      return Buffer.from(str, 'base64').toString('binary');\n    }\n  }, {\n    key: \"hexToNumber\",\n    value: function hexToNumber(hex) {\n      return parseInt(hex, 16);\n    }\n  }, {\n    key: \"getEsdtTransactionMetadata\",\n    value: function getEsdtTransactionMetadata(metadata) {\n      if (metadata.functionName !== 'ESDTTransfer') {\n        return undefined;\n      }\n      var args = metadata.functionArgs;\n      if (args.length < 2) {\n        return undefined;\n      }\n      var tokenIdentifier = this.hexToString(args[0]);\n      var value = this.hexToBigInt(args[1]);\n      var result = new TransactionMetadata();\n      result.sender = metadata.sender;\n      result.receiver = metadata.receiver;\n      if (args.length > 2) {\n        result.functionName = this.hexToString(args[2]);\n        result.functionArgs = args.slice(3);\n      }\n      result.transfers = [{\n        value: value,\n        properties: {\n          identifier: tokenIdentifier\n        }\n      }];\n      result.value = metadata.value;\n      return result;\n    }\n  }, {\n    key: \"bech32Encode\",\n    value: function bech32Encode(address) {\n      var pubKey = Buffer.from(address, \"hex\");\n      var words = bech32_1.bech32.toWords(pubKey);\n      return bech32_1.bech32.encode('erd', words);\n    }\n  }, {\n    key: \"isAddressValid\",\n    value: function isAddressValid(address) {\n      return Buffer.from(address, \"hex\").length == 32;\n    }\n  }, {\n    key: \"isSmartContractArgument\",\n    value: function isSmartContractArgument(arg) {\n      if (!this.isHex(arg)) {\n        return false;\n      }\n      if (arg.length % 2 !== 0) {\n        return false;\n      }\n      return true;\n    }\n  }, {\n    key: \"isHex\",\n    value: function isHex(value) {\n      return new RegExp(/[^a-f0-9]/gi).test(value) === false;\n    }\n  }, {\n    key: \"base64ToHex\",\n    value: function base64ToHex(str) {\n      return Buffer.from(str, 'base64').toString('hex');\n    }\n  }, {\n    key: \"hexToString\",\n    value: function hexToString(hex) {\n      return Buffer.from(hex, 'hex').toString('ascii');\n    }\n  }, {\n    key: \"hexToBigInt\",\n    value: function hexToBigInt(hex) {\n      if (!hex) {\n        return BigInt(0);\n      }\n      return BigInt('0x' + hex);\n    }\n  }]);\n  return TransactionDecoder;\n}();\nexports.TransactionDecoder = TransactionDecoder;\nvar TransactionToDecode = /*#__PURE__*/_createClass(function TransactionToDecode() {\n  _classCallCheck(this, TransactionToDecode);\n  this.sender = '';\n  this.receiver = '';\n  this.data = '';\n  this.value = '0';\n  this.type = '';\n});\nexports.TransactionToDecode = TransactionToDecode;\nvar TransactionMetadata = /*#__PURE__*/_createClass(function TransactionMetadata() {\n  _classCallCheck(this, TransactionMetadata);\n  this.sender = '';\n  this.receiver = '';\n  this.value = BigInt(0);\n  this.functionArgs = [];\n});\nexports.TransactionMetadata = TransactionMetadata;\nvar TransactionMetadataTransfer = /*#__PURE__*/_createClass(function TransactionMetadataTransfer() {\n  _classCallCheck(this, TransactionMetadataTransfer);\n  this.value = BigInt(0);\n});\nexports.TransactionMetadataTransfer = TransactionMetadataTransfer;\nvar TokenTransferProperties = /*#__PURE__*/_createClass(function TokenTransferProperties() {\n  _classCallCheck(this, TokenTransferProperties);\n});\nexports.TokenTransferProperties = TokenTransferProperties;","map":{"version":3,"names":["Object","defineProperty","exports","value","TokenTransferProperties","TransactionMetadataTransfer","TransactionMetadata","TransactionToDecode","TransactionDecoder","bech32_1","require","transaction","metadata","getNormalTransactionMetadata","esdtMetadata","getEsdtTransactionMetadata","nftMetadata","getNftTransferMetadata","multiMetadata","getMultiTransferMetadata","sender","receiver","BigInt","data","decodedData","base64Decode","dataComponents","split","args","slice","every","x","isSmartContractArgument","functionName","functionArgs","length","relayedTransaction","JSON","parse","hexToString","toString","bech32Encode","base64ToHex","error","base64Encode","type","undefined","isAddressValid","transferCount","hexToNumber","result","transfers","index","i","identifier","nonce","hexToBigInt","push","properties","collection","token","collectionIdentifier","str","Buffer","from","hex","parseInt","tokenIdentifier","address","pubKey","words","bech32","toWords","encode","arg","isHex","RegExp","test"],"sources":["/Users/merlea/Development/Crypto/Krogan/dapp-issue/node_modules/@elrondnetwork/transaction-decoder/lib/transaction.decoder.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TokenTransferProperties = exports.TransactionMetadataTransfer = exports.TransactionMetadata = exports.TransactionToDecode = exports.TransactionDecoder = void 0;\nconst bech32_1 = require(\"bech32\");\nclass TransactionDecoder {\n    getTransactionMetadata(transaction) {\n        const metadata = this.getNormalTransactionMetadata(transaction);\n        const esdtMetadata = this.getEsdtTransactionMetadata(metadata);\n        if (esdtMetadata) {\n            return esdtMetadata;\n        }\n        const nftMetadata = this.getNftTransferMetadata(metadata);\n        if (nftMetadata) {\n            return nftMetadata;\n        }\n        const multiMetadata = this.getMultiTransferMetadata(metadata);\n        if (multiMetadata) {\n            return multiMetadata;\n        }\n        return metadata;\n    }\n    getNormalTransactionMetadata(transaction) {\n        const metadata = new TransactionMetadata();\n        metadata.sender = transaction.sender;\n        metadata.receiver = transaction.receiver;\n        metadata.value = BigInt(transaction.value);\n        if (transaction.data) {\n            const decodedData = this.base64Decode(transaction.data);\n            const dataComponents = decodedData.split('@');\n            const args = dataComponents.slice(1);\n            if (args.every((x) => this.isSmartContractArgument(x))) {\n                metadata.functionName = dataComponents[0];\n                metadata.functionArgs = args;\n            }\n            if (metadata.functionName === 'relayedTx' && metadata.functionArgs.length === 1) {\n                try {\n                    const relayedTransaction = JSON.parse(this.hexToString(metadata.functionArgs[0]));\n                    relayedTransaction.value = relayedTransaction.value.toString();\n                    relayedTransaction.sender = this.bech32Encode(this.base64ToHex(relayedTransaction.sender));\n                    relayedTransaction.receiver = this.bech32Encode(this.base64ToHex(relayedTransaction.receiver));\n                    return this.getNormalTransactionMetadata(relayedTransaction);\n                }\n                catch (error) {\n                    // nothing special\n                }\n            }\n            if (metadata.functionName === 'relayedTxV2' && metadata.functionArgs.length === 4) {\n                try {\n                    const relayedTransaction = new TransactionToDecode();\n                    relayedTransaction.sender = transaction.receiver;\n                    relayedTransaction.receiver = this.bech32Encode(metadata.functionArgs[0]);\n                    relayedTransaction.data = this.base64Encode(this.hexToString(metadata.functionArgs[2]));\n                    relayedTransaction.value = '0';\n                    return this.getNormalTransactionMetadata(relayedTransaction);\n                }\n                catch (error) {\n                    // nothing special\n                }\n            }\n        }\n        try {\n            if (transaction.type === \"SmartContractResult\") {\n                if (metadata.functionName === 'MultiESDTNFTTransfer' &&\n                    metadata.functionArgs.length > 0 &&\n                    this.bech32Encode(metadata.functionArgs[0]) === metadata.receiver) {\n                    metadata.receiver = metadata.sender;\n                }\n                if (metadata.functionName === 'ESDTNFTTransfer' &&\n                    metadata.functionArgs.length > 3 &&\n                    this.bech32Encode(metadata.functionArgs[3]) === metadata.receiver) {\n                    metadata.receiver = metadata.sender;\n                }\n            }\n        }\n        catch (error) {\n            // nothing special\n        }\n        return metadata;\n    }\n    getMultiTransferMetadata(metadata) {\n        if (metadata.sender !== metadata.receiver) {\n            return undefined;\n        }\n        if (metadata.functionName !== 'MultiESDTNFTTransfer') {\n            return undefined;\n        }\n        const args = metadata.functionArgs;\n        if (args.length < 3) {\n            return undefined;\n        }\n        if (!this.isAddressValid(args[0])) {\n            return undefined;\n        }\n        const receiver = this.bech32Encode(args[0]);\n        const transferCount = this.hexToNumber(args[1]);\n        const result = new TransactionMetadata();\n        if (!result.transfers) {\n            result.transfers = [];\n        }\n        let index = 2;\n        for (let i = 0; i < transferCount; i++) {\n            const identifier = this.hexToString(args[index++]);\n            const nonce = args[index++];\n            const value = this.hexToBigInt(args[index++]);\n            if (nonce) {\n                result.transfers.push({\n                    value,\n                    properties: {\n                        collection: identifier,\n                        identifier: `${identifier}-${nonce}`,\n                    },\n                });\n            }\n            else {\n                result.transfers.push({\n                    value,\n                    properties: {\n                        token: identifier\n                    },\n                });\n            }\n        }\n        result.sender = metadata.sender;\n        result.receiver = receiver;\n        if (args.length > index) {\n            result.functionName = this.hexToString(args[index++]);\n            result.functionArgs = args.slice(index++);\n        }\n        return result;\n    }\n    getNftTransferMetadata(metadata) {\n        if (metadata.sender !== metadata.receiver) {\n            return undefined;\n        }\n        if (metadata.functionName !== 'ESDTNFTTransfer') {\n            return undefined;\n        }\n        const args = metadata.functionArgs;\n        if (args.length < 4) {\n            return undefined;\n        }\n        if (!this.isAddressValid(args[3])) {\n            return undefined;\n        }\n        const collectionIdentifier = this.hexToString(args[0]);\n        const nonce = args[1];\n        const value = this.hexToBigInt(args[2]);\n        const receiver = this.bech32Encode(args[3]);\n        const result = new TransactionMetadata();\n        result.sender = metadata.sender;\n        result.receiver = receiver;\n        result.value = value;\n        if (args.length > 4) {\n            result.functionName = this.hexToString(args[4]);\n            result.functionArgs = args.slice(5);\n        }\n        result.transfers = [{\n                value,\n                properties: {\n                    collection: collectionIdentifier,\n                    identifier: `${collectionIdentifier}-${nonce}`\n                },\n            }];\n        return result;\n    }\n    base64Encode(str) {\n        return Buffer.from(str).toString('base64');\n    }\n    base64Decode(str) {\n        return Buffer.from(str, 'base64').toString('binary');\n    }\n    hexToNumber(hex) {\n        return parseInt(hex, 16);\n    }\n    getEsdtTransactionMetadata(metadata) {\n        if (metadata.functionName !== 'ESDTTransfer') {\n            return undefined;\n        }\n        const args = metadata.functionArgs;\n        if (args.length < 2) {\n            return undefined;\n        }\n        const tokenIdentifier = this.hexToString(args[0]);\n        const value = this.hexToBigInt(args[1]);\n        const result = new TransactionMetadata();\n        result.sender = metadata.sender;\n        result.receiver = metadata.receiver;\n        if (args.length > 2) {\n            result.functionName = this.hexToString(args[2]);\n            result.functionArgs = args.slice(3);\n        }\n        result.transfers = [{\n                value,\n                properties: {\n                    identifier: tokenIdentifier\n                },\n            }];\n        result.value = metadata.value;\n        return result;\n    }\n    bech32Encode(address) {\n        const pubKey = Buffer.from(address, \"hex\");\n        let words = bech32_1.bech32.toWords(pubKey);\n        return bech32_1.bech32.encode('erd', words);\n    }\n    isAddressValid(address) {\n        return Buffer.from(address, \"hex\").length == 32;\n    }\n    isSmartContractArgument(arg) {\n        if (!this.isHex(arg)) {\n            return false;\n        }\n        if (arg.length % 2 !== 0) {\n            return false;\n        }\n        return true;\n    }\n    isHex(value) {\n        return new RegExp(/[^a-f0-9]/gi).test(value) === false;\n    }\n    base64ToHex(str) {\n        return Buffer.from(str, 'base64').toString('hex');\n    }\n    hexToString(hex) {\n        return Buffer.from(hex, 'hex').toString('ascii');\n    }\n    hexToBigInt(hex) {\n        if (!hex) {\n            return BigInt(0);\n        }\n        return BigInt('0x' + hex);\n    }\n}\nexports.TransactionDecoder = TransactionDecoder;\nclass TransactionToDecode {\n    constructor() {\n        this.sender = '';\n        this.receiver = '';\n        this.data = '';\n        this.value = '0';\n        this.type = '';\n    }\n}\nexports.TransactionToDecode = TransactionToDecode;\nclass TransactionMetadata {\n    constructor() {\n        this.sender = '';\n        this.receiver = '';\n        this.value = BigInt(0);\n        this.functionArgs = [];\n    }\n}\nexports.TransactionMetadata = TransactionMetadata;\nclass TransactionMetadataTransfer {\n    constructor() {\n        this.value = BigInt(0);\n    }\n}\nexports.TransactionMetadataTransfer = TransactionMetadataTransfer;\nclass TokenTransferProperties {\n}\nexports.TokenTransferProperties = TokenTransferProperties;\n"],"mappings":"AAAA,YAAY;;AAAC;AAAA;AACbA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,uBAAuB,GAAGF,OAAO,CAACG,2BAA2B,GAAGH,OAAO,CAACI,mBAAmB,GAAGJ,OAAO,CAACK,mBAAmB,GAAGL,OAAO,CAACM,kBAAkB,GAAG,KAAK,CAAC;AACvK,IAAMC,QAAQ,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAAC,IAC7BF,kBAAkB;EAAA;IAAA;EAAA;EAAA;IAAA;IAAA,OACpB,gCAAuBG,WAAW,EAAE;MAChC,IAAMC,QAAQ,GAAG,IAAI,CAACC,4BAA4B,CAACF,WAAW,CAAC;MAC/D,IAAMG,YAAY,GAAG,IAAI,CAACC,0BAA0B,CAACH,QAAQ,CAAC;MAC9D,IAAIE,YAAY,EAAE;QACd,OAAOA,YAAY;MACvB;MACA,IAAME,WAAW,GAAG,IAAI,CAACC,sBAAsB,CAACL,QAAQ,CAAC;MACzD,IAAII,WAAW,EAAE;QACb,OAAOA,WAAW;MACtB;MACA,IAAME,aAAa,GAAG,IAAI,CAACC,wBAAwB,CAACP,QAAQ,CAAC;MAC7D,IAAIM,aAAa,EAAE;QACf,OAAOA,aAAa;MACxB;MACA,OAAON,QAAQ;IACnB;EAAC;IAAA;IAAA,OACD,sCAA6BD,WAAW,EAAE;MAAA;MACtC,IAAMC,QAAQ,GAAG,IAAIN,mBAAmB,EAAE;MAC1CM,QAAQ,CAACQ,MAAM,GAAGT,WAAW,CAACS,MAAM;MACpCR,QAAQ,CAACS,QAAQ,GAAGV,WAAW,CAACU,QAAQ;MACxCT,QAAQ,CAACT,KAAK,GAAGmB,MAAM,CAACX,WAAW,CAACR,KAAK,CAAC;MAC1C,IAAIQ,WAAW,CAACY,IAAI,EAAE;QAClB,IAAMC,WAAW,GAAG,IAAI,CAACC,YAAY,CAACd,WAAW,CAACY,IAAI,CAAC;QACvD,IAAMG,cAAc,GAAGF,WAAW,CAACG,KAAK,CAAC,GAAG,CAAC;QAC7C,IAAMC,IAAI,GAAGF,cAAc,CAACG,KAAK,CAAC,CAAC,CAAC;QACpC,IAAID,IAAI,CAACE,KAAK,CAAC,UAACC,CAAC;UAAA,OAAK,KAAI,CAACC,uBAAuB,CAACD,CAAC,CAAC;QAAA,EAAC,EAAE;UACpDnB,QAAQ,CAACqB,YAAY,GAAGP,cAAc,CAAC,CAAC,CAAC;UACzCd,QAAQ,CAACsB,YAAY,GAAGN,IAAI;QAChC;QACA,IAAIhB,QAAQ,CAACqB,YAAY,KAAK,WAAW,IAAIrB,QAAQ,CAACsB,YAAY,CAACC,MAAM,KAAK,CAAC,EAAE;UAC7E,IAAI;YACA,IAAMC,kBAAkB,GAAGC,IAAI,CAACC,KAAK,CAAC,IAAI,CAACC,WAAW,CAAC3B,QAAQ,CAACsB,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;YACjFE,kBAAkB,CAACjC,KAAK,GAAGiC,kBAAkB,CAACjC,KAAK,CAACqC,QAAQ,EAAE;YAC9DJ,kBAAkB,CAAChB,MAAM,GAAG,IAAI,CAACqB,YAAY,CAAC,IAAI,CAACC,WAAW,CAACN,kBAAkB,CAAChB,MAAM,CAAC,CAAC;YAC1FgB,kBAAkB,CAACf,QAAQ,GAAG,IAAI,CAACoB,YAAY,CAAC,IAAI,CAACC,WAAW,CAACN,kBAAkB,CAACf,QAAQ,CAAC,CAAC;YAC9F,OAAO,IAAI,CAACR,4BAA4B,CAACuB,kBAAkB,CAAC;UAChE,CAAC,CACD,OAAOO,KAAK,EAAE;YACV;UACJ;QACJ;QACA,IAAI/B,QAAQ,CAACqB,YAAY,KAAK,aAAa,IAAIrB,QAAQ,CAACsB,YAAY,CAACC,MAAM,KAAK,CAAC,EAAE;UAC/E,IAAI;YACA,IAAMC,mBAAkB,GAAG,IAAI7B,mBAAmB,EAAE;YACpD6B,mBAAkB,CAAChB,MAAM,GAAGT,WAAW,CAACU,QAAQ;YAChDe,mBAAkB,CAACf,QAAQ,GAAG,IAAI,CAACoB,YAAY,CAAC7B,QAAQ,CAACsB,YAAY,CAAC,CAAC,CAAC,CAAC;YACzEE,mBAAkB,CAACb,IAAI,GAAG,IAAI,CAACqB,YAAY,CAAC,IAAI,CAACL,WAAW,CAAC3B,QAAQ,CAACsB,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;YACvFE,mBAAkB,CAACjC,KAAK,GAAG,GAAG;YAC9B,OAAO,IAAI,CAACU,4BAA4B,CAACuB,mBAAkB,CAAC;UAChE,CAAC,CACD,OAAOO,KAAK,EAAE;YACV;UACJ;QACJ;MACJ;MACA,IAAI;QACA,IAAIhC,WAAW,CAACkC,IAAI,KAAK,qBAAqB,EAAE;UAC5C,IAAIjC,QAAQ,CAACqB,YAAY,KAAK,sBAAsB,IAChDrB,QAAQ,CAACsB,YAAY,CAACC,MAAM,GAAG,CAAC,IAChC,IAAI,CAACM,YAAY,CAAC7B,QAAQ,CAACsB,YAAY,CAAC,CAAC,CAAC,CAAC,KAAKtB,QAAQ,CAACS,QAAQ,EAAE;YACnET,QAAQ,CAACS,QAAQ,GAAGT,QAAQ,CAACQ,MAAM;UACvC;UACA,IAAIR,QAAQ,CAACqB,YAAY,KAAK,iBAAiB,IAC3CrB,QAAQ,CAACsB,YAAY,CAACC,MAAM,GAAG,CAAC,IAChC,IAAI,CAACM,YAAY,CAAC7B,QAAQ,CAACsB,YAAY,CAAC,CAAC,CAAC,CAAC,KAAKtB,QAAQ,CAACS,QAAQ,EAAE;YACnET,QAAQ,CAACS,QAAQ,GAAGT,QAAQ,CAACQ,MAAM;UACvC;QACJ;MACJ,CAAC,CACD,OAAOuB,KAAK,EAAE;QACV;MACJ;MACA,OAAO/B,QAAQ;IACnB;EAAC;IAAA;IAAA,OACD,kCAAyBA,QAAQ,EAAE;MAC/B,IAAIA,QAAQ,CAACQ,MAAM,KAAKR,QAAQ,CAACS,QAAQ,EAAE;QACvC,OAAOyB,SAAS;MACpB;MACA,IAAIlC,QAAQ,CAACqB,YAAY,KAAK,sBAAsB,EAAE;QAClD,OAAOa,SAAS;MACpB;MACA,IAAMlB,IAAI,GAAGhB,QAAQ,CAACsB,YAAY;MAClC,IAAIN,IAAI,CAACO,MAAM,GAAG,CAAC,EAAE;QACjB,OAAOW,SAAS;MACpB;MACA,IAAI,CAAC,IAAI,CAACC,cAAc,CAACnB,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE;QAC/B,OAAOkB,SAAS;MACpB;MACA,IAAMzB,QAAQ,GAAG,IAAI,CAACoB,YAAY,CAACb,IAAI,CAAC,CAAC,CAAC,CAAC;MAC3C,IAAMoB,aAAa,GAAG,IAAI,CAACC,WAAW,CAACrB,IAAI,CAAC,CAAC,CAAC,CAAC;MAC/C,IAAMsB,MAAM,GAAG,IAAI5C,mBAAmB,EAAE;MACxC,IAAI,CAAC4C,MAAM,CAACC,SAAS,EAAE;QACnBD,MAAM,CAACC,SAAS,GAAG,EAAE;MACzB;MACA,IAAIC,KAAK,GAAG,CAAC;MACb,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGL,aAAa,EAAEK,CAAC,EAAE,EAAE;QACpC,IAAMC,UAAU,GAAG,IAAI,CAACf,WAAW,CAACX,IAAI,CAACwB,KAAK,EAAE,CAAC,CAAC;QAClD,IAAMG,KAAK,GAAG3B,IAAI,CAACwB,KAAK,EAAE,CAAC;QAC3B,IAAMjD,KAAK,GAAG,IAAI,CAACqD,WAAW,CAAC5B,IAAI,CAACwB,KAAK,EAAE,CAAC,CAAC;QAC7C,IAAIG,KAAK,EAAE;UACPL,MAAM,CAACC,SAAS,CAACM,IAAI,CAAC;YAClBtD,KAAK,EAALA,KAAK;YACLuD,UAAU,EAAE;cACRC,UAAU,EAAEL,UAAU;cACtBA,UAAU,YAAKA,UAAU,cAAIC,KAAK;YACtC;UACJ,CAAC,CAAC;QACN,CAAC,MACI;UACDL,MAAM,CAACC,SAAS,CAACM,IAAI,CAAC;YAClBtD,KAAK,EAALA,KAAK;YACLuD,UAAU,EAAE;cACRE,KAAK,EAAEN;YACX;UACJ,CAAC,CAAC;QACN;MACJ;MACAJ,MAAM,CAAC9B,MAAM,GAAGR,QAAQ,CAACQ,MAAM;MAC/B8B,MAAM,CAAC7B,QAAQ,GAAGA,QAAQ;MAC1B,IAAIO,IAAI,CAACO,MAAM,GAAGiB,KAAK,EAAE;QACrBF,MAAM,CAACjB,YAAY,GAAG,IAAI,CAACM,WAAW,CAACX,IAAI,CAACwB,KAAK,EAAE,CAAC,CAAC;QACrDF,MAAM,CAAChB,YAAY,GAAGN,IAAI,CAACC,KAAK,CAACuB,KAAK,EAAE,CAAC;MAC7C;MACA,OAAOF,MAAM;IACjB;EAAC;IAAA;IAAA,OACD,gCAAuBtC,QAAQ,EAAE;MAC7B,IAAIA,QAAQ,CAACQ,MAAM,KAAKR,QAAQ,CAACS,QAAQ,EAAE;QACvC,OAAOyB,SAAS;MACpB;MACA,IAAIlC,QAAQ,CAACqB,YAAY,KAAK,iBAAiB,EAAE;QAC7C,OAAOa,SAAS;MACpB;MACA,IAAMlB,IAAI,GAAGhB,QAAQ,CAACsB,YAAY;MAClC,IAAIN,IAAI,CAACO,MAAM,GAAG,CAAC,EAAE;QACjB,OAAOW,SAAS;MACpB;MACA,IAAI,CAAC,IAAI,CAACC,cAAc,CAACnB,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE;QAC/B,OAAOkB,SAAS;MACpB;MACA,IAAMe,oBAAoB,GAAG,IAAI,CAACtB,WAAW,CAACX,IAAI,CAAC,CAAC,CAAC,CAAC;MACtD,IAAM2B,KAAK,GAAG3B,IAAI,CAAC,CAAC,CAAC;MACrB,IAAMzB,KAAK,GAAG,IAAI,CAACqD,WAAW,CAAC5B,IAAI,CAAC,CAAC,CAAC,CAAC;MACvC,IAAMP,QAAQ,GAAG,IAAI,CAACoB,YAAY,CAACb,IAAI,CAAC,CAAC,CAAC,CAAC;MAC3C,IAAMsB,MAAM,GAAG,IAAI5C,mBAAmB,EAAE;MACxC4C,MAAM,CAAC9B,MAAM,GAAGR,QAAQ,CAACQ,MAAM;MAC/B8B,MAAM,CAAC7B,QAAQ,GAAGA,QAAQ;MAC1B6B,MAAM,CAAC/C,KAAK,GAAGA,KAAK;MACpB,IAAIyB,IAAI,CAACO,MAAM,GAAG,CAAC,EAAE;QACjBe,MAAM,CAACjB,YAAY,GAAG,IAAI,CAACM,WAAW,CAACX,IAAI,CAAC,CAAC,CAAC,CAAC;QAC/CsB,MAAM,CAAChB,YAAY,GAAGN,IAAI,CAACC,KAAK,CAAC,CAAC,CAAC;MACvC;MACAqB,MAAM,CAACC,SAAS,GAAG,CAAC;QACZhD,KAAK,EAALA,KAAK;QACLuD,UAAU,EAAE;UACRC,UAAU,EAAEE,oBAAoB;UAChCP,UAAU,YAAKO,oBAAoB,cAAIN,KAAK;QAChD;MACJ,CAAC,CAAC;MACN,OAAOL,MAAM;IACjB;EAAC;IAAA;IAAA,OACD,sBAAaY,GAAG,EAAE;MACd,OAAOC,MAAM,CAACC,IAAI,CAACF,GAAG,CAAC,CAACtB,QAAQ,CAAC,QAAQ,CAAC;IAC9C;EAAC;IAAA;IAAA,OACD,sBAAasB,GAAG,EAAE;MACd,OAAOC,MAAM,CAACC,IAAI,CAACF,GAAG,EAAE,QAAQ,CAAC,CAACtB,QAAQ,CAAC,QAAQ,CAAC;IACxD;EAAC;IAAA;IAAA,OACD,qBAAYyB,GAAG,EAAE;MACb,OAAOC,QAAQ,CAACD,GAAG,EAAE,EAAE,CAAC;IAC5B;EAAC;IAAA;IAAA,OACD,oCAA2BrD,QAAQ,EAAE;MACjC,IAAIA,QAAQ,CAACqB,YAAY,KAAK,cAAc,EAAE;QAC1C,OAAOa,SAAS;MACpB;MACA,IAAMlB,IAAI,GAAGhB,QAAQ,CAACsB,YAAY;MAClC,IAAIN,IAAI,CAACO,MAAM,GAAG,CAAC,EAAE;QACjB,OAAOW,SAAS;MACpB;MACA,IAAMqB,eAAe,GAAG,IAAI,CAAC5B,WAAW,CAACX,IAAI,CAAC,CAAC,CAAC,CAAC;MACjD,IAAMzB,KAAK,GAAG,IAAI,CAACqD,WAAW,CAAC5B,IAAI,CAAC,CAAC,CAAC,CAAC;MACvC,IAAMsB,MAAM,GAAG,IAAI5C,mBAAmB,EAAE;MACxC4C,MAAM,CAAC9B,MAAM,GAAGR,QAAQ,CAACQ,MAAM;MAC/B8B,MAAM,CAAC7B,QAAQ,GAAGT,QAAQ,CAACS,QAAQ;MACnC,IAAIO,IAAI,CAACO,MAAM,GAAG,CAAC,EAAE;QACjBe,MAAM,CAACjB,YAAY,GAAG,IAAI,CAACM,WAAW,CAACX,IAAI,CAAC,CAAC,CAAC,CAAC;QAC/CsB,MAAM,CAAChB,YAAY,GAAGN,IAAI,CAACC,KAAK,CAAC,CAAC,CAAC;MACvC;MACAqB,MAAM,CAACC,SAAS,GAAG,CAAC;QACZhD,KAAK,EAALA,KAAK;QACLuD,UAAU,EAAE;UACRJ,UAAU,EAAEa;QAChB;MACJ,CAAC,CAAC;MACNjB,MAAM,CAAC/C,KAAK,GAAGS,QAAQ,CAACT,KAAK;MAC7B,OAAO+C,MAAM;IACjB;EAAC;IAAA;IAAA,OACD,sBAAakB,OAAO,EAAE;MAClB,IAAMC,MAAM,GAAGN,MAAM,CAACC,IAAI,CAACI,OAAO,EAAE,KAAK,CAAC;MAC1C,IAAIE,KAAK,GAAG7D,QAAQ,CAAC8D,MAAM,CAACC,OAAO,CAACH,MAAM,CAAC;MAC3C,OAAO5D,QAAQ,CAAC8D,MAAM,CAACE,MAAM,CAAC,KAAK,EAAEH,KAAK,CAAC;IAC/C;EAAC;IAAA;IAAA,OACD,wBAAeF,OAAO,EAAE;MACpB,OAAOL,MAAM,CAACC,IAAI,CAACI,OAAO,EAAE,KAAK,CAAC,CAACjC,MAAM,IAAI,EAAE;IACnD;EAAC;IAAA;IAAA,OACD,iCAAwBuC,GAAG,EAAE;MACzB,IAAI,CAAC,IAAI,CAACC,KAAK,CAACD,GAAG,CAAC,EAAE;QAClB,OAAO,KAAK;MAChB;MACA,IAAIA,GAAG,CAACvC,MAAM,GAAG,CAAC,KAAK,CAAC,EAAE;QACtB,OAAO,KAAK;MAChB;MACA,OAAO,IAAI;IACf;EAAC;IAAA;IAAA,OACD,eAAMhC,KAAK,EAAE;MACT,OAAO,IAAIyE,MAAM,CAAC,aAAa,CAAC,CAACC,IAAI,CAAC1E,KAAK,CAAC,KAAK,KAAK;IAC1D;EAAC;IAAA;IAAA,OACD,qBAAY2D,GAAG,EAAE;MACb,OAAOC,MAAM,CAACC,IAAI,CAACF,GAAG,EAAE,QAAQ,CAAC,CAACtB,QAAQ,CAAC,KAAK,CAAC;IACrD;EAAC;IAAA;IAAA,OACD,qBAAYyB,GAAG,EAAE;MACb,OAAOF,MAAM,CAACC,IAAI,CAACC,GAAG,EAAE,KAAK,CAAC,CAACzB,QAAQ,CAAC,OAAO,CAAC;IACpD;EAAC;IAAA;IAAA,OACD,qBAAYyB,GAAG,EAAE;MACb,IAAI,CAACA,GAAG,EAAE;QACN,OAAO3C,MAAM,CAAC,CAAC,CAAC;MACpB;MACA,OAAOA,MAAM,CAAC,IAAI,GAAG2C,GAAG,CAAC;IAC7B;EAAC;EAAA;AAAA;AAEL/D,OAAO,CAACM,kBAAkB,GAAGA,kBAAkB;AAAC,IAC1CD,mBAAmB,6BACrB,+BAAc;EAAA;EACV,IAAI,CAACa,MAAM,GAAG,EAAE;EAChB,IAAI,CAACC,QAAQ,GAAG,EAAE;EAClB,IAAI,CAACE,IAAI,GAAG,EAAE;EACd,IAAI,CAACpB,KAAK,GAAG,GAAG;EAChB,IAAI,CAAC0C,IAAI,GAAG,EAAE;AAClB,CAAC;AAEL3C,OAAO,CAACK,mBAAmB,GAAGA,mBAAmB;AAAC,IAC5CD,mBAAmB,6BACrB,+BAAc;EAAA;EACV,IAAI,CAACc,MAAM,GAAG,EAAE;EAChB,IAAI,CAACC,QAAQ,GAAG,EAAE;EAClB,IAAI,CAAClB,KAAK,GAAGmB,MAAM,CAAC,CAAC,CAAC;EACtB,IAAI,CAACY,YAAY,GAAG,EAAE;AAC1B,CAAC;AAELhC,OAAO,CAACI,mBAAmB,GAAGA,mBAAmB;AAAC,IAC5CD,2BAA2B,6BAC7B,uCAAc;EAAA;EACV,IAAI,CAACF,KAAK,GAAGmB,MAAM,CAAC,CAAC,CAAC;AAC1B,CAAC;AAELpB,OAAO,CAACG,2BAA2B,GAAGA,2BAA2B;AAAC,IAC5DD,uBAAuB;EAAA;AAAA;AAE7BF,OAAO,CAACE,uBAAuB,GAAGA,uBAAuB"},"metadata":{},"sourceType":"script"}