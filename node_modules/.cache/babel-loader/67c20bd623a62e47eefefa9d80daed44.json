{"ast":null,"code":"import _regeneratorRuntime from \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _slicedToArray from \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { a as v } from \"./chunk-YTYNUTPN.js\";\nimport { a as O } from \"./chunk-QMCWVKRX.js\";\nimport { a as y } from \"./chunk-K5JDD2QZ.js\";\nimport { a as I } from \"./chunk-LPXTFZID.js\";\nimport { a as $ } from \"./chunk-TFLR4T43.js\";\nimport { a as G } from \"./chunk-HSZIKABD.js\";\nimport { c as x, d as h } from \"./chunk-HXERYGOO.js\";\nimport { c as M, f as R } from \"./chunk-V2DQWH6R.js\";\nimport { a as oe } from \"./chunk-E37GJNPW.js\";\nimport { c as w, e as P, f as b } from \"./chunk-K45F7SFK.js\";\nimport { a as ne } from \"./chunk-MDICBPXF.js\";\nimport { a as E } from \"./chunk-MP7NBSJV.js\";\nimport { b as B, c as te } from \"./chunk-NPGLEYL5.js\";\nimport { k as ee } from \"./chunk-P6M5SGWP.js\";\nimport { j as s, m as A } from \"./chunk-HBP5N4FR.js\";\nA();\nimport { useEffect as re, useRef as q, useState as z } from \"react\";\nimport { WalletConnectProvider as ie } from \"@elrondnetwork/erdjs-wallet-connect-provider\";\nte();\noe();\nee();\nne();\nvar Ue = function Ue(_ref) {\n  var T = _ref.logoutRoute,\n    l = _ref.callbackRoute,\n    g = _ref.token,\n    F = _ref.onLoginRedirect;\n  var c = x(),\n    J = 15e3,\n    _z = z(\"\"),\n    _z2 = _slicedToArray(_z, 2),\n    W = _z2[0],\n    N = _z2[1],\n    _z3 = z(\"\"),\n    _z4 = _slicedToArray(_z3, 2),\n    u = _z4[0],\n    U = _z4[1],\n    _$ = $(),\n    a = _$.provider,\n    m = h(M),\n    j = h(R),\n    o = q(a),\n    p = q(!0),\n    f,\n    S = Boolean(u),\n    K = !S,\n    Q = S ? \"\".concat(j, \"?wallet-connect=\").concat(encodeURIComponent(u)) : \"\";\n  re(function () {\n    k();\n    var e = setInterval(function () {\n      k();\n    }, J);\n    return function () {\n      return clearInterval(e);\n    };\n  }, [a]), v(function () {\n    D();\n  }, [g]), v(function () {\n    o.current = a;\n  }, [a]);\n  var L = function L() {\n      O(T);\n    },\n    V = function V() {\n      p.current = !1;\n    };\n  function k() {\n    return s(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var i, t, n;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(a == null || !y(\"walletconnect\") || !Boolean((t = (i = o.current) == null ? void 0 : i.walletConnector) == null ? void 0 : t.connected))) {\n                _context.next = 2;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 2:\n              n = {\n                method: \"heartbeat\",\n                params: {}\n              };\n              _context.prev = 3;\n              _context.next = 6;\n              return o.current.sendCustomMessage(n);\n            case 6:\n              _context.next = 11;\n              break;\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](3);\n              console.error(\"Connection lost\", _context.t0), L();\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 8]]);\n    }));\n  }\n  function X() {\n    return s(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      var e, n, t, r, d, _, H;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              n = o.current;\n              if (!(I() || n == null || !y(\"walletconnect\"))) {\n                _context2.next = 4;\n                break;\n              }\n              return _context2.abrupt(\"return\");\n            case 4:\n              if (p.current) {\n                _context2.next = 14;\n                break;\n              }\n              _context2.prev = 5;\n              _context2.next = 8;\n              return (e = o.current) == null ? void 0 : e.logout();\n            case 8:\n              _context2.next = 13;\n              break;\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](5);\n              console.warn(\"Unable to logout\");\n            case 13:\n              return _context2.abrupt(\"return\");\n            case 14:\n              _context2.next = 16;\n              return n.getAddress();\n            case 16:\n              t = _context2.sent;\n              if (t) {\n                _context2.next = 20;\n                break;\n              }\n              console.warn(\"Login cancelled.\");\n              return _context2.abrupt(\"return\");\n            case 20:\n              _context2.next = 22;\n              return n.getSignature();\n            case 22:\n              r = _context2.sent;\n              d = Boolean(r);\n              _ = {\n                address: t,\n                loginMethod: \"walletconnect\"\n              };\n              H = {\n                logoutRoute: T,\n                loginType: \"walletConnect\",\n                callbackRoute: l != null ? l : window.location.href\n              };\n              d ? (c(w(H)), c(b(r))) : c(w(H)), c(B(_)), n.walletConnector.on(\"heartbeat\", function () {\n                clearInterval(f), f = setInterval(function () {\n                  console.log(\"Maiar Wallet Connection Lost\"), L(), clearInterval(f);\n                }, 15e4);\n              }), E(l, F);\n              _context2.next = 32;\n              break;\n            case 29:\n              _context2.prev = 29;\n              _context2.t1 = _context2[\"catch\"](0);\n              N(\"Invalid address\"), console.error(_context2.t1);\n            case 32:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 29], [5, 10]]);\n    }));\n  }\n  function Y() {\n    var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;\n    return s(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      var r, d, n, i, t;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              n = e && !u;\n              if (!(!m || ((d = (r = o == null ? void 0 : o.current) == null ? void 0 : r.isInitialized) == null ? void 0 : d.call(r)) && !n)) {\n                _context3.next = 3;\n                break;\n              }\n              return _context3.abrupt(\"return\");\n            case 3:\n              i = {\n                onClientLogin: X,\n                onClientLogout: L\n              }, t = new ie(m, i);\n              _context3.next = 6;\n              return t.init();\n            case 6:\n              p.current = !0;\n              G(t);\n              o.current = t;\n              e && D();\n            case 10:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n  }\n  function D() {\n    return s(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n      var t, e, i;\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (m) {\n                _context4.next = 2;\n                break;\n              }\n              return _context4.abrupt(\"return\");\n            case 2:\n              _context4.next = 4;\n              return (t = o.current) == null ? void 0 : t.login();\n            case 4:\n              e = _context4.sent;\n              if (Boolean(e)) {\n                _context4.next = 7;\n                break;\n              }\n              return _context4.abrupt(\"return\");\n            case 7:\n              if (g) {\n                _context4.next = 10;\n                break;\n              }\n              U(e);\n              return _context4.abrupt(\"return\");\n            case 10:\n              i = \"\".concat(e, \"&token=\").concat(g);\n              U(i), c(P({\n                loginToken: g\n              }));\n            case 12:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n  }\n  var C = Boolean(W),\n    Z = I();\n  return [Y, {\n    error: W,\n    loginFailed: C,\n    isLoading: K && !C,\n    isLoggedIn: Z && !C\n  }, {\n    uriDeepLink: Q,\n    walletConnectUri: u,\n    cancelLogin: V\n  }];\n};\nexport { Ue as a };","map":null,"metadata":{},"sourceType":"module"}