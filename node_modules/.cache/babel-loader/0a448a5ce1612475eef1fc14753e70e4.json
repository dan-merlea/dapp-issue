{"ast":null,"code":"import _classCallCheck from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _get from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/get.js\";import _getPrototypeOf from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";import _inherits from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{Maths,Constants}from'@krogan/common';import{getCacheAsset}from'images/textures';import{Container,Sprite}from'pixi.js';import ObjectMap from'storage/ObjectMap';import PlanetSprite from'./PlanetSprite';export var SolarSystemSize;(function(SolarSystemSize){SolarSystemSize[SolarSystemSize[\"SMALL\"]=0]=\"SMALL\";SolarSystemSize[SolarSystemSize[\"MEDIUM\"]=1]=\"MEDIUM\";SolarSystemSize[SolarSystemSize[\"LARGE\"]=2]=\"LARGE\";})(SolarSystemSize||(SolarSystemSize={}));var SolarSystem=/*#__PURE__*/function(_Container){_inherits(SolarSystem,_Container);var _super=_createSuper(SolarSystem);// Data\n// Sprites\nfunction SolarSystem(radius){var _this;var scale=arguments.length>1&&arguments[1]!==undefined?arguments[1]:SolarSystemSize.SMALL;_classCallCheck(this,SolarSystem);_this=_super.call(this);_this.planets=[];_this._planets=new ObjectMap();_this._sun=void 0;_this._timer=void 0;_this._scale=void 0;_this._radius=void 0;console.log(\"Creating solar system with radius \".concat(radius));_this._scale=scale;_this._radius=radius*0.8;if(scale!=SolarSystemSize.LARGE){_this._timer=setInterval(function(){return _this.updatePlanets();},1000/Constants.GAME_SPEED);}return _this;}// TODO: setup listener on planets if needed\n_createClass(SolarSystem,[{key:\"addPlanets\",value:function addPlanets(planets){if(planets.length==0)return;this.planets=planets.toArray();this.createPlanets(planets.toArray());this.createSunIfNeeded();}},{key:\"createSunIfNeeded\",value:function createSunIfNeeded(){if(this._planets.length()>0&&!this._sun){this._sun=new Sprite(getCacheAsset(this.sunImageKey()));this._sun.anchor.x=0.5;this._sun.anchor.y=0.5;this._sun.width=this.getPartialSize(20);this._sun.height=this.getPartialSize(20);this._sun.zIndex=0;this.addChild(this._sun);console.log(\"Adding sun with size \".concat(this.getPartialSize(20)));}}},{key:\"getPartialSize\",value:function getPartialSize(percentage){return Math.floor(percentage/100*this._radius);}},{key:\"sunImageKey\",value:function sunImageKey(){return'sun-medium-1';}},{key:\"destroy\",value:function destroy(){clearInterval(this._timer);_get(_getPrototypeOf(SolarSystem.prototype),\"destroy\",this).call(this);}// HELPERS\n},{key:\"updatePlanet\",value:function updatePlanet(planet){var sprite=this._planets.get(planet.nonce.toString());if(!sprite)return;sprite.position.x=planet.position.x;sprite.position.y=planet.position.y;sprite.angle=planet.position.angle;}},{key:\"updatePlanets\",value:function updatePlanets(){for(var i=0;i<this.planets.length;i++){var planet=this.planets[i];var sprite=this._planets.get(planet.nonce.toString());if(!sprite)return;sprite.angle=this.planetAngle(planet);}}},{key:\"createPlanets\",value:function createPlanets(planets){var _this2=this;var totalSpace=75/100*this._radius;planets.forEach(function(planet){totalSpace-=_this2.getPartialSize(planet.size);});var space=totalSpace/(planets.length-1);console.log(\"Space between planets: \".concat(space));var y=this.getPartialSize(25);planets.forEach(function(planet,i){var size=_this2.getPartialSize(planet.size);var sprite=new PlanetSprite(planet,_this2._scale,size);if(_this2._scale!=SolarSystemSize.LARGE){sprite.pivot.y=y;sprite.angle=_this2.planetAngle(planet);}else{sprite.position.x=planet.position.x;sprite.position.y=planet.position.y;sprite.angle=planet.position.angle;planet.onChange=function(){_this2.updatePlanet(planet);};}sprite.zIndex=i;_this2.addChild(sprite);_this2._planets.add(planet.nonce.toString(),sprite);y+=size+space;console.log(\"Adding planet \".concat(i,\" with size \").concat(size,\" with distance \").concat(sprite.pivot.y));});}},{key:\"planetAngle\",value:function planetAngle(planet){var timePassed=Date.now()/1000-planet.born;// 1 rotation per hour if planet speed = 1 && game speed = 1\nreturn Maths.decimals(timePassed/3600*planet.speed*Constants.GAME_SPEED)*360;}}]);return SolarSystem;}(Container);export{SolarSystem as default};","map":null,"metadata":{},"sourceType":"module"}