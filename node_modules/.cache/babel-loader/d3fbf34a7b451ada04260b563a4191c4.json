{"ast":null,"code":"import _regeneratorRuntime from \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _slicedToArray from \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { a as W } from \"./chunk-YTYNUTPN.js\";\nimport { a as F } from \"./chunk-QMCWVKRX.js\";\nimport { a as z } from \"./chunk-K5JDD2QZ.js\";\nimport { a as P } from \"./chunk-LPXTFZID.js\";\nimport { a as $, d as q } from \"./chunk-HSZIKABD.js\";\nimport { c as O, d as u } from \"./chunk-HXERYGOO.js\";\nimport { b, d as B, e as M, f as G } from \"./chunk-V2DQWH6R.js\";\nimport { a as dn } from \"./chunk-E37GJNPW.js\";\nimport { c as E, e as T, f as k } from \"./chunk-K45F7SFK.js\";\nimport { a as gn } from \"./chunk-MDICBPXF.js\";\nimport { a as H } from \"./chunk-MP7NBSJV.js\";\nimport { b as j, c as ln } from \"./chunk-NPGLEYL5.js\";\nimport { k as an } from \"./chunk-P6M5SGWP.js\";\nimport { j as d, m as D } from \"./chunk-HBP5N4FR.js\";\nD();\nimport { useRef as _, useState as S } from \"react\";\nimport { WalletConnectProviderV2 as un } from \"@elrondnetwork/erdjs-wallet-connect-provider\";\nln();\ndn();\nan();\ngn();\nvar pn = function (c) {\n    return c.invalidAddress = \"Invalid address\", c.invalidConfig = \"Invalid WalletConnect setup\", c.invalidTopic = \"Expired connection\", c.sessionExpired = \"Unable to connect to existing session\", c.connectError = \"Unable to connect\", c.userRejected = \"User rejected connection proposal\", c.userRejectedExisting = \"User rejected existing connection proposal\", c.errorLogout = \"Unable to remove existing pairing\", c;\n  }(pn || {}),\n  kn = function kn(_ref) {\n    var p = _ref.callbackRoute,\n      x = _ref.logoutRoute,\n      a = _ref.token,\n      J = _ref.onLoginRedirect;\n    var g = O(),\n      _S = S(\"\"),\n      _S2 = _slicedToArray(_S, 2),\n      I = _S2[0],\n      l = _S2[1],\n      _S3 = S(\"\"),\n      _S4 = _slicedToArray(_S3, 2),\n      f = _S4[0],\n      c = _S4[1],\n      _S5 = S([]),\n      _S6 = _slicedToArray(_S5, 2),\n      K = _S6[0],\n      w = _S6[1],\n      C = q(),\n      m = u(B),\n      v = u(M),\n      N = u(b),\n      Q = u(G),\n      o = _(C),\n      L = _(!0),\n      U = Boolean(f),\n      V = [\"erd_cancelAction\"],\n      X = !U,\n      Y = U ? \"\".concat(Q, \"?wallet-connect=\").concat(encodeURIComponent(f)) : \"\";\n    W(function () {\n      R();\n    }, [a]), W(function () {\n      o.current = C;\n    }, [C]);\n    var Z = function Z() {\n        F(x);\n      },\n      nn = function nn(n) {\n        console.log(\"wc2 session event: \", n);\n      },\n      en = function en() {\n        L.current = !1;\n      };\n    function on() {\n      return d(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var n, e, t, i, s, sn, A;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                e = o.current;\n                if (!(P() || e == null || !z(\"walletconnectv2\"))) {\n                  _context.next = 4;\n                  break;\n                }\n                return _context.abrupt(\"return\");\n              case 4:\n                if (L.current) {\n                  _context.next = 14;\n                  break;\n                }\n                _context.prev = 5;\n                _context.next = 8;\n                return (n = o.current) == null ? void 0 : n.logout();\n              case 8:\n                _context.next = 13;\n                break;\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](5);\n                console.warn(\"Unable to logout\");\n              case 13:\n                return _context.abrupt(\"return\");\n              case 14:\n                _context.next = 16;\n                return e.getAddress();\n              case 16:\n                t = _context.sent;\n                if (t) {\n                  _context.next = 20;\n                  break;\n                }\n                console.warn(\"Login cancelled.\");\n                return _context.abrupt(\"return\");\n              case 20:\n                _context.next = 22;\n                return e.getSignature();\n              case 22:\n                i = _context.sent;\n                s = Boolean(i);\n                sn = {\n                  address: t,\n                  loginMethod: \"walletconnectv2\"\n                };\n                A = {\n                  logoutRoute: x,\n                  loginType: \"walletconnectv2\",\n                  callbackRoute: p != null ? p : window.location.href\n                };\n                s ? (g(E(A)), g(k(i))) : g(E(A)), g(j(sn)), H(p, J);\n                _context.next = 32;\n                break;\n              case 29:\n                _context.prev = 29;\n                _context.t1 = _context[\"catch\"](0);\n                l(\"Invalid address\"), console.error(_context.t1);\n              case 32:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 29], [5, 10]]);\n      }));\n    }\n    function y() {\n      var n = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;\n      return d(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var i, s, e, r, t;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                e = n && !f;\n                if (!(!v || !m || ((s = (i = o == null ? void 0 : o.current) == null ? void 0 : i.isInitialized) == null ? void 0 : s.call(i)) && !e)) {\n                  _context2.next = 4;\n                  break;\n                }\n                l(\"Invalid WalletConnect setup\");\n                return _context2.abrupt(\"return\");\n              case 4:\n                r = {\n                  onClientLogin: on,\n                  onClientLogout: Z,\n                  onClientEvent: nn\n                }, t = new un(r, N, m, v);\n                _context2.next = 7;\n                return t.init();\n              case 7:\n                L.current = !0;\n                $(t);\n                w(t.pairings);\n                o.current = t;\n                n && R();\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n    }\n    function tn(n) {\n      return d(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var e, r, t, _yield, i;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(!m || !v)) {\n                  _context3.next = 3;\n                  break;\n                }\n                l(\"Invalid WalletConnect setup\");\n                return _context3.abrupt(\"return\");\n              case 3:\n                if (!(!n || !n.topic)) {\n                  _context3.next = 6;\n                  break;\n                }\n                l(\"Expired connection\");\n                return _context3.abrupt(\"return\");\n              case 6:\n                _context3.prev = 6;\n                _context3.next = 9;\n                return (e = o.current) == null ? void 0 : e.connect({\n                  topic: n.topic,\n                  methods: V\n                });\n              case 9:\n                _yield = _context3.sent;\n                i = _yield.approval;\n                a && g(T({\n                  loginToken: a\n                }));\n                _context3.prev = 12;\n                _context3.next = 15;\n                return (r = o.current) == null ? void 0 : r.login({\n                  approval: i,\n                  token: a\n                });\n              case 15:\n                _context3.next = 22;\n                break;\n              case 17:\n                _context3.prev = 17;\n                _context3.t0 = _context3[\"catch\"](12);\n                console.warn(\"User rejected existing connection proposal\", _context3.t0);\n                _context3.next = 22;\n                return y();\n              case 22:\n                _context3.next = 27;\n                break;\n              case 24:\n                _context3.prev = 24;\n                _context3.t1 = _context3[\"catch\"](6);\n                console.error(\"Unable to connect to existing session\", _context3.t1), l(\"Unable to connect to existing session\");\n              case 27:\n                _context3.prev = 27;\n                w((t = o.current) == null ? void 0 : t.pairings);\n                return _context3.finish(27);\n              case 30:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[6, 24, 27, 30], [12, 17]]);\n      }));\n    }\n    function rn(n) {\n      return d(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var e, r;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                _context4.t0 = n;\n                if (!_context4.t0) {\n                  _context4.next = 5;\n                  break;\n                }\n                _context4.next = 5;\n                return (e = o.current) == null ? void 0 : e.logout({\n                  topic: n\n                });\n              case 5:\n                _context4.next = 10;\n                break;\n              case 7:\n                _context4.prev = 7;\n                _context4.t1 = _context4[\"catch\"](0);\n                console.error(\"Unable to remove existing pairing\", _context4.t1), l(\"Unable to remove existing pairing\");\n              case 10:\n                _context4.prev = 10;\n                w((r = o.current) == null ? void 0 : r.pairings);\n                return _context4.finish(10);\n              case 13:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, null, [[0, 7, 10, 13]]);\n      }));\n    }\n    function R() {\n      return d(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var n, e, _yield2, r, t;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (!(!m || !v)) {\n                  _context5.next = 3;\n                  break;\n                }\n                l(\"Invalid WalletConnect setup\");\n                return _context5.abrupt(\"return\");\n              case 3:\n                _context5.prev = 3;\n                _context5.next = 6;\n                return (n = o.current) == null ? void 0 : n.connect({\n                  methods: V\n                });\n              case 6:\n                _yield2 = _context5.sent;\n                r = _yield2.uri;\n                t = _yield2.approval;\n                if (Boolean(r)) {\n                  _context5.next = 11;\n                  break;\n                }\n                return _context5.abrupt(\"return\");\n              case 11:\n                c(r), a && g(T({\n                  loginToken: a\n                }));\n                _context5.prev = 12;\n                _context5.next = 15;\n                return (e = o.current) == null ? void 0 : e.login({\n                  approval: t,\n                  token: a\n                });\n              case 15:\n                _context5.next = 22;\n                break;\n              case 17:\n                _context5.prev = 17;\n                _context5.t0 = _context5[\"catch\"](12);\n                console.warn(\"User rejected connection proposal\", _context5.t0);\n                _context5.next = 22;\n                return y();\n              case 22:\n                _context5.next = 27;\n                break;\n              case 24:\n                _context5.prev = 24;\n                _context5.t1 = _context5[\"catch\"](3);\n                console.error(\"Unable to connect\", _context5.t1);\n              case 27:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, null, [[3, 24], [12, 17]]);\n      }));\n    }\n    var h = Boolean(I),\n      cn = P();\n    return [y, {\n      error: I,\n      loginFailed: h,\n      isLoading: X && !h,\n      isLoggedIn: cn && !h\n    }, {\n      uriDeepLink: Y,\n      walletConnectUri: f,\n      cancelLogin: en,\n      connectExisting: tn,\n      removeExistingPairing: rn,\n      wcPairings: K\n    }];\n  };\nexport { pn as a, kn as b };","map":null,"metadata":{},"sourceType":"module"}