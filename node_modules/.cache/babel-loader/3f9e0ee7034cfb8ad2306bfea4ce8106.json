{"ast":null,"code":"import _regeneratorRuntime from \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _slicedToArray from \"/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { a as T } from \"./chunk-OCMOBKCD.js\";\nimport { a as E } from \"./chunk-B5U3RXBF.js\";\nimport { c as w } from \"./chunk-57IQZAYS.js\";\nimport { a as G } from \"./chunk-X7UKRW56.js\";\nimport { e as u } from \"./chunk-JQUGIREJ.js\";\nimport { a as F } from \"./chunk-MDICBPXF.js\";\nimport { a as y } from \"./chunk-MP7NBSJV.js\";\nimport { b as L, c as D } from \"./chunk-ZNSS4PT5.js\";\nimport { g as f, h as A } from \"./chunk-C32UB6VS.js\";\nimport { k as R } from \"./chunk-P6M5SGWP.js\";\nimport { a as l, j as d, m } from \"./chunk-HBP5N4FR.js\";\nm();\nA();\nimport { useState as I } from \"react\";\nimport { ExtensionProvider as M } from \"@elrondnetwork/erdjs-extension-provider\";\nD();\nG();\nR();\nF();\nvar V = function V(_ref) {\n  var o = _ref.callbackRoute,\n    i = _ref.token,\n    x = _ref.onLoginRedirect;\n  var _I = I(\"\"),\n    _I2 = _slicedToArray(_I, 2),\n    s = _I2[0],\n    h = _I2[1],\n    _I3 = I(!1),\n    _I4 = _slicedToArray(_I3, 2),\n    S = _I4[0],\n    e = _I4[1],\n    g = w(),\n    a = T();\n  function v() {\n    return d(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var n, P, U, _n$account, c, p;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!a) {\n                _context.next = 2;\n                break;\n              }\n              throw new Error(f);\n            case 2:\n              e(!0);\n              n = M.getInstance();\n              _context.prev = 4;\n              _context.next = 7;\n              return n.init();\n            case 7:\n              if (_context.sent) {\n                _context.next = 10;\n                break;\n              }\n              console.warn(\"Something went wrong trying to redirect to wallet login..\");\n              return _context.abrupt(\"return\");\n            case 10:\n              P = encodeURIComponent(\"\".concat(window.location.origin).concat(o != null ? o : window.location.pathname)), U = l({\n                callbackUrl: P\n              }, i && {\n                token: i\n              });\n              _context.next = 13;\n              return n.login(U);\n            case 13:\n              E(n);\n              _n$account = n.account, c = _n$account.signature, p = _n$account.address;\n              if (p) {\n                _context.next = 18;\n                break;\n              }\n              e(!1), console.warn(\"Login cancelled.\");\n              return _context.abrupt(\"return\");\n            case 18:\n              c && g(u({\n                loginToken: String(i),\n                signature: c\n              })), g(L({\n                address: p,\n                loginMethod: \"extension\"\n              })), y(o, x);\n              _context.next = 24;\n              break;\n            case 21:\n              _context.prev = 21;\n              _context.t0 = _context[\"catch\"](4);\n              console.error(\"error loging in\", _context.t0), h(\"error logging in\" + _context.t0.message);\n            case 24:\n              _context.prev = 24;\n              e(!1);\n              return _context.finish(24);\n            case 27:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[4, 21, 24, 27]]);\n    }));\n  }\n  var t = Boolean(s);\n  return [v, {\n    loginFailed: t,\n    error: s,\n    isLoading: S && !t,\n    isLoggedIn: a && !t\n  }];\n};\nexport { V as a };","map":{"version":3,"names":["a","T","E","c","w","G","e","u","F","y","b","L","D","g","f","h","A","k","R","l","j","d","m","useState","I","ExtensionProvider","M","V","o","callbackRoute","i","token","x","onLoginRedirect","s","S","v","Error","n","getInstance","init","console","warn","P","encodeURIComponent","window","location","origin","pathname","U","callbackUrl","login","account","signature","p","address","loginToken","String","loginMethod","error","message","t","Boolean","loginFailed","isLoading","isLoggedIn"],"sources":["/Users/merlea/Development/Crypto/Krogan/kroganverse-com/node_modules/@elrondnetwork/dapp-core/__chunks__/chunk-I7OV5LMZ.js"],"sourcesContent":["import{a as T}from\"./chunk-OCMOBKCD.js\";import{a as E}from\"./chunk-B5U3RXBF.js\";import{c as w}from\"./chunk-57IQZAYS.js\";import{a as G}from\"./chunk-X7UKRW56.js\";import{e as u}from\"./chunk-JQUGIREJ.js\";import{a as F}from\"./chunk-MDICBPXF.js\";import{a as y}from\"./chunk-MP7NBSJV.js\";import{b as L,c as D}from\"./chunk-ZNSS4PT5.js\";import{g as f,h as A}from\"./chunk-C32UB6VS.js\";import{k as R}from\"./chunk-P6M5SGWP.js\";import{a as l,j as d,m}from\"./chunk-HBP5N4FR.js\";m();A();import{useState as I}from\"react\";import{ExtensionProvider as M}from\"@elrondnetwork/erdjs-extension-provider\";D();G();R();F();var V=({callbackRoute:o,token:i,onLoginRedirect:x})=>{let[s,h]=I(\"\"),[S,e]=I(!1),g=w(),a=T();function v(){return d(this,null,function*(){if(a)throw new Error(f);e(!0);let n=M.getInstance();try{if(!(yield n.init())){console.warn(\"Something went wrong trying to redirect to wallet login..\");return}let P=encodeURIComponent(`${window.location.origin}${o!=null?o:window.location.pathname}`),U=l({callbackUrl:P},i&&{token:i});yield n.login(U),E(n);let{signature:c,address:p}=n.account;if(!p){e(!1),console.warn(\"Login cancelled.\");return}c&&g(u({loginToken:String(i),signature:c})),g(L({address:p,loginMethod:\"extension\"})),y(o,x)}catch(r){console.error(\"error loging in\",r),h(\"error logging in\"+r.message)}finally{e(!1)}})}let t=Boolean(s);return[v,{loginFailed:t,error:s,isLoading:S&&!t,isLoggedIn:a&&!t}]};export{V as a};\n//# sourceMappingURL=chunk-I7OV5LMZ.js.map\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}