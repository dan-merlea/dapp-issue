import{a as X}from"./chunk-5CK75273.js";import{b as Y}from"./chunk-UNE74JWY.js";import{a as v}from"./chunk-LCDZ37RC.js";import{a as L}from"./chunk-YANDOLZK.js";import{a as Q}from"./chunk-6D5GT4OX.js";import{a as P}from"./chunk-JRQCY6J5.js";import{a as d,c as K}from"./chunk-JYRLELYC.js";import{c as G,d as J}from"./chunk-LY45FWEG.js";import{c as B,d as o}from"./chunk-HXERYGOO.js";import{a as q}from"./chunk-KAP6XTHZ.js";import{b as O,c as T,d as V,e as _,f as j}from"./chunk-5VZGFFLA.js";import{a as H,g as $}from"./chunk-HGGYZF27.js";import{g as N}from"./chunk-V2DQWH6R.js";import{a as he}from"./chunk-E37GJNPW.js";import{c as h,g as F,j as p,k as M}from"./chunk-PV7M7QZ7.js";import{f as R,g as z}from"./chunk-K45F7SFK.js";import{d as U}from"./chunk-AQDZEHIK.js";import{b as D,c as we}from"./chunk-NPGLEYL5.js";import{k as me}from"./chunk-P6M5SGWP.js";import{a as m,b as w,d as W,j as i,m as E}from"./chunk-HBP5N4FR.js";E();import{useEffect as u,useState as pe}from"react";import{ExtensionProvider as Le}from"@elrondnetwork/erdjs-extension-provider";import{HWProvider as Pe}from"@elrondnetwork/erdjs-hw-provider";we();he();me();function Oe(){let A=o(N),S=o(V),g=o(O),Z=o(j),c=o(H),y=o($),a=o(_),s=o(T),[l,ee]=pe(),n=B(),{callbackRoute:k,logoutRoute:C}=S||{callbackRoute:"",logoutRoute:""},[te]=X({callbackRoute:k,logoutRoute:C}),[ne]=Y({callbackRoute:k,logoutRoute:C});u(()=>{oe()},[A]),u(()=>{ge()},[g]),u(()=>{ie()},[c,s]),u(()=>{re()},[y,s,l]);function oe(){return i(this,null,function*(){try{let e=yield q();e&&n(U(e.erd_chain_id))}catch(e){console.error("failed refreshing chainId ",e)}})}function re(){y==null&&a!=null&&l&&n(F({index:a.index,address:c,hasContractDataEnabled:l.dataEnabled,version:l.version}))}function ie(){return i(this,null,function*(){if(n(p(!0)),c&&s)try{let e=yield P(c);e&&n(h(w(m({},e),{address:c,nonce:e.nonce.valueOf()})))}catch(e){n(M("Failed getting account")),console.error("Failed getting account ",e)}n(p(!1))})}function ae(){return i(this,null,function*(){let e=G(A.walletAddress);if(d(e),Z!=null){try{let t=yield L();if(t){n(D({address:t,loginMethod:"wallet"}));let r=yield P(t);r&&n(h(w(m({},r),{nonce:Q(r)})))}ce()}catch(t){console.error("Failed authenticating wallet user ",t)}n(z(null))}})}function ce(){var x;let e={};if((x=window==null?void 0:window.location)!=null&&x.search){let fe=new URLSearchParams(window.location.search);e=Object.fromEntries(fe)}let I=e,{signature:t,loginToken:r,address:b}=I,f=W(I,["signature","loginToken","address"]);t&&n(R(t)),se(f)}function se(e){let t=new URLSearchParams(e).toString(),{pathname:r}=window.location,b=t?`?${t}`:"",f=r?`${r}${b}`:"./";window.history.replaceState({},document.title,f)}function le(){return i(this,null,function*(){let e=new Pe,t=e.isInitialized();if(t||(t=yield e.init()),!t&&s){console.warn("Could not initialise ledger app"),v();return}return(a==null?void 0:a.index)!=null&&(e.addressIndex=a.index),e})}function de(){return i(this,null,function*(){try{let e=yield le();if(!e)return;let t=yield J(e);d(e),ee(t)}catch(e){console.error("Could not initialise ledger app",e),v()}})}function ue(){return i(this,null,function*(){try{let e=yield L(),t=Le.getInstance().setAddress(e);(yield t.init())?d(t):console.error("Could not initialise extension, make sure Elrond wallet extension is installed.")}catch(e){console.error("Unable to login to ExtensionProvider",e)}})}function ge(){if(g!=null)switch(g){case"ledger":{de();break}case"walletconnect":{te(!1);break}case"walletconnectv2":{ne(!1);break}case"extension":{ue();break}case"extra":{K();break}case"wallet":case"":{ae();break}default:return}}return null}export{Oe as a};
//# sourceMappingURL=chunk-CCLSU7S3.js.map
